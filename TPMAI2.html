<!-- jeanloui14-->
<div>
  ### Étude de Cas : Gestion des Stocks dans la Pharmacie DIBAPHAR

La pharmacie DIBAPHAR est une petite structure familiale située dans un quartier résidentiel d'une ville moyenne, gérée exclusivement par un seul pharmacien, M. Ahmed Dibaphar, qui en est le propriétaire et s'occupe de toutes les opérations quotidiennes. Étant une petite pharmacie indépendante, tout est géré manuellement sans aucun système informatisé : M. Dibaphar utilise des cahiers, des registres papier, des fiches cartonnées et des étagères pour organiser ses activités. Il n'y a pas de personnel supplémentaire ; il est à la fois le gérant, le vendeur, l'acheteur et le responsable des stocks. La pharmacie opère du lundi au samedi, de 8h à 20h, et sert une clientèle locale composée principalement de résidents du quartier, de patients réguliers et de quelques médecins environnants qui prescrivent des médicaments.

Les stocks de la pharmacie incluent une variété de produits pharmaceutiques et parapharmaceutiques : médicaments sur ordonnance (comme des antibiotiques, des antidouleurs, des antidiabétiques), médicaments en vente libre (tels que des sirops contre la toux, des vitamines, des crèmes dermatologiques), produits de soins personnels (shampoing, dentifrice, bandages), et quelques équipements basiques (thermomètres, tensiomètres). Chaque produit est identifié par son nom commercial, son principe actif, son dosage, sa forme (comprimés, sirops, pommades), sa date d'expiration, son prix d'achat, son prix de vente et son numéro de lot fourni par le fabricant. M. Dibaphar maintient un registre principal des stocks où il note manuellement, pour chaque produit, la quantité initiale achetée, les entrées (achats), les sorties (ventes ou pertes), et la quantité restante. Il utilise également des étiquettes collées sur les boîtes pour indiquer les dates d'expiration et les numéros de lot.

Un aspect clé de la gestion est l'approvisionnement : M. Dibaphar contacte personnellement ses fournisseurs, qui sont des grossistes pharmaceutiques locaux comme PharmaDistrib SARL et MediSupply Inc., ou parfois des représentants de laboratoires comme Pfizer ou Sanofi. Il passe des commandes par téléphone ou en personne, en se basant sur ses besoins estimés et les demandes récurrentes de ses clients. Pour chaque commande, il note dans un cahier dédié le nom du fournisseur, la date de commande, la liste des produits commandés (avec quantités et prix unitaires), la date de livraison prévue et le montant total. À la réception des marchandises, il vérifie manuellement la conformité (quantités, état des produits, dates d'expiration) et met à jour son registre des stocks en ajoutant les nouvelles quantités. S'il y a des écarts ou des produits défectueux, il les note dans un carnet séparé pour les retours ou réclamations, et contacte le fournisseur pour un remboursement ou un échange. Les paiements aux fournisseurs sont effectués en espèces ou par chèque, et il garde des reçus papier pour chaque transaction.

La gestion des ventes est tout aussi manuelle : lorsqu'un client arrive avec ou sans ordonnance, M. Dibaphar vérifie la disponibilité du produit sur les étagères ou dans son registre, délivre le médicament, conseille le client sur son usage (posologie, effets secondaires, interactions), et enregistre la vente dans un journal de caisse quotidien. Pour chaque vente, il note le nom du produit, la quantité vendue, le prix unitaire, le montant total, la date, et parfois le nom du client si c'est un habitué. Les ordonnances sont conservées dans un classeur pour traçabilité, avec des détails comme le nom du médecin prescripteur, le nom du patient, et la date de délivrance. Si un produit est en rupture de stock, M. Dibaphar note la demande dans un "carnet de commandes clients" pour prioriser les prochains achats, et informe le client d'un délai approximatif de réapprovisionnement (généralement 2-3 jours).

M. Dibaphar effectue un inventaire périodique, environ une fois par mois ou avant une grosse commande, où il compte physiquement tous les produits sur les étagères et compare avec son registre pour détecter les écarts dus à des pertes, des vols, des expirations ou des erreurs de comptage. Les produits expirés sont isolés dans une boîte dédiée, notés comme "périmés" dans le registre, et détruits ou renvoyés au fournisseur si possible ; il enregistre aussi leur valeur pour ajuster ses comptes. Pour les produits à rotation rapide comme les antalgiques ou les antiseptiques, il maintient un seuil minimal de stock (par exemple, au moins 10 boîtes pour les best-sellers) qu'il surveille visuellement. Les clients peuvent retourner des produits non ouverts dans les 7 jours, et M. Dibaphar note ces retours dans son journal, rembourse en espèces et remet le produit en stock si son état le permet.

Les informations manipulées incluent, entre autres : nom du produit, code-barres (s'il est présent sur l'emballage), quantité en stock, date d'achat, date d'expiration, prix d'achat, prix de vente, nom du fournisseur, référence de commande, nom du client (pour les ventes sur ordonnance), date de vente, montant encaissé, matricule fiscal de la pharmacie (pour les déclarations annuelles), libellé de la catégorie (médicaments, parapharmacie), et notes sur les interactions ou contre-indications. M. Dibaphar garde aussi un dossier pour les rapports réglementaires, comme les déclarations mensuelles à l'agence nationale des médicaments sur les ventes de substances contrôlées (par exemple, opioïdes ou antibiotiques), qu'il remplit à la main et envoie par courrier.

Le fonctionnement quotidien implique plusieurs flux : par exemple, un client entre librement dans la pharmacie, consulte les produits en rayon ou demande conseil à M. Dibaphar, qui vérifie son registre si nécessaire. Pour les achats en gros, M. Dibaphar négocie directement avec les fournisseurs pour des remises sur volume, et note ces accords dans son cahier. En cas de pic de demande (comme pendant une épidémie de grippe), il ajuste manuellement ses commandes pour éviter les ruptures. Les pertes dues à des vols ou des dommages sont rares mais notées dans un registre des incidents, avec des estimations de valeur pour l'assurance. M. Dibaphar gère aussi les paiements clients en espèces, carte bancaire (via un terminal manuel) ou crédit pour les habitués, et ferme sa caisse chaque soir en comptant les recettes et en les comparant aux ventes enregistrées.

Enfin, la pharmacie est en relation avec des acteurs externes : les médecins locaux pour les ordonnances, les autorités sanitaires pour les inspections annuelles (où M. Dibaphar présente ses registres), et les clients fidèles qui reçoivent des conseils personnalisés basés sur leurs historiques notés dans un carnet privé. Tout cela est géré de manière informelle et manuelle, sans automatisation, ce qui permet à M. Dibaphar de maintenir un contrôle total mais peut entraîner des erreurs humaines ou des retards lors des pics d'activité.

Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus.
</div>

<!-- MCC -->
<prompt>
  Quels sont les différents acteurs qui font les flux de communication dans cet énoncé :


### Étude de Cas : Gestion des Stocks dans la Pharmacie DIBAPHAR

La pharmacie DIBAPHAR est une petite structure familiale située dans un quartier résidentiel d'une ville moyenne, gérée exclusivement par un seul pharmacien, M. Ahmed Dibaphar, qui en est le propriétaire et s'occupe de toutes les opérations quotidiennes. Étant une petite pharmacie indépendante, tout est géré manuellement sans aucun système informatisé : M. Dibaphar utilise des cahiers, des registres papier, des fiches cartonnées et des étagères pour organiser ses activités. Il n'y a pas de personnel supplémentaire ; il est à la fois le gérant, le vendeur, l'acheteur et le responsable des stocks. La pharmacie opère du lundi au samedi, de 8h à 20h, et sert une clientèle locale composée principalement de résidents du quartier, de patients réguliers et de quelques médecins environnants qui prescrivent des médicaments.

Les stocks de la pharmacie incluent une variété de produits pharmaceutiques et parapharmaceutiques : médicaments sur ordonnance (comme des antibiotiques, des antidouleurs, des antidiabétiques), médicaments en vente libre (tels que des sirops contre la toux, des vitamines, des crèmes dermatologiques), produits de soins personnels (shampoing, dentifrice, bandages), et quelques équipements basiques (thermomètres, tensiomètres). Chaque produit est identifié par son nom commercial, son principe actif, son dosage, sa forme (comprimés, sirops, pommades), sa date d'expiration, son prix d'achat, son prix de vente et son numéro de lot fourni par le fabricant. M. Dibaphar maintient un registre principal des stocks où il note manuellement, pour chaque produit, la quantité initiale achetée, les entrées (achats), les sorties (ventes ou pertes), et la quantité restante. Il utilise également des étiquettes collées sur les boîtes pour indiquer les dates d'expiration et les numéros de lot.

Un aspect clé de la gestion est l'approvisionnement : M. Dibaphar contacte personnellement ses fournisseurs, qui sont des grossistes pharmaceutiques locaux comme PharmaDistrib SARL et MediSupply Inc., ou parfois des représentants de laboratoires comme Pfizer ou Sanofi. Il passe des commandes par téléphone ou en personne, en se basant sur ses besoins estimés et les demandes récurrentes de ses clients. Pour chaque commande, il note dans un cahier dédié le nom du fournisseur, la date de commande, la liste des produits commandés (avec quantités et prix unitaires), la date de livraison prévue et le montant total. À la réception des marchandises, il vérifie manuellement la conformité (quantités, état des produits, dates d'expiration) et met à jour son registre des stocks en ajoutant les nouvelles quantités. S'il y a des écarts ou des produits défectueux, il les note dans un carnet séparé pour les retours ou réclamations, et contacte le fournisseur pour un remboursement ou un échange. Les paiements aux fournisseurs sont effectués en espèces ou par chèque, et il garde des reçus papier pour chaque transaction.

La gestion des ventes est tout aussi manuelle : lorsqu'un client arrive avec ou sans ordonnance, M. Dibaphar vérifie la disponibilité du produit sur les étagères ou dans son registre, délivre le médicament, conseille le client sur son usage (posologie, effets secondaires, interactions), et enregistre la vente dans un journal de caisse quotidien. Pour chaque vente, il note le nom du produit, la quantité vendue, le prix unitaire, le montant total, la date, et parfois le nom du client si c'est un habitué. Les ordonnances sont conservées dans un classeur pour traçabilité, avec des détails comme le nom du médecin prescripteur, le nom du patient, et la date de délivrance. Si un produit est en rupture de stock, M. Dibaphar note la demande dans un "carnet de commandes clients" pour prioriser les prochains achats, et informe le client d'un délai approximatif de réapprovisionnement (généralement 2-3 jours).

M. Dibaphar effectue un inventaire périodique, environ une fois par mois ou avant une grosse commande, où il compte physiquement tous les produits sur les étagères et compare avec son registre pour détecter les écarts dus à des pertes, des vols, des expirations ou des erreurs de comptage. Les produits expirés sont isolés dans une boîte dédiée, notés comme "périmés" dans le registre, et détruits ou renvoyés au fournisseur si possible ; il enregistre aussi leur valeur pour ajuster ses comptes. Pour les produits à rotation rapide comme les antalgiques ou les antiseptiques, il maintient un seuil minimal de stock (par exemple, au moins 10 boîtes pour les best-sellers) qu'il surveille visuellement. Les clients peuvent retourner des produits non ouverts dans les 7 jours, et M. Dibaphar note ces retours dans son journal, rembourse en espèces et remet le produit en stock si son état le permet.

Les informations manipulées incluent, entre autres : nom du produit, code-barres (s'il est présent sur l'emballage), quantité en stock, date d'achat, date d'expiration, prix d'achat, prix de vente, nom du fournisseur, référence de commande, nom du client (pour les ventes sur ordonnance), date de vente, montant encaissé, matricule fiscal de la pharmacie (pour les déclarations annuelles), libellé de la catégorie (médicaments, parapharmacie), et notes sur les interactions ou contre-indications. M. Dibaphar garde aussi un dossier pour les rapports réglementaires, comme les déclarations mensuelles à l'agence nationale des médicaments sur les ventes de substances contrôlées (par exemple, opioïdes ou antibiotiques), qu'il remplit à la main et envoie par courrier.

Le fonctionnement quotidien implique plusieurs flux : par exemple, un client entre librement dans la pharmacie, consulte les produits en rayon ou demande conseil à M. Dibaphar, qui vérifie son registre si nécessaire. Pour les achats en gros, M. Dibaphar négocie directement avec les fournisseurs pour des remises sur volume, et note ces accords dans son cahier. En cas de pic de demande (comme pendant une épidémie de grippe), il ajuste manuellement ses commandes pour éviter les ruptures. Les pertes dues à des vols ou des dommages sont rares mais notées dans un registre des incidents, avec des estimations de valeur pour l'assurance. M. Dibaphar gère aussi les paiements clients en espèces, carte bancaire (via un terminal manuel) ou crédit pour les habitués, et ferme sa caisse chaque soir en comptant les recettes et en les comparant aux ventes enregistrées.

Enfin, la pharmacie est en relation avec des acteurs externes : les médecins locaux pour les ordonnances, les autorités sanitaires pour les inspections annuelles (où M. Dibaphar présente ses registres), et les clients fidèles qui reçoivent des conseils personnalisés basés sur leurs historiques notés dans un carnet privé. Tout cela est géré de manière informelle et manuelle, sans automatisation, ce qui permet à M. Dibaphar de maintenir un contrôle total mais peut entraîner des erreurs humaines ou des retards lors des pics d'activité.

Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus.
</prompt>
<div>
  # Analyse des acteurs et flux de communication dans la pharmacie DIBAPHAR

Voici les différents acteurs et flux de communication identifiés dans l'énoncé :

## Acteurs internes
1. **M. Ahmed Dibaphar** : Propriétaire et unique pharmacien qui gère toutes les opérations

## Acteurs externes
1. **Clients** : Résidents du quartier, patients réguliers
2. **Médecins** : Professionnels de santé qui prescrivent des médicaments
3. **Fournisseurs** :
   - Grossistes pharmaceutiques (PharmaDistrib SARL, MediSupply Inc.)
   - Laboratoires pharmaceutiques (Pfizer, Sanofi)
4. **Autorités sanitaires** : Organismes réglementaires qui effectuent des inspections

## Principaux flux de communication

### Entre M. Dibaphar et les clients
- Réception des demandes (avec ou sans ordonnance)
- Conseil sur l'usage des médicaments
- Information sur la disponibilité et les délais de réapprovisionnement
- Gestion des retours produits
- Traitement des paiements (espèces, carte bancaire, crédit)

### Entre M. Dibaphar et les médecins
- Réception et traitement des ordonnances
- Conservation des informations de prescription

### Entre M. Dibaphar et les fournisseurs
- Passation de commandes (téléphone ou en personne)
- Négociation des prix et remises
- Réception et vérification des livraisons
- Gestion des réclamations et retours
- Paiements (espèces, chèques)

### Entre M. Dibaphar et les autorités sanitaires
- Déclarations mensuelles des ventes de substances contrôlées
- Présentation des registres lors des inspections annuelles

## Flux d'information internes
- Enregistrement des stocks (registre principal)
- Suivi des commandes (cahier dédié)
- Gestion des ventes (journal de caisse quotidien)
- Inventaire périodique
- Suivi des produits expirés
- Gestion des incidents (vols, dommages)
- Enregistrement des remises et accords commerciaux

Ces flux de communication sont essentiellement manuels et documentés sur supports papier (cahiers, registres, fiches cartonnées) sans système informatisé.
</div>


<prompt>
  Adapte cet énoncé en retirant ou en remplaçant certains détails comme : le prénom de Monsieur Dibaphar (car il est connu uniquement grâce au nom de sa pharmacie qui est DIBAPHAR, voilà pourquoi tout le monde l'identifie et le procure toujours ce même nom lié à sa pharmacie ) , il opère aussi le dimanche, ce n'est pas 08h à 20h, "des antidiabétiques" , les détails sur les noms des fournisseurs, paiement carte bancaire,...


Et trouve une phrase approprié à la place de :

" Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus."
Car moi l'analyste qui a réalisé cet énoncé, pas un exercice venu d'un professeur 
Car le professeur nous a demandé de mener des analyses dans des domaines d'études de gestion, ... Parce qu'avec ça on doit maintenant construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé

Voilà 

Les restes de l'énoncé tout est presque parfait, fais juste une très bonne adaptation, amélioration pour que tout soit 100% parfait 

Voici l'énoncé :


  ### Étude de Cas : Gestion des Stocks dans la Pharmacie DIBAPHAR

La pharmacie DIBAPHAR est une petite structure familiale située dans un quartier résidentiel d'une ville moyenne, gérée exclusivement par un seul pharmacien, M. Ahmed Dibaphar, qui en est le propriétaire et s'occupe de toutes les opérations quotidiennes. Étant une petite pharmacie indépendante, tout est géré manuellement sans aucun système informatisé : M. Dibaphar utilise des cahiers, des registres papier, des fiches cartonnées et des étagères pour organiser ses activités. Il n'y a pas de personnel supplémentaire ; il est à la fois le gérant, le vendeur, l'acheteur et le responsable des stocks. La pharmacie opère du lundi au samedi, de 8h à 20h, et sert une clientèle locale composée principalement de résidents du quartier, de patients réguliers et de quelques médecins environnants qui prescrivent des médicaments.

Les stocks de la pharmacie incluent une variété de produits pharmaceutiques et parapharmaceutiques : médicaments sur ordonnance (comme des antibiotiques, des antidouleurs, des antidiabétiques), médicaments en vente libre (tels que des sirops contre la toux, des vitamines, des crèmes dermatologiques), produits de soins personnels (shampoing, dentifrice, bandages), et quelques équipements basiques (thermomètres, tensiomètres). Chaque produit est identifié par son nom commercial, son principe actif, son dosage, sa forme (comprimés, sirops, pommades), sa date d'expiration, son prix d'achat, son prix de vente et son numéro de lot fourni par le fabricant. M. Dibaphar maintient un registre principal des stocks où il note manuellement, pour chaque produit, la quantité initiale achetée, les entrées (achats), les sorties (ventes ou pertes), et la quantité restante. Il utilise également des étiquettes collées sur les boîtes pour indiquer les dates d'expiration et les numéros de lot.

Un aspect clé de la gestion est l'approvisionnement : M. Dibaphar contacte personnellement ses fournisseurs, qui sont des grossistes pharmaceutiques locaux comme PharmaDistrib SARL et MediSupply Inc., ou parfois des représentants de laboratoires comme Pfizer ou Sanofi. Il passe des commandes par téléphone ou en personne, en se basant sur ses besoins estimés et les demandes récurrentes de ses clients. Pour chaque commande, il note dans un cahier dédié le nom du fournisseur, la date de commande, la liste des produits commandés (avec quantités et prix unitaires), la date de livraison prévue et le montant total. À la réception des marchandises, il vérifie manuellement la conformité (quantités, état des produits, dates d'expiration) et met à jour son registre des stocks en ajoutant les nouvelles quantités. S'il y a des écarts ou des produits défectueux, il les note dans un carnet séparé pour les retours ou réclamations, et contacte le fournisseur pour un remboursement ou un échange. Les paiements aux fournisseurs sont effectués en espèces ou par chèque, et il garde des reçus papier pour chaque transaction.

La gestion des ventes est tout aussi manuelle : lorsqu'un client arrive avec ou sans ordonnance, M. Dibaphar vérifie la disponibilité du produit sur les étagères ou dans son registre, délivre le médicament, conseille le client sur son usage (posologie, effets secondaires, interactions), et enregistre la vente dans un journal de caisse quotidien. Pour chaque vente, il note le nom du produit, la quantité vendue, le prix unitaire, le montant total, la date, et parfois le nom du client si c'est un habitué. Les ordonnances sont conservées dans un classeur pour traçabilité, avec des détails comme le nom du médecin prescripteur, le nom du patient, et la date de délivrance. Si un produit est en rupture de stock, M. Dibaphar note la demande dans un "carnet de commandes clients" pour prioriser les prochains achats, et informe le client d'un délai approximatif de réapprovisionnement (généralement 2-3 jours).

M. Dibaphar effectue un inventaire périodique, environ une fois par mois ou avant une grosse commande, où il compte physiquement tous les produits sur les étagères et compare avec son registre pour détecter les écarts dus à des pertes, des vols, des expirations ou des erreurs de comptage. Les produits expirés sont isolés dans une boîte dédiée, notés comme "périmés" dans le registre, et détruits ou renvoyés au fournisseur si possible ; il enregistre aussi leur valeur pour ajuster ses comptes. Pour les produits à rotation rapide comme les antalgiques ou les antiseptiques, il maintient un seuil minimal de stock (par exemple, au moins 10 boîtes pour les best-sellers) qu'il surveille visuellement. Les clients peuvent retourner des produits non ouverts dans les 7 jours, et M. Dibaphar note ces retours dans son journal, rembourse en espèces et remet le produit en stock si son état le permet.

Les informations manipulées incluent, entre autres : nom du produit, code-barres (s'il est présent sur l'emballage), quantité en stock, date d'achat, date d'expiration, prix d'achat, prix de vente, nom du fournisseur, référence de commande, nom du client (pour les ventes sur ordonnance), date de vente, montant encaissé, matricule fiscal de la pharmacie (pour les déclarations annuelles), libellé de la catégorie (médicaments, parapharmacie), et notes sur les interactions ou contre-indications. M. Dibaphar garde aussi un dossier pour les rapports réglementaires, comme les déclarations mensuelles à l'agence nationale des médicaments sur les ventes de substances contrôlées (par exemple, opioïdes ou antibiotiques), qu'il remplit à la main et envoie par courrier.

Le fonctionnement quotidien implique plusieurs flux : par exemple, un client entre librement dans la pharmacie, consulte les produits en rayon ou demande conseil à M. Dibaphar, qui vérifie son registre si nécessaire. Pour les achats en gros, M. Dibaphar négocie directement avec les fournisseurs pour des remises sur volume, et note ces accords dans son cahier. En cas de pic de demande (comme pendant une épidémie de grippe), il ajuste manuellement ses commandes pour éviter les ruptures. Les pertes dues à des vols ou des dommages sont rares mais notées dans un registre des incidents, avec des estimations de valeur pour l'assurance. M. Dibaphar gère aussi les paiements clients en espèces, carte bancaire (via un terminal manuel) ou crédit pour les habitués, et ferme sa caisse chaque soir en comptant les recettes et en les comparant aux ventes enregistrées.

Enfin, la pharmacie est en relation avec des acteurs externes : les médecins locaux pour les ordonnances, les autorités sanitaires pour les inspections annuelles (où M. Dibaphar présente ses registres), et les clients fidèles qui reçoivent des conseils personnalisés basés sur leurs historiques notés dans un carnet privé. Tout cela est géré de manière informelle et manuelle, sans automatisation, ce qui permet à M. Dibaphar de maintenir un contrôle total mais peut entraîner des erreurs humaines ou des retards lors des pics d'activité.

Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus.




</prompt>
<div>
  ### Étude de Cas : Gestion des Stocks dans la Pharmacie DIBAPHAR

La pharmacie DIBAPHAR est une petite structure familiale située dans un quartier résidentiel d'une ville moyenne, gérée exclusivement par un seul pharmacien, M. Dibaphar, qui en est le propriétaire et s'occupe de toutes les opérations quotidiennes. Étant une petite pharmacie indépendante, tout est géré manuellement sans aucun système informatisé : M. Dibaphar utilise des cahiers, des registres papier, des fiches cartonnées et des étagères pour organiser ses activités. Il n'y a pas de personnel supplémentaire ; il est à la fois le gérant, le vendeur, l'acheteur et le responsable des stocks. La pharmacie opère du lundi au dimanche, de 9h à 18h, et sert une clientèle locale composée principalement de résidents du quartier, de patients réguliers et de quelques médecins environnants qui prescrivent des médicaments.

Les stocks de la pharmacie incluent une variété de produits pharmaceutiques et parapharmaceutiques : médicaments sur ordonnance (comme des antibiotiques, des antidouleurs, des traitements pour maladies chroniques), médicaments en vente libre (tels que des sirops contre la toux, des vitamines, des crèmes dermatologiques), produits de soins personnels (shampoing, dentifrice, bandages), et quelques équipements basiques (thermomètres, tensiomètres). Chaque produit est identifié par son nom commercial, son principe actif, son dosage, sa forme (comprimés, sirops, pommades), sa date d'expiration, son prix d'achat, son prix de vente et son numéro de lot fourni par le fabricant. M. Dibaphar maintient un registre principal des stocks où il note manuellement, pour chaque produit, la quantité initiale achetée, les entrées (achats), les sorties (ventes ou pertes), et la quantité restante. Il utilise également des étiquettes collées sur les boîtes pour indiquer les dates d'expiration et les numéros de lot.

Un aspect clé de la gestion est l'approvisionnement : M. Dibaphar contacte personnellement ses fournisseurs, qui sont des grossistes pharmaceutiques locaux ou parfois des représentants de laboratoires. Il passe des commandes par téléphone ou en personne, en se basant sur ses besoins estimés et les demandes récurrentes de ses clients. Pour chaque commande, il note dans un cahier dédié le nom du fournisseur, la date de commande, la liste des produits commandés (avec quantités et prix unitaires), la date de livraison prévue et le montant total. À la réception des marchandises, il vérifie manuellement la conformité (quantités, état des produits, dates d'expiration) et met à jour son registre des stocks en ajoutant les nouvelles quantités. S'il y a des écarts ou des produits défectueux, il les note dans un carnet séparé pour les retours ou réclamations, et contacte le fournisseur pour un remboursement ou un échange. Les paiements aux fournisseurs sont effectués en espèces ou par chèque, et il garde des reçus papier pour chaque transaction.

La gestion des ventes est tout aussi manuelle : lorsqu'un client arrive avec ou sans ordonnance, M. Dibaphar vérifie la disponibilité du produit sur les étagères ou dans son registre, délivre le médicament, conseille le client sur son usage (posologie, effets secondaires, interactions), et enregistre la vente dans un journal de caisse quotidien. Pour chaque vente, il note le nom du produit, la quantité vendue, le prix unitaire, le montant total, la date, et parfois le nom du client si c'est un habitué. Les ordonnances sont conservées dans un classeur pour traçabilité, avec des détails comme le nom du médecin prescripteur, le nom du patient, et la date de délivrance. Si un produit est en rupture de stock, M. Dibaphar note la demande dans un "carnet de commandes clients" pour prioriser les prochains achats, et informe le client d'un délai approximatif de réapprovisionnement (généralement 2 à 3 jours).

M. Dibaphar effectue un inventaire périodique, environ une fois par mois ou avant une grosse commande, où il compte physiquement tous les produits sur les étagères et compare avec son registre pour détecter les écarts dus à des pertes, des vols, des expirations ou des erreurs de comptage. Les produits expirés sont isolés dans une boîte dédiée, notés comme "périmés" dans le registre, et détruits ou renvoyés au fournisseur si possible ; il enregistre aussi leur valeur pour ajuster ses comptes. Pour les produits à rotation rapide comme les antalgiques ou les antiseptiques, il maintient un seuil minimal de stock (par exemple, au moins 10 boîtes pour les produits les plus demandés) qu'il surveille visuellement. Les clients peuvent retourner des produits non ouverts dans les 7 jours, et M. Dibaphar note ces retours dans son journal, rembourse en espèces et remet le produit en stock si son état le permet.

Les informations manipulées incluent, entre autres : nom du produit, code-barres (s'il est présent sur l'emballage), quantité en stock, date d'achat, date d'expiration, prix d'achat, prix de vente, nom du fournisseur, référence de commande, nom du client (pour les ventes sur ordonnance), date de vente, montant encaissé, matricule fiscal de la pharmacie (pour les déclarations annuelles), libellé de la catégorie (médicaments, parapharmacie), et notes sur les interactions ou contre-indications. M. Dibaphar garde aussi un dossier pour les rapports réglementaires, comme les déclarations mensuelles à l'agence nationale des médicaments sur les ventes de substances contrôlées (par exemple, opioïdes ou antibiotiques), qu'il remplit à la main et envoie par courrier.

Le fonctionnement quotidien implique plusieurs flux : par exemple, un client entre librement dans la pharmacie, consulte les produits en rayon ou demande conseil à M. Dibaphar, qui vérifie son registre si nécessaire. Pour les achats en gros, M. Dibaphar négocie directement avec les fournisseurs pour des remises sur volume, et note ces accords dans son cahier. En cas de pic de demande (comme pendant une épidémie de grippe), il ajuste manuellement ses commandes pour éviter les ruptures. Les pertes dues à des vols ou des dommages sont rares mais notées dans un registre des incidents, avec des estimations de valeur pour l'assurance. M. Dibaphar gère aussi les paiements clients en espèces ou en crédit pour les habitués, et ferme sa caisse chaque soir en comptant les recettes et en les comparant aux ventes enregistrées.

Enfin, la pharmacie est en relation avec des acteurs externes : les médecins locaux pour les ordonnances, les autorités sanitaires pour les inspections annuelles (où M. Dibaphar présente ses registres), et les clients fidèles qui reçoivent des conseils personnalisés basés sur leurs historiques notés dans un carnet privé. Tout cela est géré de manière informelle et manuelle, sans automatisation, ce qui permet à M. Dibaphar de maintenir un contrôle total mais peut entraîner des erreurs humaines ou des retards lors des pics d'activité.

**Objectif de l'analyse** : Sur la base de cette étude de cas réalisée dans le cadre de notre formation en gestion, nous procéderons à la modélisation complète du système d'information de la pharmacie DIBAPHAR en élaborant les modèles conceptuels, organisationnels, logiques et physiques (MCC, MCD, MCT, MOT, MOD, MLD et MPD).
</div>

<div>
  ### Étude de Cas : Gestion des Stocks dans la Pharmacie DIBAPHAR

La pharmacie DIBAPHAR est une petite structure familiale située dans un quartier résidentiel d'une ville moyenne, gérée exclusivement par un seul pharmacien, M. Dibaphar, qui en est le propriétaire et s'occupe de toutes les opérations quotidiennes. Étant une petite pharmacie indépendante, tout est géré manuellement sans aucun système informatisé : M. Dibaphar utilise des cahiers, des registres papier, des fiches cartonnées et des étagères pour organiser ses activités. Il n'y a pas de personnel supplémentaire ; il est à la fois le gérant, le vendeur, l'acheteur et le responsable des stocks. La pharmacie opère du lundi au dimanche, de 8h à 20h, et sert une clientèle locale composée principalement de résidents du quartier, de patients réguliers et de quelques médecins environnants qui prescrivent des médicaments.

Les stocks de la pharmacie incluent une variété de produits pharmaceutiques et parapharmaceutiques : médicaments sur ordonnance (comme des antibiotiques, des antihypertenseurs, des antiallergiques), médicaments en vente libre (tels que des sirops contre la toux, des vitamines, des crèmes dermatologiques), produits de soins personnels (shampoing, dentifrice, bandages), et quelques équipements basiques (thermomètres, tensiomètres). Chaque produit est identifié par son nom commercial, son principe actif, son dosage, sa forme (comprimés, sirops, pommades), sa date d'expiration, son prix d'achat, son prix de vente et son numéro de lot fourni par le fabricant. M. Dibaphar maintient un registre principal des stocks où il note manuellement, pour chaque produit, la quantité initiale achetée, les entrées (achats), les sorties (ventes ou pertes), et la quantité restante. Il utilise également des étiquettes collées sur les boîtes pour indiquer les dates d'expiration et les numéros de lot.

Un aspect clé de la gestion est l'approvisionnement : M. Dibaphar contacte personnellement ses fournisseurs, qui sont des grossistes pharmaceutiques locaux ou des représentants de laboratoires. Il passe des commandes par téléphone ou en personne, en se basant sur ses besoins estimés et les demandes récurrentes de ses clients. Pour chaque commande, il note dans un cahier dédié le nom du fournisseur, la date de commande, la liste des produits commandés (avec quantités et prix unitaires), la date de livraison prévue et le montant total. À la réception des marchandises, il vérifie manuellement la conformité (quantités, état des produits, dates d'expiration) et met à jour son registre des stocks en ajoutant les nouvelles quantités. S'il y a des écarts ou des produits défectueux, il les note dans un carnet séparé pour les retours ou réclamations, et contacte le fournisseur pour un remboursement ou un échange. Les paiements aux fournisseurs sont effectués en espèces ou par chèque, et il garde des reçus papier pour chaque transaction.

La gestion des ventes est tout aussi manuelle : lorsqu'un client arrive avec ou sans ordonnance, M. Dibaphar vérifie la disponibilité du produit sur les étagères ou dans son registre, délivre le médicament, conseille le client sur son usage (posologie, effets secondaires, interactions), et enregistre la vente dans un journal de caisse quotidien. Pour chaque vente, il note le nom du produit, la quantité vendue, le prix unitaire, le montant total, la date, et parfois le nom du client si c'est un habitué. Les ordonnances sont conservées dans un classeur pour traçabilité, avec des détails comme le nom du médecin prescripteur, le nom du patient, et la date de délivrance. Si un produit est en rupture de stock, M. Dibaphar note la demande dans un "carnet de commandes clients" pour prioriser les prochains achats, et informe le client d'un délai approximatif de réapprovisionnement (généralement 2-3 jours).

M. Dibaphar effectue un inventaire périodique, environ une fois par mois ou avant une grosse commande, où il compte physiquement tous les produits sur les étagères et compare avec son registre pour détecter les écarts dus à des pertes, des vols, des expirations ou des erreurs de comptage. Les produits expirés sont isolés dans une boîte dédiée, notés comme "périmés" dans le registre, et détruits ou renvoyés au fournisseur si possible ; il enregistre aussi leur valeur pour ajuster ses comptes. Pour les produits à rotation rapide comme les antalgiques ou les antiseptiques, il maintient un seuil minimal de stock (par exemple, au moins 10 boîtes pour les best-sellers) qu'il surveille visuellement. Les clients peuvent retourner des produits non ouverts dans les 7 jours, et M. Dibaphar note ces retours dans son journal, rembourse en espèces et remet le produit en stock si son état le permet.

Les informations manipulées incluent, entre autres : nom du produit, code-barres (s'il est présent sur l'emballage), quantité en stock, date d'achat, date d'expiration, prix d'achat, prix de vente, nom du fournisseur, référence de commande, nom du client (pour les ventes sur ordonnance), date de vente, montant encaissé, matricule fiscal de la pharmacie (pour les déclarations annuelles), libellé de la catégorie (médicaments, parapharmacie), et notes sur les interactions ou contre-indications. M. Dibaphar garde aussi un dossier pour les rapports réglementaires, comme les déclarations mensuelles à l'agence nationale des médicaments sur les ventes de substances contrôlées (par exemple, opioïdes ou antibiotiques), qu'il remplit à la main et envoie par courrier.

Le fonctionnement quotidien implique plusieurs flux : par exemple, un client entre librement dans la pharmacie, consulte les produits en rayon ou demande conseil à M. Dibaphar, qui vérifie son registre si nécessaire. Pour les achats en gros, M. Dibaphar négocie directement avec les fournisseurs pour des remises sur volume, et note ces accords dans son cahier. En cas de pic de demande (comme pendant une épidémie de grippe), il ajuste manuellement ses commandes pour éviter les ruptures. Les pertes dues à des vols ou des dommages sont rares mais notées dans un registre des incidents, avec des estimations de valeur pour l'assurance. M. Dibaphar gère aussi les paiements clients en espèces ou crédit pour les habitués, et ferme sa caisse chaque soir en comptant les recettes et en les comparant aux ventes enregistrées.

Enfin, la pharmacie est en relation avec des acteurs externes : les médecins locaux pour les ordonnances, les autorités sanitaires pour les inspections annuelles (où M. Dibaphar présente ses registres), et les clients fidèles qui reçoivent des conseils personnalisés basés sur leurs historiques notés dans un carnet privé. Tout cela est géré de manière informelle et manuelle, sans automatisation, ce qui permet à M. Dibaphar de maintenir un contrôle total mais peut entraîner des erreurs humaines ou des retards lors des pics d'activité.

**Objectif de l'étude** : Sur la base de cette analyse terrain réalisée à la pharmacie DIBAPHAR, il s'agit de modéliser le système d'information actuel en élaborant les différents modèles conceptuels, organisationnels, logiques et physiques (MCC, MCD, MCT, MOT, MOD, MLD et MPD) afin de proposer une base solide pour une éventuelle informatisation du système de gestion.
</div>
<div>
  D'après l'énoncé, voici les différents acteurs qui font les flux de communication et les flux de communication entre les acteurs (internes et externes) :

## Acteurs identifiés

**Acteurs internes :**
- M. Dibaphar (le pharmacien propriétaire)

**Acteurs externes :**
- Clients (habitants du quartier, patients réguliers)
- Fournisseurs (grossistes pharmaceutiques locaux, représentants de laboratoires)
- Médecins locaux
- Autorités sanitaires/agence nationale des médicaments

## Types de flux de communication
- **Flux internes** : Inexistants car M. Dibaphar est le seul acteur interne
- **Flux externes** : Entre M. Dibaphar et les acteurs externes (clients, fournisseurs, médecins, autorités)

## Liste des flux de communication entre les acteurs (dans l'ordre de l'énoncé)

1. M. Dibaphar → Fournisseurs : Contact pour passer des commandes (par téléphone ou en personne)
2. Fournisseurs → M. Dibaphar : Livraison des marchandises commandées
3. M. Dibaphar → Fournisseurs : Signalement des écarts ou produits défectueux (pour retours ou réclamations)
4. M. Dibaphar → Fournisseurs : Paiement aux fournisseurs (espèces ou chèque)
5. Clients → M. Dibaphar : Demande de médicaments (avec ou sans ordonnance)
6. M. Dibaphar → Clients : Vérification de disponibilité, délivrance du médicament et conseils d'usage
7. Clients → M. Dibaphar : Paiement des produits achetés
8. Médecins → Clients → M. Dibaphar : Transmission d'ordonnances
9. M. Dibaphar → Clients : Information sur délai de réapprovisionnement si rupture de stock
10. Clients → M. Dibaphar : Retour de produits non ouverts (dans les 7 jours)
11. M. Dibaphar → Clients : Remboursement des produits retournés
12. M. Dibaphar → Autorités sanitaires : Déclarations mensuelles sur les ventes de substances contrôlées (par courrier)
13. M. Dibaphar → Fournisseurs : Négociation pour des remises sur volume pour les achats en gros
14. M. Dibaphar → Clients : Gestion des paiements (espèces ou crédit pour les habitués)
15. Autorités sanitaires → M. Dibaphar : Inspections annuelles
16. M. Dibaphar → Autorités sanitaires : Présentation des registres lors des inspections
17. M. Dibaphar → Clients fidèles : Conseils personnalisés basés sur leurs historiques

Ces flux de communication sont tous gérés de manière manuelle et informelle, sans aucune automatisation, comme précisé dans l'énoncé.
</div>
<div>
  Voici les acteurs avec une courte description de leur rôle :

## Acteurs identifiés avec leurs rôles

**Acteur interne :**
- **M. Dibaphar** : Pharmacien propriétaire gérant toutes les opérations (gestion des stocks, ventes, achats, conseil aux clients)

**Acteurs externes :**
- **Clients** : Consommateurs des produits pharmaceutiques (patients réguliers, habitants du quartier)
- **Fournisseurs** : Grossistes pharmaceutiques et laboratoires approvisionnant la pharmacie en médicaments
- **Médecins locaux** : Prescripteurs d'ordonnances pour les patients
- **Autorités sanitaires** : Organismes de régulation effectuant des contrôles et recevant des déclarations obligatoires

## Liste des flux de communication entre les acteurs (dans l'ordre de l'énoncé)

[Liste des flux identique à celle fournie précédemment]
</div>


<promt>
Crée un énoncé pour le cas de gestion de stocks de la pharmacie DIBAPHAR qui est géré par un seul pharmacien qui s'occupe de tout, car c'est une petite pharmacie à lui , il gère tout manuellement

Les données ou contenues de cet énoncé nous permettra de connaître cette pharmacie afin de pouvoir réaliser son MCC, MCT, MOT(MOpt), MCD, MOD, MLD et MLD 

Faut tenir compte des différentes modèles lorsque tu réalises l'énoncé par exemple pour MOT tu sais déjà que ça première règle d'organisation exigent le temps 

Voici quelques exemples de description qu'on a fait à l'exercice :

""""
Q8) Gestion des Abonnés dans une bibliothèque X 
On veut automatiser le fonctionnement d'une bibliothèque. La bibliothèque est 
organisée de la façon suivante : 
Un service s'occupe de l'achat des exemplaires d'ouvrage soit pour renouvellement 
d'exemplaires usagés, soit pour acquisition de nouveaux exemplaires ; dans ce dernier 
cas, ce service enregistre les références communes à plusieurs exemplaires, soit 
l'auteur, le titre, la valeur de remplacement, le résumé ainsi que quelques mots clés. 
Les exemplaires sont repérés par un code barre (n° séquentiel unique) collé au dos de 
l'exemplaire). Tout exemplaire correspond à un ouvrage de référence. On veut 
mémoriser la date d'acquisition de l'exemplaire et sa durée de vie estimée. 
Un service s'occupe de l'inscription des emprunteurs. Les emprunteurs sont identifiés 
par une carte comprenant un code barre (n° séquentiel unique). Pour chaque 
emprunteur on mémorise son nom, prénom, adresse, email. 
Un service s'occupe de l'enregistrement des prêts d'exemplaires. Les prêts sont 
mémorisés afin de savoir à tout moment, quels sont les exemplaires sortis. Pour chaque 
prêt ou emprunt on mémorise donc le code exemplaire, le code emprunteur et la date 
de retour au plus tard de cet exemplaire. Cette date est calculée automatiquement par 
date d'emprunt + 3 semaines. 
Un emprunteur peut emprunter au maximum 3 exemplaires. 
Un service s'occupe du retour des exemplaires et de leur placement en rayons. 
Lorsque l'exemplaire est retourné en bon état, on supprime l'enregistrement de cet 
emprunt. 
Lorsque la date de retour échoit, on relance l'emprunteur par email de préférence, par 
courrier si l'adresse email est inconnue. Lorsque l'exemplaire retourné est réputé perdu, 
on envoie un courrier à l'emprunteur exigeant le paiement de la valeur de 
remplacement. 
L'emprunteur entre librement dans la bibliothèque, circule dans les rayons, consulte le 
catalogue des exemplaires s'il le souhaite. Il prend les exemplaires d'ouvrage 
disponibles puis passe au service d'enregistrement des prêts. Le service achats est en 
relation commerciale avec l'éditeur. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

Question 11) ETUDE DE CAS : Gestion des enfants désœuvrés dans un centre 
d’hébergement 
L’étude d’un système de gestion des enfants désœuvrés dans un centre 
d’hébergement a donné les résultats suivants : les informations manipulées sont 
reprises dans un dictionnaire de données présenté ci-dessous : 
Nom enfant, postnom enfant, prénom enfant, sexe enfant, âge enfant, numéro site, 
libellé commune, référence enfant, référence commune, libellé site, nombre 
d’enfants du site, matricule encadreur, nom encadreur, postnom encadreur, sexe 
encadreur, état civil encadreur, niveau d’étude, fonction, référence cotation, libellé 
cotation, cote, activité, numéro chambre, désignation pavillon, désignation activité. 
Le fonctionnement de ce système se résume à travers de la description suivante : 
Les enfants sont logés dans les chambres ; les enfants sont affectés dans un site se 
trouvant dans une commune. Les enfants sont encadrés par les encadreurs selon 
les activités. Un encadreur réalise plusieurs activités. Une activité donne lieu à une 
ou plusieurs cotations pour un ou plusieurs enfants à savoir plusieurs enfants sont 
concernés par plusieurs activités. 
De l’affiliation : un acteur social sollicite l’hébergement d’un enfant à travers d’un 
document appelé demande d’hébergement qu’il adresse à la réception. Celui-ci 
après son enregistrement, la transmet au Conseiller Social qui analyse la demande. 
Deux solutions sont envisageables : en cas de refus, la note de refus et la demande 
sont renvoyés auprès de l’acteur social. Par contre, l’ordre d’acception est transmis 
au Comité de prise en charge des enfants deseouvrés qui obligatoirement établit 
l’ordre d’hébergement et l’autre copie à l’acteur social. Ce service établit chaque 
fois un rapport adressé au Comité de prise en charge des enfants. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

"""""



NB : réalise juste un texte description, un énoncé, je ne demande pas d'organiser ou de classer les choses 
Voilà pourquoi je t'ai montré les exemples des exercices qu'on avait effectué 

On parle juste du système actuel, on ne conçoit pas de logiciel 

Je veux que tu utilises informations inventés car je ne t'ai pas fourni tous les détails 
Faut vraiment parler de tout  
</promt>
<prompt>
  Crée un énoncé pour le cas de gestion de stocks de la pharmacie DIBAPHAR qui est géré par un seul pharmacien qui s'occupe de tout, car c'est une petite pharmacie à lui , il gère tout manuellement

Les données ou contenues de cet énoncé nous permettra de connaître cette pharmacie afin de pouvoir réaliser son MCC, MCT, MOT(MOpt), MCD, MOD, MLD et MLD 

Faut tenir compte des différentes modèles lorsque tu réalises l'énoncé par exemple pour MOT tu sais déjà que ça première règle d'organisation exigent le temps 

Voici quelques exemples de description qu'on a fait à l'exercice :

""""
Q8) Gestion des Abonnés dans une bibliothèque X 
On veut automatiser le fonctionnement d'une bibliothèque. La bibliothèque est 
organisée de la façon suivante : 
Un service s'occupe de l'achat des exemplaires d'ouvrage soit pour renouvellement 
d'exemplaires usagés, soit pour acquisition de nouveaux exemplaires ; dans ce dernier 
cas, ce service enregistre les références communes à plusieurs exemplaires, soit 
l'auteur, le titre, la valeur de remplacement, le résumé ainsi que quelques mots clés. 
Les exemplaires sont repérés par un code barre (n° séquentiel unique) collé au dos de 
l'exemplaire). Tout exemplaire correspond à un ouvrage de référence. On veut 
mémoriser la date d'acquisition de l'exemplaire et sa durée de vie estimée. 
Un service s'occupe de l'inscription des emprunteurs. Les emprunteurs sont identifiés 
par une carte comprenant un code barre (n° séquentiel unique). Pour chaque 
emprunteur on mémorise son nom, prénom, adresse, email. 
Un service s'occupe de l'enregistrement des prêts d'exemplaires. Les prêts sont 
mémorisés afin de savoir à tout moment, quels sont les exemplaires sortis. Pour chaque 
prêt ou emprunt on mémorise donc le code exemplaire, le code emprunteur et la date 
de retour au plus tard de cet exemplaire. Cette date est calculée automatiquement par 
date d'emprunt + 3 semaines. 
Un emprunteur peut emprunter au maximum 3 exemplaires. 
Un service s'occupe du retour des exemplaires et de leur placement en rayons. 
Lorsque l'exemplaire est retourné en bon état, on supprime l'enregistrement de cet 
emprunt. 
Lorsque la date de retour échoit, on relance l'emprunteur par email de préférence, par 
courrier si l'adresse email est inconnue. Lorsque l'exemplaire retourné est réputé perdu, 
on envoie un courrier à l'emprunteur exigeant le paiement de la valeur de 
remplacement. 
L'emprunteur entre librement dans la bibliothèque, circule dans les rayons, consulte le 
catalogue des exemplaires s'il le souhaite. Il prend les exemplaires d'ouvrage 
disponibles puis passe au service d'enregistrement des prêts. Le service achats est en 
relation commerciale avec l'éditeur. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

Question 11) ETUDE DE CAS : Gestion des enfants désœuvrés dans un centre 
d’hébergement 
L’étude d’un système de gestion des enfants désœuvrés dans un centre 
d’hébergement a donné les résultats suivants : les informations manipulées sont 
reprises dans un dictionnaire de données présenté ci-dessous : 
Nom enfant, postnom enfant, prénom enfant, sexe enfant, âge enfant, numéro site, 
libellé commune, référence enfant, référence commune, libellé site, nombre 
d’enfants du site, matricule encadreur, nom encadreur, postnom encadreur, sexe 
encadreur, état civil encadreur, niveau d’étude, fonction, référence cotation, libellé 
cotation, cote, activité, numéro chambre, désignation pavillon, désignation activité. 
Le fonctionnement de ce système se résume à travers de la description suivante : 
Les enfants sont logés dans les chambres ; les enfants sont affectés dans un site se 
trouvant dans une commune. Les enfants sont encadrés par les encadreurs selon 
les activités. Un encadreur réalise plusieurs activités. Une activité donne lieu à une 
ou plusieurs cotations pour un ou plusieurs enfants à savoir plusieurs enfants sont 
concernés par plusieurs activités. 
De l’affiliation : un acteur social sollicite l’hébergement d’un enfant à travers d’un 
document appelé demande d’hébergement qu’il adresse à la réception. Celui-ci 
après son enregistrement, la transmet au Conseiller Social qui analyse la demande. 
Deux solutions sont envisageables : en cas de refus, la note de refus et la demande 
sont renvoyés auprès de l’acteur social. Par contre, l’ordre d’acception est transmis 
au Comité de prise en charge des enfants deseouvrés qui obligatoirement établit 
l’ordre d’hébergement et l’autre copie à l’acteur social. Ce service établit chaque 
fois un rapport adressé au Comité de prise en charge des enfants. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

"""""



NB : réalise juste un texte description, un énoncé, je ne demande pas d'organiser ou de classer les choses 
Voilà pourquoi je t'ai montré les exemples des exercices qu'on avait effectué 

On parle juste du système actuel, on ne conçoit pas de logiciel 

Je veux que tu utilises informations inventés car je ne t'ai pas fourni tous les détails 
Faut vraiment parler de tout

L'énoncé doit être sous forme d'un texte unique comme dans les exemples
</prompt>

<div>
  La pharmacie DIBAPHAR est une petite structure familiale gérée exclusivement par M. Dibaphar, affectueusement connu sous le nom de PAPA DIBAPHAR dans le quartier, qui s'occupe seul de toutes les opérations quotidiennes de manière manuelle, sans recours à un système informatisé. Située dans un quartier résidentiel animé, elle propose une gamme variée de médicaments, produits parapharmaceutiques et articles de soins de base, et fonctionne du lundi au samedi de 8h à 20h, avec des fermetures occasionnelles pour inventaire ou repos. PAPA DIBAPHAR gère personnellement l'achat des stocks auprès de fournisseurs locaux et grossistes, en passant des commandes par téléphone ou en personne, en tenant compte des besoins estimés basés sur les ventes passées et les demandes récurrentes des clients fidèles. Pour chaque achat, il note manuellement dans un cahier dédié les détails des produits commandés, tels que le nom du médicament (par exemple, paracétamol 500mg, antibiotiques comme l'amoxicilline, ou produits comme des crèmes solaires et des vitamines), la quantité, le prix unitaire d'achat, la date de commande, le nom du fournisseur (comme Grossiste PharmaNord ou LaboSud), et la date prévue de livraison ; il conserve également les factures papier pour référence. À la réception des marchandises, PAPA DIBAPHAR vérifie physiquement les colis pour s'assurer de la conformité (quantité, état, dates d'expiration), note la date effective de réception et met à jour son registre des stocks en ajoutant les nouveaux articles, tout en rangeant les produits sur les étagères selon une organisation simple par catégorie (médicaments sur ordonnance, produits en libre-service, articles périssables comme les vaccins réfrigérés). Les stocks sont suivis via un inventaire manuel périodique, généralement tous les vendredis soir, où il compte les unités restantes pour chaque produit, calcule les écarts dus aux ventes ou aux pertes (comme les produits expirés ou endommagés), et estime la durée de vie restante des stocks en fonction des dates d'expiration obligatoires pour les médicaments (par exemple, un lot de sirop contre la toux expire dans 6 mois, et il note cela pour prioriser les ventes). Les ventes aux clients se font au comptoir : un client peut être un habitué du quartier identifié par son nom ou un surnom (comme Mme Dupont ou le petit Jean), ou un visiteur occasionnel ; PAPA DIBAPHAR enregistre chaque transaction dans un livre de caisse avec la date et l'heure approximative de la vente, le nom du produit vendu, la quantité, le prix de vente (incluant une marge bénéficiaire calculée mentalement, par exemple 20% sur le prix d'achat), le montant total payé (en espèces ou parfois par chèque), et des notes sur le client si c'est une ordonnance médicale (il vérifie sommairement la prescription fournie par le client, note le nom du médecin prescripteur et la date de l'ordonnance). Pour les médicaments sur ordonnance, il conserve une copie carbone de la prescription dans un dossier pour traçabilité, et il gère les stocks sensibles comme les stupéfiants en les verrouillant dans un coffre, avec un registre séparé indiquant les entrées et sorties, y compris les quantités minimales requises par la réglementation. Les clients peuvent consulter PAPA DIBAPHAR pour des conseils gratuits sur l'utilisation des produits, et il note parfois des retours ou plaintes (comme un produit défectueux) pour ajuster les futures commandes. En cas de rupture de stock, il propose des alternatives ou note la demande pour une commande urgente, en mémorisant ou en inscrivant dans un carnet les besoins récurrents (par exemple, une augmentation des demandes d'antihistaminiques pendant la saison des allergies). PAPA DIBAPHAR gère aussi les retours de produits non utilisés (dans un délai de 7 jours, si non ouverts), en les réintégrant au stock après vérification, et il effectue des promotions manuelles sur les articles proches de l'expiration pour écouler les stocks, en affichant des étiquettes papier. Les fournisseurs sont suivis via un fichier de contacts avec leurs adresses, numéros de téléphone, conditions de paiement (généralement à 30 jours, notées sur les factures), et historique des livraisons fiables ou des retards (par exemple, un fournisseur en retard de 2 jours la semaine passée). Pour les aspects financiers, il tient un bilan manuel quotidien des recettes et dépenses, calculant le solde en fin de journée et déposant les espèces à la banque tous les deux jours ; il gère les impayés rares en notant les dettes des clients de confiance. Les règles d'organisation incluent une gestion temporelle stricte : les commandes sont passées tous les mardis pour livraison le jeudi, les inventaires mensuels complets évaluent la rotation des stocks sur 30 jours, et les produits expirés sont retirés et détruits selon un calendrier (par exemple, vérification mensuelle des dates, avec destruction notée le premier du mois). PAPA DIBAPHAR entretient des relations avec les médecins locaux pour des recommandations, et il archive manuellement les documents comme les ordonnances et factures dans des classeurs par année, pour tout contrôle éventuel des autorités sanitaires. Ce système manuel, bien que simple, permet à PAPA DIBAPHAR de maintenir un équilibre entre stocks disponibles, satisfaction client et rentabilité, tout en respectant les normes de traçabilité pour une petite pharmacie. Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus.
</div>


<prompt>
  Crée un énoncé pour le cas de gestion de stocks de la pharmacie DIBAPHAR qui est géré par un seul pharmacien qui s'occupe de tout, car c'est une petite pharmacie à lui , il gère tout manuellement

Les données ou contenues de cet énoncé nous permettra de connaître cette pharmacie afin de pouvoir réaliser son MCC, MCT, MOT(MOpt), MCD, MOD, MLD et MLD 

Faut tenir compte des différentes modèles lorsque tu réalises l'énoncé par exemple pour MOT tu sais déjà que ça première règle d'organisation exigent le temps 

Les détails sur les noms propres ne sont pas nécessaires, on peut utiliser M. Dibaphar car on l'appelle souvent PAPA DIBAPHAR car il est uniquement connu sur ce nom 

Voici quelques exemples de description qu'on a fait à l'exercice :

""""
Q8) Gestion des Abonnés dans une bibliothèque X 
On veut automatiser le fonctionnement d'une bibliothèque. La bibliothèque est 
organisée de la façon suivante : 
Un service s'occupe de l'achat des exemplaires d'ouvrage soit pour renouvellement 
d'exemplaires usagés, soit pour acquisition de nouveaux exemplaires ; dans ce dernier 
cas, ce service enregistre les références communes à plusieurs exemplaires, soit 
l'auteur, le titre, la valeur de remplacement, le résumé ainsi que quelques mots clés. 
Les exemplaires sont repérés par un code barre (n° séquentiel unique) collé au dos de 
l'exemplaire). Tout exemplaire correspond à un ouvrage de référence. On veut 
mémoriser la date d'acquisition de l'exemplaire et sa durée de vie estimée. 
Un service s'occupe de l'inscription des emprunteurs. Les emprunteurs sont identifiés 
par une carte comprenant un code barre (n° séquentiel unique). Pour chaque 
emprunteur on mémorise son nom, prénom, adresse, email. 
Un service s'occupe de l'enregistrement des prêts d'exemplaires. Les prêts sont 
mémorisés afin de savoir à tout moment, quels sont les exemplaires sortis. Pour chaque 
prêt ou emprunt on mémorise donc le code exemplaire, le code emprunteur et la date 
de retour au plus tard de cet exemplaire. Cette date est calculée automatiquement par 
date d'emprunt + 3 semaines. 
Un emprunteur peut emprunter au maximum 3 exemplaires. 
Un service s'occupe du retour des exemplaires et de leur placement en rayons. 
Lorsque l'exemplaire est retourné en bon état, on supprime l'enregistrement de cet 
emprunt. 
Lorsque la date de retour échoit, on relance l'emprunteur par email de préférence, par 
courrier si l'adresse email est inconnue. Lorsque l'exemplaire retourné est réputé perdu, 
on envoie un courrier à l'emprunteur exigeant le paiement de la valeur de 
remplacement. 
L'emprunteur entre librement dans la bibliothèque, circule dans les rayons, consulte le 
catalogue des exemplaires s'il le souhaite. Il prend les exemplaires d'ouvrage 
disponibles puis passe au service d'enregistrement des prêts. Le service achats est en 
relation commerciale avec l'éditeur. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

Question 11) ETUDE DE CAS : Gestion des enfants désœuvrés dans un centre 
d’hébergement 
L’étude d’un système de gestion des enfants désœuvrés dans un centre 
d’hébergement a donné les résultats suivants : les informations manipulées sont 
reprises dans un dictionnaire de données présenté ci-dessous : 
Nom enfant, postnom enfant, prénom enfant, sexe enfant, âge enfant, numéro site, 
libellé commune, référence enfant, référence commune, libellé site, nombre 
d’enfants du site, matricule encadreur, nom encadreur, postnom encadreur, sexe 
encadreur, état civil encadreur, niveau d’étude, fonction, référence cotation, libellé 
cotation, cote, activité, numéro chambre, désignation pavillon, désignation activité. 
Le fonctionnement de ce système se résume à travers de la description suivante : 
Les enfants sont logés dans les chambres ; les enfants sont affectés dans un site se 
trouvant dans une commune. Les enfants sont encadrés par les encadreurs selon 
les activités. Un encadreur réalise plusieurs activités. Une activité donne lieu à une 
ou plusieurs cotations pour un ou plusieurs enfants à savoir plusieurs enfants sont 
concernés par plusieurs activités. 
De l’affiliation : un acteur social sollicite l’hébergement d’un enfant à travers d’un 
document appelé demande d’hébergement qu’il adresse à la réception. Celui-ci 
après son enregistrement, la transmet au Conseiller Social qui analyse la demande. 
Deux solutions sont envisageables : en cas de refus, la note de refus et la demande 
sont renvoyés auprès de l’acteur social. Par contre, l’ordre d’acception est transmis 
au Comité de prise en charge des enfants deseouvrés qui obligatoirement établit 
l’ordre d’hébergement et l’autre copie à l’acteur social. Ce service établit chaque 
fois un rapport adressé au Comité de prise en charge des enfants. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

"""""



NB : réalise juste un texte description, un énoncé, je ne demande pas d'organiser ou de classer les choses 
Voilà pourquoi je t'ai montré les exemples des exercices qu'on avait effectué 

On parle juste du système actuel, on ne conçoit pas de logiciel 

Je veux que tu utilises informations inventés car je ne t'ai pas fourni tous les détails 
Faut vraiment parler de tout

L'énoncé doit être sous forme d'un texte unique comme dans les exemples
Mais avec des paragraphes, chaque paragraphe est un processus, processus= succession d'opérations d'un même catégorie poursuivant un même but finale., dans chaque processus on aura un acteur interne, soit un acteur interne effectuant une opération avec uniquement un seul acteur externe pas 2 à la fois, il ne faut plus parler de cet acteur externe dans d'autres processus qui parlent d'autres choses, et faut bien respecter les opérations par exemple tu ne peux pas parler de la livraison sans demandes , ou de la réception sans paiement, ... Faut parler de tout sans rien oublier car on doit modéliser tout ça 

N'utilises pas des termes comme "acteurs externes " dans l'énoncé.
</prompt>

<prompt>
  Crée un énoncé pour le cas de gestion de stocks de la pharmacie DIBAPHAR qui est géré par un seul pharmacien qui s'occupe de tout, car c'est une petite pharmacie à lui , il gère tout manuellement

Les données ou contenues de cet énoncé nous permettra de connaître cette pharmacie afin de pouvoir réaliser son MCC, MCT, MOT(MOpt), MCD, MOD, MLD et MLD 

Faut tenir compte des différentes modèles 
Par exemple pour les MCC le plus important c'est les acteurs externes qui font des flux (transmission - réception) direct avec l'interne. Pour le MOT faut juste indiquer l'heure globale d'activité (ouverture -fermeture) car c'est la première règle d'organisation, le MCD les entités à enregistrer, ... 
Tout ceci je ne t'apprends pas, écrit juste l'énoncé proprement comme il faut , comme un texte, tu verras dans les exemples de description que je vais te fournir 

Et faut bien décrire :
Par exemple si tu parles de ventes , tu ne vas pas directement commencer par le paiement du client, faut bien décrire chaque étapes de vente dans toutes ses détails (début - clôture) , une fois clôturé faut plus remettre ce sujet à discussion, par exemple tu parles encore du client alors que t'as déjà parler de tous sur la vente 
N'oublie pas les acteurs qui nous intéresse ici ce sont ceux qui sont indispensables dans la modification du stock, et qui sont en flux de communication direct (transmission-reception) avec la pharmacie 


Les détails sur les noms propres ne sont pas nécessaires, on peut utiliser M. Dibaphar car on l'appelle souvent PAPA DIBAPHAR car il est uniquement connu sur ce nom 

Voici quelques exemples de description qu'on a fait à l'exercice :

""""
Q8) Gestion des Abonnés dans une bibliothèque X 
On veut automatiser le fonctionnement d'une bibliothèque. La bibliothèque est 
organisée de la façon suivante : 
Un service s'occupe de l'achat des exemplaires d'ouvrage soit pour renouvellement 
d'exemplaires usagés, soit pour acquisition de nouveaux exemplaires ; dans ce dernier 
cas, ce service enregistre les références communes à plusieurs exemplaires, soit 
l'auteur, le titre, la valeur de remplacement, le résumé ainsi que quelques mots clés. 
Les exemplaires sont repérés par un code barre (n° séquentiel unique) collé au dos de 
l'exemplaire). Tout exemplaire correspond à un ouvrage de référence. On veut 
mémoriser la date d'acquisition de l'exemplaire et sa durée de vie estimée. 
Un service s'occupe de l'inscription des emprunteurs. Les emprunteurs sont identifiés 
par une carte comprenant un code barre (n° séquentiel unique). Pour chaque 
emprunteur on mémorise son nom, prénom, adresse, email. 
Un service s'occupe de l'enregistrement des prêts d'exemplaires. Les prêts sont 
mémorisés afin de savoir à tout moment, quels sont les exemplaires sortis. Pour chaque 
prêt ou emprunt on mémorise donc le code exemplaire, le code emprunteur et la date 
de retour au plus tard de cet exemplaire. Cette date est calculée automatiquement par 
date d'emprunt + 3 semaines. 
Un emprunteur peut emprunter au maximum 3 exemplaires. 
Un service s'occupe du retour des exemplaires et de leur placement en rayons. 
Lorsque l'exemplaire est retourné en bon état, on supprime l'enregistrement de cet 
emprunt. 
Lorsque la date de retour échoit, on relance l'emprunteur par email de préférence, par 
courrier si l'adresse email est inconnue. Lorsque l'exemplaire retourné est réputé perdu, 
on envoie un courrier à l'emprunteur exigeant le paiement de la valeur de 
remplacement. 
L'emprunteur entre librement dans la bibliothèque, circule dans les rayons, consulte le 
catalogue des exemplaires s'il le souhaite. Il prend les exemplaires d'ouvrage 
disponibles puis passe au service d'enregistrement des prêts. Le service achats est en 
relation commerciale avec l'éditeur. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

Question 11) ETUDE DE CAS : Gestion des enfants désœuvrés dans un centre 
d’hébergement 
L’étude d’un système de gestion des enfants désœuvrés dans un centre 
d’hébergement a donné les résultats suivants : les informations manipulées sont 
reprises dans un dictionnaire de données présenté ci-dessous : 
Nom enfant, postnom enfant, prénom enfant, sexe enfant, âge enfant, numéro site, 
libellé commune, référence enfant, référence commune, libellé site, nombre 
d’enfants du site, matricule encadreur, nom encadreur, postnom encadreur, sexe 
encadreur, état civil encadreur, niveau d’étude, fonction, référence cotation, libellé 
cotation, cote, activité, numéro chambre, désignation pavillon, désignation activité. 
Le fonctionnement de ce système se résume à travers de la description suivante : 
Les enfants sont logés dans les chambres ; les enfants sont affectés dans un site se 
trouvant dans une commune. Les enfants sont encadrés par les encadreurs selon 
les activités. Un encadreur réalise plusieurs activités. Une activité donne lieu à une 
ou plusieurs cotations pour un ou plusieurs enfants à savoir plusieurs enfants sont 
concernés par plusieurs activités. 
De l’affiliation : un acteur social sollicite l’hébergement d’un enfant à travers d’un 
document appelé demande d’hébergement qu’il adresse à la réception. Celui-ci 
après son enregistrement, la transmet au Conseiller Social qui analyse la demande. 
Deux solutions sont envisageables : en cas de refus, la note de refus et la demande 
sont renvoyés auprès de l’acteur social. Par contre, l’ordre d’acception est transmis 
au Comité de prise en charge des enfants deseouvrés qui obligatoirement établit 
l’ordre d’hébergement et l’autre copie à l’acteur social. Ce service établit chaque 
fois un rapport adressé au Comité de prise en charge des enfants. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

"""""



NB : réalise juste un texte description, un énoncé, je ne demande pas d'organiser ou de classer les choses 
Voilà pourquoi je t'ai montré les exemples des exercices qu'on avait effectué 

On parle juste du système actuel, on ne conçoit pas de logiciel 

Je veux que tu utilises informations inventés car je ne t'ai pas fourni tous les détails 
Faut vraiment parler de tout
</prompt>


<prompt>
  Crée un énoncé pour le cas de gestion de stocks de la pharmacie DIBAPHAR qui est géré par un seul pharmacien qui s'occupe de tout, car c'est une petite pharmacie à lui , il gère tout manuellement

Les données ou contenues de cet énoncé nous permettra de connaître cette pharmacie afin de pouvoir réaliser son MCC, MCT, MOT(MOpt), MCD, MOD, MLD et MLD 

Faut tenir compte des différentes modèles 
Par exemple pour les MCC le plus important c'est les acteurs externes qui font des flux (transmission - réception) direct avec l'interne. Pour le MOT faut juste indiquer l'heure globale d'activité (ouverture -fermeture) car c'est la première règle d'organisation, le MCD les entités à enregistrer, ... 
Tout ceci je ne t'apprends pas, écrit juste l'énoncé proprement comme il faut , comme un texte, tu verras dans les exemples de description que je vais te fournir 

Et faut bien décrire :
Par exemple si tu parles de ventes , tu ne vas pas directement commencer par le paiement du client, faut bien décrire chaque étapes de vente dans toutes ses détails (début - clôture) , une fois clôturé faut plus remettre ce sujet à discussion, par exemple tu parles encore du client alors que t'as déjà parler de tous sur la vente 
N'oublie pas les acteurs qui nous intéresse ici ce sont ceux qui sont indispensables dans la modification du stock, et qui sont en flux de communication direct (transmission-reception) avec la pharmacie 
Crée un énoncé pour le cas de gestion de stocks de la pharmacie DIBAPHAR qui est géré par un seul pharmacien qui s'occupe de tout, car c'est une petite pharmacie à lui , il gère tout manuellement

Les données ou contenues de cet énoncé nous permettra de connaître cette pharmacie afin de pouvoir réaliser son MCC, MCT, MOT(MOpt), MCD, MOD, MLD et MLD 

Faut tenir compte des différentes modèles 
Par exemple pour les MCC le plus important c'est les acteurs externes qui font des flux (transmission - réception) direct avec l'interne. Pour le MOT faut juste indiquer l'heure globale d'activité (ouverture -fermeture) car c'est la première règle d'organisation, le MCD les entités à enregistrer, ... 
Tout ceci je ne t'apprends pas, écrit juste l'énoncé proprement comme il faut , comme un texte, tu verras dans les exemples de description que je vais te fournir 

Et faut bien décrire :
Par exemple si tu parles de ventes , tu ne vas pas directement commencer par le paiement du client, faut bien décrire chaque étapes de vente dans toutes ses détails (début - clôture) , une fois clôturé faut plus remettre ce sujet à discussion, par exemple tu parles encore du client alors que t'as déjà parler de tous sur la vente 
N'oublie pas les acteurs qui nous intéresse ici ce sont ceux qui sont indispensables dans la modification du stock, et qui sont en flux de communication direct (transmission-reception) avec la pharmacie 


Les détails sur les noms propres ne sont pas nécessaires, on peut utiliser M. Dibaphar car on l'appelle souvent PAPA DIBAPHAR car il est uniquement connu sur ce nom 

Voici quelques exemples de description qu'on a fait à l'exercice :

""""
Q8) Gestion des Abonnés dans une bibliothèque X 
On veut automatiser le fonctionnement d'une bibliothèque. La bibliothèque est 
organisée de la façon suivante : 
Un service s'occupe de l'achat des exemplaires d'ouvrage soit pour renouvellement 
d'exemplaires usagés, soit pour acquisition de nouveaux exemplaires ; dans ce dernier 
cas, ce service enregistre les références communes à plusieurs exemplaires, soit 
l'auteur, le titre, la valeur de remplacement, le résumé ainsi que quelques mots clés. 
Les exemplaires sont repérés par un code barre (n° séquentiel unique) collé au dos de 
l'exemplaire). Tout exemplaire correspond à un ouvrage de référence. On veut 
mémoriser la date d'acquisition de l'exemplaire et sa durée de vie estimée. 
Un service s'occupe de l'inscription des emprunteurs. Les emprunteurs sont identifiés 
par une carte comprenant un code barre (n° séquentiel unique). Pour chaque 
emprunteur on mémorise son nom, prénom, adresse, email. 
Un service s'occupe de l'enregistrement des prêts d'exemplaires. Les prêts sont 
mémorisés afin de savoir à tout moment, quels sont les exemplaires sortis. Pour chaque 
prêt ou emprunt on mémorise donc le code exemplaire, le code emprunteur et la date 
de retour au plus tard de cet exemplaire. Cette date est calculée automatiquement par 
date d'emprunt + 3 semaines. 
Un emprunteur peut emprunter au maximum 3 exemplaires. 
Un service s'occupe du retour des exemplaires et de leur placement en rayons. 
Lorsque l'exemplaire est retourné en bon état, on supprime l'enregistrement de cet 
emprunt. 
Lorsque la date de retour échoit, on relance l'emprunteur par email de préférence, par 
courrier si l'adresse email est inconnue. Lorsque l'exemplaire retourné est réputé perdu, 
on envoie un courrier à l'emprunteur exigeant le paiement de la valeur de 
remplacement. 
L'emprunteur entre librement dans la bibliothèque, circule dans les rayons, consulte le 
catalogue des exemplaires s'il le souhaite. Il prend les exemplaires d'ouvrage 
disponibles puis passe au service d'enregistrement des prêts. Le service achats est en 
relation commerciale avec l'éditeur. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

Question 11) ETUDE DE CAS : Gestion des enfants désœuvrés dans un centre 
d’hébergement 
L’étude d’un système de gestion des enfants désœuvrés dans un centre 
d’hébergement a donné les résultats suivants : les informations manipulées sont 
reprises dans un dictionnaire de données présenté ci-dessous : 
Nom enfant, postnom enfant, prénom enfant, sexe enfant, âge enfant, numéro site, 
libellé commune, référence enfant, référence commune, libellé site, nombre 
d’enfants du site, matricule encadreur, nom encadreur, postnom encadreur, sexe 
encadreur, état civil encadreur, niveau d’étude, fonction, référence cotation, libellé 
cotation, cote, activité, numéro chambre, désignation pavillon, désignation activité. 
Le fonctionnement de ce système se résume à travers de la description suivante : 
Les enfants sont logés dans les chambres ; les enfants sont affectés dans un site se 
trouvant dans une commune. Les enfants sont encadrés par les encadreurs selon 
les activités. Un encadreur réalise plusieurs activités. Une activité donne lieu à une 
ou plusieurs cotations pour un ou plusieurs enfants à savoir plusieurs enfants sont 
concernés par plusieurs activités. 
De l’affiliation : un acteur social sollicite l’hébergement d’un enfant à travers d’un 
document appelé demande d’hébergement qu’il adresse à la réception. Celui-ci 
après son enregistrement, la transmet au Conseiller Social qui analyse la demande. 
Deux solutions sont envisageables : en cas de refus, la note de refus et la demande 
sont renvoyés auprès de l’acteur social. Par contre, l’ordre d’acception est transmis 
au Comité de prise en charge des enfants deseouvrés qui obligatoirement établit 
l’ordre d’hébergement et l’autre copie à l’acteur social. Ce service établit chaque 
fois un rapport adressé au Comité de prise en charge des enfants. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

"""""



NB : réalise juste un texte description, un énoncé, je ne demande pas d'organiser ou de classer les choses 
Voilà pourquoi je t'ai montré les exemples des exercices qu'on avait effectué 

On parle juste du système actuel, on ne conçoit pas de logiciel 

Je veux que tu utilises informations inventés car je ne t'ai pas fourni tous les détails 
Faut vraiment parler de tout

Les détails sur les noms propres ne sont pas nécessaires, on peut utiliser M. Dibaphar car on l'appelle souvent PAPA DIBAPHAR car il est uniquement connu sur ce nom 

Voici quelques exemples de description qu'on a fait à l'exercice :

""""
Q8) Gestion des Abonnés dans une bibliothèque X 
On veut automatiser le fonctionnement d'une bibliothèque. La bibliothèque est 
organisée de la façon suivante : 
Un service s'occupe de l'achat des exemplaires d'ouvrage soit pour renouvellement 
d'exemplaires usagés, soit pour acquisition de nouveaux exemplaires ; dans ce dernier 
cas, ce service enregistre les références communes à plusieurs exemplaires, soit 
l'auteur, le titre, la valeur de remplacement, le résumé ainsi que quelques mots clés. 
Les exemplaires sont repérés par un code barre (n° séquentiel unique) collé au dos de 
l'exemplaire). Tout exemplaire correspond à un ouvrage de référence. On veut 
mémoriser la date d'acquisition de l'exemplaire et sa durée de vie estimée. 
Un service s'occupe de l'inscription des emprunteurs. Les emprunteurs sont identifiés 
par une carte comprenant un code barre (n° séquentiel unique). Pour chaque 
emprunteur on mémorise son nom, prénom, adresse, email. 
Un service s'occupe de l'enregistrement des prêts d'exemplaires. Les prêts sont 
mémorisés afin de savoir à tout moment, quels sont les exemplaires sortis. Pour chaque 
prêt ou emprunt on mémorise donc le code exemplaire, le code emprunteur et la date 
de retour au plus tard de cet exemplaire. Cette date est calculée automatiquement par 
date d'emprunt + 3 semaines. 
Un emprunteur peut emprunter au maximum 3 exemplaires. 
Un service s'occupe du retour des exemplaires et de leur placement en rayons. 
Lorsque l'exemplaire est retourné en bon état, on supprime l'enregistrement de cet 
emprunt. 
Lorsque la date de retour échoit, on relance l'emprunteur par email de préférence, par 
courrier si l'adresse email est inconnue. Lorsque l'exemplaire retourné est réputé perdu, 
on envoie un courrier à l'emprunteur exigeant le paiement de la valeur de 
remplacement. 
L'emprunteur entre librement dans la bibliothèque, circule dans les rayons, consulte le 
catalogue des exemplaires s'il le souhaite. Il prend les exemplaires d'ouvrage 
disponibles puis passe au service d'enregistrement des prêts. Le service achats est en 
relation commerciale avec l'éditeur. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

Question 11) ETUDE DE CAS : Gestion des enfants désœuvrés dans un centre 
d’hébergement 
L’étude d’un système de gestion des enfants désœuvrés dans un centre 
d’hébergement a donné les résultats suivants : les informations manipulées sont 
reprises dans un dictionnaire de données présenté ci-dessous : 
Nom enfant, postnom enfant, prénom enfant, sexe enfant, âge enfant, numéro site, 
libellé commune, référence enfant, référence commune, libellé site, nombre 
d’enfants du site, matricule encadreur, nom encadreur, postnom encadreur, sexe 
encadreur, état civil encadreur, niveau d’étude, fonction, référence cotation, libellé 
cotation, cote, activité, numéro chambre, désignation pavillon, désignation activité. 
Le fonctionnement de ce système se résume à travers de la description suivante : 
Les enfants sont logés dans les chambres ; les enfants sont affectés dans un site se 
trouvant dans une commune. Les enfants sont encadrés par les encadreurs selon 
les activités. Un encadreur réalise plusieurs activités. Une activité donne lieu à une 
ou plusieurs cotations pour un ou plusieurs enfants à savoir plusieurs enfants sont 
concernés par plusieurs activités. 
De l’affiliation : un acteur social sollicite l’hébergement d’un enfant à travers d’un 
document appelé demande d’hébergement qu’il adresse à la réception. Celui-ci 
après son enregistrement, la transmet au Conseiller Social qui analyse la demande. 
Deux solutions sont envisageables : en cas de refus, la note de refus et la demande 
sont renvoyés auprès de l’acteur social. Par contre, l’ordre d’acception est transmis 
au Comité de prise en charge des enfants deseouvrés qui obligatoirement établit 
l’ordre d’hébergement et l’autre copie à l’acteur social. Ce service établit chaque 
fois un rapport adressé au Comité de prise en charge des enfants. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

"""""

Je veux que tu utilises informations inventés car je ne t'ai pas fourni tous les détails 
Faut vraiment parler de tout

NB: n'utilise pas des termes comme acteurs externes/flux/processus, ça c'était juste mes instructions, 

Faut  vraiment parler de tout et en détail pour montrer qu'il y a vraiment eu une analyse approfondie 

Ne te limite pas à ce que je dis, va au-delà car je ne peux pas tout dire, j'ai confiance en toi, fais du bon travail, impression moi, donne-toi à fonds
</prompt>
<div>
  ### Étude de cas : Gestion des stocks dans la pharmacie DIBAPHAR

La pharmacie DIBAPHAR est une petite structure familiale située dans un quartier animé de la ville, gérée entièrement par un seul pharmacien, M. Dibaphar, affectueusement connu sous le nom de Papa Dibaphar par les habitants du coin. En tant que propriétaire unique, il s'occupe de toutes les tâches quotidiennes sans aide extérieure, en utilisant des méthodes manuelles simples comme des cahiers, des registres papier et des étagères pour organiser les produits. La pharmacie fonctionne du lundi au samedi, avec des horaires d'ouverture de 8 heures du matin à 20 heures le soir, et reste fermée les dimanches et jours fériés pour permettre à Papa Dibaphar de se reposer et de gérer ses affaires personnelles. L'objectif principal est la gestion manuelle des stocks de médicaments et de produits de santé, en veillant à ce que les approvisionnements soient suffisants pour répondre aux besoins des clients tout en évitant les pertes dues aux expirations ou aux ruptures.

Les stocks comprennent une variété de produits : des médicaments sur ordonnance comme les antibiotiques, les antidouleurs et les traitements pour les maladies chroniques ; des produits en vente libre tels que les vitamines, les crèmes dermatologiques et les articles de premiers soins ; ainsi que des accessoires comme les bandages, les thermomètres et les produits d'hygiène. Chaque produit est identifié par son nom commercial, son principe actif, sa forme (comprimés, sirops, injections), sa quantité par emballage, sa date d'expiration, son prix d'achat et son prix de vente. Papa Dibaphar note manuellement ces détails dans un grand registre des stocks, où il inscrit également la quantité disponible, mise à jour après chaque transaction. Pour les médicaments contrôlés, comme ceux nécessitant une ordonnance, il conserve une trace des numéros de lot et des provenances pour respecter les réglementations sanitaires.

L'approvisionnement en produits commence lorsque Papa Dibaphar identifie un besoin, par exemple quand un médicament approche de la rupture de stock ou quand une date d'expiration est imminente. Il contacte alors l'un de ses fournisseurs habituels, qui sont des grossistes en produits pharmaceutiques basés en ville ou dans les régions voisines. Ces fournisseurs livrent les commandes directement à la pharmacie, souvent par transport routier ou par coursier. Papa Dibaphar passe la commande par téléphone ou en personne lors de visites occasionnelles aux entrepôts des fournisseurs. Il discute des quantités nécessaires, des prix actuels et des délais de livraison, en tenant compte des promotions ou des rabais pour les achats en volume. Une fois la commande confirmée, le fournisseur prépare les produits et émet une facture papier détaillant les articles, les quantités, les prix unitaires, le total à payer et les dates d'expiration. À la réception de la livraison, Papa Dibaphar vérifie physiquement chaque produit : il compte les quantités, inspecte l'état des emballages pour détecter tout dommage, et compare les dates d'expiration avec celles indiquées sur la facture. Si tout est conforme, il signe la facture comme preuve de réception et procède au paiement, généralement en espèces ou par virement bancaire mobile si le fournisseur l'accepte. Il met ensuite à jour son registre des stocks en ajoutant les nouvelles quantités, et range les produits sur les étagères par catégories pour un accès facile. En cas de discrepancy, comme un produit manquant ou endommagé, il contacte immédiatement le fournisseur pour une correction, qui peut impliquer un remboursement partiel ou une livraison complémentaire. Ce processus d'approvisionnement modifie directement le stock en l'augmentant, et Papa Dibaphar vise à le faire une à deux fois par semaine pour maintenir un équilibre sans surstockage.

Les ventes constituent l'activité principale qui diminue le stock. Un client entre librement dans la pharmacie pendant les heures d'ouverture et s'adresse directement à Papa Dibaphar derrière le comptoir. Si le client a une ordonnance médicale, il la présente ; Papa Dibaphar la lit attentivement pour identifier les médicaments prescrits, vérifie s'ils sont disponibles en stock, et explique au client les instructions d'utilisation, les effets secondaires potentiels et les précautions. Pour les produits sans ordonnance, le client peut demander conseil sur des symptômes comme un mal de tête ou une toux, et Papa Dibaphar recommande des options adaptées en fonction de son expertise. Une fois les produits sélectionnés, Papa Dibaphar les sort des étagères, les place sur le comptoir et calcule manuellement le total en additionnant les prix unitaires, en appliquant éventuellement une petite remise pour les clients fidèles ou pour les achats en gros. Il informe le client du montant dû et accepte le paiement, principalement en espèces, bien qu'il tolère occasionnellement les paiements mobiles pour les habitués. Après le paiement, il remet les produits au client dans un sac, accompanied d'une note manuscrite simple récapitulant les articles vendus, les quantités et le total payé, servant de reçu informel. Enfin, il met à jour son registre des stocks en soustrayant les quantités vendues, et note la transaction dans un cahier des ventes quotidien avec la date, les produits, les quantités, le montant et, si pertinent, le nom du client pour les suivis. Ce processus de vente est clôturé une fois le client parti avec ses achats, et Papa Dibaphar ne revient pas sur la transaction sauf en cas de retour immédiat pour un échange justifié, comme un produit défectueux.

Outre les approvisionnements et les ventes, Papa Dibaphar gère les aspects liés à la conservation et à la surveillance des stocks. Tous les matins avant l'ouverture, il effectue un contrôle visuel rapide des étagères pour repérer les produits proches de l'expiration ; ceux qui expirent dans moins d'un mois sont mis de côté pour une vente prioritaire à prix réduit ou, si inutilisables, jetés selon les normes sanitaires, avec une note dans le registre pour ajuster les quantités. Il maintient également un inventaire mensuel complet, où il compte physiquement tous les produits et compare avec les entrées du registre pour détecter d'éventuelles erreurs ou pertes. Pour les médicaments réfrigérés, comme certains vaccins ou insulines, il utilise un petit réfrigérateur et vérifie quotidiennement la température pour éviter la détérioration. En cas de vol ou de perte, rare dans cette petite pharmacie, il note l'incident et ajuste le stock en conséquence.

La pharmacie interagit également avec d'autres entités externes pour des raisons réglementaires qui impactent indirectement le stock. Par exemple, les inspecteurs sanitaires du ministère de la Santé visitent occasionnellement pour vérifier la conformité des stocks, des dates d'expiration et des conditions de stockage ; Papa Dibaphar leur fournit accès à ses registres et ajuste ses pratiques si des recommandations sont faites, comme le retrait de lots rappelés par les fabricants. De plus, pour certains médicaments contrôlés, il doit rapporter mensuellement les quantités vendues aux autorités via des formulaires papier, ce qui nécessite de conserver des traces précises des transactions.

Papa Dibaphar garde des informations sur ses fournisseurs réguliers dans un carnet dédié : nom de la société, adresse, numéro de téléphone, contact principal, historique des commandes passées et des paiements. Pour les clients, bien qu'il ne tienne pas de base de données formelle, il note les détails des habitués dans un cahier séparé, comme leur nom, leurs achats fréquents et toute allergie connue, pour personnaliser les conseils. Tous ces enregistrements sont manuels et stockés dans un bureau sécurisé à l'arrière de la pharmacie.

En résumé, la gestion des stocks chez DIBAPHAR repose sur la diligence de Papa Dibaphar, qui équilibre manuellement les entrées et sorties pour assurer la disponibilité des produits essentiels tout en minimisant les pertes.

Travail à faire : Construire les MCC, MCT, MOT, MCD, MOD, MLD et MPD de l’énoncé ci-dessus.
</div>


<prompt>
  Crée un énoncé pour le cas de gestion de stocks de la pharmacie DIBAPHAR qui est géré par un seul pharmacien qui s'occupe de tout, car c'est une petite pharmacie à lui , il gère tout manuellement

Les données ou contenues de cet énoncé nous permettra de connaître cette pharmacie afin de pouvoir réaliser son MCC, MCT, MOT(MOpt), MCD, MOD, MLD et MLD 

Faut tenir compte des différentes modèles 
Par exemple pour les MCC le plus important c'est les acteurs externes qui font des flux (transmission - réception) direct avec l'interne. Pour le MOT faut juste indiquer l'heure globale d'activité (ouverture -fermeture) car c'est la première règle d'organisation, le MCD les entités à enregistrer, ... 
Tout ceci je ne t'apprends pas, écrit juste l'énoncé proprement comme il faut , comme un texte, tu verras dans les exemples de description que je vais te fournir 

Et faut bien décrire :
Par exemple si tu parles de ventes , tu ne vas pas directement commencer par le paiement du client, faut bien décrire chaque étapes de vente dans toutes ses détails (début - clôture) , une fois clôturé faut plus remettre ce sujet à discussion, par exemple tu parles encore du client alors que t'as déjà parler de tous sur la vente 
N'oublie pas les acteurs qui nous intéresse ici ce sont ceux qui sont indispensables dans la modification du stock, et qui sont en flux de communication direct (transmission-reception) avec la pharmacie 
Crée un énoncé pour le cas de gestion de stocks de la pharmacie DIBAPHAR qui est géré par un seul pharmacien qui s'occupe de tout, car c'est une petite pharmacie à lui , il gère tout manuellement

Les données ou contenues de cet énoncé nous permettra de connaître cette pharmacie afin de pouvoir réaliser son MCC, MCT, MOT(MOpt), MCD, MOD, MLD et MLD 

Faut tenir compte des différentes modèles 
Par exemple pour les MCC le plus important c'est les acteurs externes qui font des flux (transmission - réception) direct avec l'interne. Pour le MOT faut juste indiquer l'heure globale d'activité (ouverture -fermeture) car c'est la première règle d'organisation, le MCD les entités à enregistrer, ... Et aussi sur comment il enregistre ses produits, ses ventes, entrées, sorties,..etc
Tout ceci je ne t'apprends pas, écrit juste l'énoncé proprement comme il faut , comme un texte, tu verras dans les exemples de description que je vais te fournir 

Et faut bien décrire :
Par exemple si tu parles de ventes , tu ne vas pas directement commencer par le paiement du client, faut bien décrire chaque étapes de vente dans toutes ses détails (début - clôture) , une fois clôturé faut plus remettre ce sujet à discussion, par exemple tu parles encore du client alors que t'as déjà parler de tous sur la vente 
N'oublie pas les acteurs qui nous intéresse ici ce sont ceux qui sont indispensables dans la modification du stock, et qui sont en flux de communication direct (transmission-reception) avec la pharmacie 

Les détails sur les noms propres ne sont pas nécessaires

Le pharmacien est connu sous le nom de PAPA DIBAPHAR, 
Mais ici on va utiliser M. Dibaphar 

Voici quelques exemples de description qu'on a fait à l'exercice :

""""
Q8) Gestion des Abonnés dans une bibliothèque X 
On veut automatiser le fonctionnement d'une bibliothèque. La bibliothèque est 
organisée de la façon suivante : 
Un service s'occupe de l'achat des exemplaires d'ouvrage soit pour renouvellement 
d'exemplaires usagés, soit pour acquisition de nouveaux exemplaires ; dans ce dernier 
cas, ce service enregistre les références communes à plusieurs exemplaires, soit 
l'auteur, le titre, la valeur de remplacement, le résumé ainsi que quelques mots clés. 
Les exemplaires sont repérés par un code barre (n° séquentiel unique) collé au dos de 
l'exemplaire). Tout exemplaire correspond à un ouvrage de référence. On veut 
mémoriser la date d'acquisition de l'exemplaire et sa durée de vie estimée. 
Un service s'occupe de l'inscription des emprunteurs. Les emprunteurs sont identifiés 
par une carte comprenant un code barre (n° séquentiel unique). Pour chaque 
emprunteur on mémorise son nom, prénom, adresse, email. 
Un service s'occupe de l'enregistrement des prêts d'exemplaires. Les prêts sont 
mémorisés afin de savoir à tout moment, quels sont les exemplaires sortis. Pour chaque 
prêt ou emprunt on mémorise donc le code exemplaire, le code emprunteur et la date 
de retour au plus tard de cet exemplaire. Cette date est calculée automatiquement par 
date d'emprunt + 3 semaines. 
Un emprunteur peut emprunter au maximum 3 exemplaires. 
Un service s'occupe du retour des exemplaires et de leur placement en rayons. 
Lorsque l'exemplaire est retourné en bon état, on supprime l'enregistrement de cet 
emprunt. 
Lorsque la date de retour échoit, on relance l'emprunteur par email de préférence, par 
courrier si l'adresse email est inconnue. Lorsque l'exemplaire retourné est réputé perdu, 
on envoie un courrier à l'emprunteur exigeant le paiement de la valeur de 
remplacement. 
L'emprunteur entre librement dans la bibliothèque, circule dans les rayons, consulte le 
catalogue des exemplaires s'il le souhaite. Il prend les exemplaires d'ouvrage 
disponibles puis passe au service d'enregistrement des prêts. Le service achats est en 
relation commerciale avec l'éditeur. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

Question 11) ETUDE DE CAS : Gestion des enfants désœuvrés dans un centre 
d’hébergement 
L’étude d’un système de gestion des enfants désœuvrés dans un centre 
d’hébergement a donné les résultats suivants : les informations manipulées sont 
reprises dans un dictionnaire de données présenté ci-dessous : 
Nom enfant, postnom enfant, prénom enfant, sexe enfant, âge enfant, numéro site, 
libellé commune, référence enfant, référence commune, libellé site, nombre 
d’enfants du site, matricule encadreur, nom encadreur, postnom encadreur, sexe 
encadreur, état civil encadreur, niveau d’étude, fonction, référence cotation, libellé 
cotation, cote, activité, numéro chambre, désignation pavillon, désignation activité. 
Le fonctionnement de ce système se résume à travers de la description suivante : 
Les enfants sont logés dans les chambres ; les enfants sont affectés dans un site se 
trouvant dans une commune. Les enfants sont encadrés par les encadreurs selon 
les activités. Un encadreur réalise plusieurs activités. Une activité donne lieu à une 
ou plusieurs cotations pour un ou plusieurs enfants à savoir plusieurs enfants sont 
concernés par plusieurs activités. 
De l’affiliation : un acteur social sollicite l’hébergement d’un enfant à travers d’un 
document appelé demande d’hébergement qu’il adresse à la réception. Celui-ci 
après son enregistrement, la transmet au Conseiller Social qui analyse la demande. 
Deux solutions sont envisageables : en cas de refus, la note de refus et la demande 
sont renvoyés auprès de l’acteur social. Par contre, l’ordre d’acception est transmis 
au Comité de prise en charge des enfants deseouvrés qui obligatoirement établit 
l’ordre d’hébergement et l’autre copie à l’acteur social. Ce service établit chaque 
fois un rapport adressé au Comité de prise en charge des enfants. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

"""""



NB : réalise juste un texte description, un énoncé, je ne demande pas d'organiser ou de classer les choses 
Voilà pourquoi je t'ai montré les exemples des exercices qu'on avait effectué 

On parle juste du système actuel, on ne conçoit pas de logiciel 

Je veux que tu utilises informations inventés car je ne t'ai pas fourni tous les détails 
Faut vraiment parler de tout

Les détails sur les noms propres ne sont pas nécessaires, on peut utiliser M. Dibaphar car on l'appelle souvent PAPA DIBAPHAR car il est uniquement connu sur ce nom 

Voici quelques exemples de description qu'on a fait à l'exercice :

""""
Q8) Gestion des Abonnés dans une bibliothèque X 
On veut automatiser le fonctionnement d'une bibliothèque. La bibliothèque est 
organisée de la façon suivante : 
Un service s'occupe de l'achat des exemplaires d'ouvrage soit pour renouvellement 
d'exemplaires usagés, soit pour acquisition de nouveaux exemplaires ; dans ce dernier 
cas, ce service enregistre les références communes à plusieurs exemplaires, soit 
l'auteur, le titre, la valeur de remplacement, le résumé ainsi que quelques mots clés. 
Les exemplaires sont repérés par un code barre (n° séquentiel unique) collé au dos de 
l'exemplaire). Tout exemplaire correspond à un ouvrage de référence. On veut 
mémoriser la date d'acquisition de l'exemplaire et sa durée de vie estimée. 
Un service s'occupe de l'inscription des emprunteurs. Les emprunteurs sont identifiés 
par une carte comprenant un code barre (n° séquentiel unique). Pour chaque 
emprunteur on mémorise son nom, prénom, adresse, email. 
Un service s'occupe de l'enregistrement des prêts d'exemplaires. Les prêts sont 
mémorisés afin de savoir à tout moment, quels sont les exemplaires sortis. Pour chaque 
prêt ou emprunt on mémorise donc le code exemplaire, le code emprunteur et la date 
de retour au plus tard de cet exemplaire. Cette date est calculée automatiquement par 
date d'emprunt + 3 semaines. 
Un emprunteur peut emprunter au maximum 3 exemplaires. 
Un service s'occupe du retour des exemplaires et de leur placement en rayons. 
Lorsque l'exemplaire est retourné en bon état, on supprime l'enregistrement de cet 
emprunt. 
Lorsque la date de retour échoit, on relance l'emprunteur par email de préférence, par 
courrier si l'adresse email est inconnue. Lorsque l'exemplaire retourné est réputé perdu, 
on envoie un courrier à l'emprunteur exigeant le paiement de la valeur de 
remplacement. 
L'emprunteur entre librement dans la bibliothèque, circule dans les rayons, consulte le 
catalogue des exemplaires s'il le souhaite. Il prend les exemplaires d'ouvrage 
disponibles puis passe au service d'enregistrement des prêts. Le service achats est en 
relation commerciale avec l'éditeur. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

Question 11) ETUDE DE CAS : Gestion des enfants désœuvrés dans un centre 
d’hébergement 
L’étude d’un système de gestion des enfants désœuvrés dans un centre 
d’hébergement a donné les résultats suivants : les informations manipulées sont 
reprises dans un dictionnaire de données présenté ci-dessous : 
Nom enfant, postnom enfant, prénom enfant, sexe enfant, âge enfant, numéro site, 
libellé commune, référence enfant, référence commune, libellé site, nombre 
d’enfants du site, matricule encadreur, nom encadreur, postnom encadreur, sexe 
encadreur, état civil encadreur, niveau d’étude, fonction, référence cotation, libellé 
cotation, cote, activité, numéro chambre, désignation pavillon, désignation activité. 
Le fonctionnement de ce système se résume à travers de la description suivante : 
Les enfants sont logés dans les chambres ; les enfants sont affectés dans un site se 
trouvant dans une commune. Les enfants sont encadrés par les encadreurs selon 
les activités. Un encadreur réalise plusieurs activités. Une activité donne lieu à une 
ou plusieurs cotations pour un ou plusieurs enfants à savoir plusieurs enfants sont 
concernés par plusieurs activités. 
De l’affiliation : un acteur social sollicite l’hébergement d’un enfant à travers d’un 
document appelé demande d’hébergement qu’il adresse à la réception. Celui-ci 
après son enregistrement, la transmet au Conseiller Social qui analyse la demande. 
Deux solutions sont envisageables : en cas de refus, la note de refus et la demande 
sont renvoyés auprès de l’acteur social. Par contre, l’ordre d’acception est transmis 
au Comité de prise en charge des enfants deseouvrés qui obligatoirement établit 
l’ordre d’hébergement et l’autre copie à l’acteur social. Ce service établit chaque 
fois un rapport adressé au Comité de prise en charge des enfants. 
Travail à faire : Construire les MCC, MCD, MCT, MOT, MOD, MLD et MPD de l’énoncé ci-dessus. 

"""""

Je veux que tu utilises informations inventés car je ne t'ai pas fourni tous les détails 
Faut vraiment parler de tout

NB: n'utilise pas des termes comme acteurs externes/flux/processus/entités dans , ça c'était juste les instructions que je donnais, l'énoncé

Faut  vraiment parler de tout et en détail pour montrer qu'il y a vraiment eu une analyse approfondie 

Ne te limite pas à ce que je dis, va au-delà car je ne peux pas tout dire, j'ai confiance en toi, fais du bon travail, impression moi, donne-toi à fonds
</prompt>
<div>
  ### Étude de Cas : Gestion des Stocks dans la Pharmacie DIBAPHAR

La pharmacie DIBAPHAR est une petite structure familiale gérée exclusivement par M. Dibaphar, un pharmacien expérimenté qui s'occupe de l'ensemble des opérations quotidiennes de manière manuelle, sans recours à des systèmes informatisés. Située dans un quartier résidentiel animé, elle propose une gamme variée de médicaments, de produits parapharmaceutiques et d'articles de soins de santé essentiels, comme des antidouleurs, des antibiotiques, des vitamines, des crèmes dermatologiques et des accessoires médicaux tels que des thermomètres ou des bandages. M. Dibaphar, souvent appelé affectueusement "PAPA DIBAPHAR" par les habitués, gère seul les achats, les ventes, le contrôle des stocks, les interactions avec les clients et les fournisseurs, ainsi que les tâches administratives basiques. La pharmacie opère du lundi au samedi de 8 heures du matin à 20 heures du soir, avec une pause déjeuner de 13 heures à 14 heures, et reste fermée les dimanches et jours fériés, sauf en cas d'urgence où M. Dibaphar peut ouvrir exceptionnellement sur appel téléphonique.

Les stocks sont maintenus dans un espace de rangement sécurisé à l'arrière de la pharmacie, organisé en étagères étiquetées par catégories de produits : médicaments sur ordonnance, produits en vente libre, articles périssables nécessitant une réfrigération (comme certains vaccins ou insulines), et produits non périssables. Chaque produit est identifié par un code simple que M. Dibaphar attribue manuellement, composé d'une lettre pour la catégorie (par exemple, "A" pour antidouleurs) suivie d'un numéro séquentiel (comme A001 pour le paracétamol). Pour chaque produit, il note dans un registre dédié les informations essentielles : le nom générique et commercial, le fournisseur d'origine, la date d'achat, la date d'expiration, le prix d'achat unitaire, le prix de vente unitaire, la quantité initiale reçue, et des remarques sur les conditions de stockage (comme "conserver au frais" ou "protéger de la lumière"). Ces registres sont des cahiers à pages numérotées, conservés dans un tiroir verrouillé pour éviter les erreurs ou les pertes.

Le processus d'achat commence lorsque M. Dibaphar identifie un besoin de réapprovisionnement, généralement en consultant son registre de stocks le soir après la fermeture ou le matin avant l'ouverture. Il vérifie les niveaux de stock en comptant physiquement les unités restantes sur les étagères et compare avec les entrées notées. Si un produit approche de la rupture (par exemple, moins de 10 unités pour les articles populaires), il passe une commande verbale ou écrite auprès d'un fournisseur, qui est typiquement un grossiste pharmaceutique local ou un représentant de laboratoire. La commande inclut le nom du produit, la quantité désirée (souvent en boîtes ou en lots de 50 à 100 unités), et une demande de facture. Le fournisseur livre les produits directement à la pharmacie, généralement dans les 48 heures, accompagnés d'une facture détaillant le nom du produit, la quantité livrée, le prix unitaire, le montant total, et la date de livraison. M. Dibaphar inspecte la livraison pour vérifier la conformité (quantité, état, dates d'expiration), signe la facture comme accusé de réception, et paie comptant ou par chèque sur place. Il enregistre ensuite l'entrée dans son registre de stocks en ajoutant la quantité reçue à la ligne correspondante du produit, notant la date de l'entrée, le numéro de la facture, et met à jour le stock total. Si un produit est endommagé ou non conforme, il le retourne immédiatement au fournisseur, qui émet un avoir, et M. Dibaphar note cette sortie comme une correction dans le registre sans impact sur les ventes.

Les ventes constituent le cœur de l'activité et modifient directement les stocks. Un client entre librement dans la pharmacie pendant les heures d'ouverture, parcourt les étagères des produits en vente libre ou demande conseil à M. Dibaphar pour des médicaments sur ordonnance. Pour une vente typique, le client présente une ordonnance médicale si nécessaire (émise par un médecin, avec des détails comme le nom du patient, le nom du médicament, la posologie et la durée du traitement), ou décrit simplement ses symptômes pour des produits en libre-service. M. Dibaphar écoute les besoins, vérifie la disponibilité en consultant rapidement son registre ou en regardant les étagères, et conseille sur l'utilisation appropriée, les contre-indications et les alternatives si le produit exact n'est pas en stock. Il sélectionne ensuite les articles demandés, les place sur le comptoir, et calcule le montant total en multipliant la quantité par le prix de vente unitaire, en ajoutant éventuellement une petite marge pour les services de conseil. Le client paie en espèces, par carte bancaire via un terminal portable, ou exceptionnellement par chèque pour les clients réguliers. M. Dibaphar délivre un reçu manuel écrit à la main sur un bloc-notes carbone, indiquant la date, les produits vendus, les quantités, les prix unitaires, le total payé, et son tampon de pharmacie. Une fois le paiement effectué et le reçu remis, la vente est clôturée : le client quitte la pharmacie avec les produits emballés. Immédiatement après, M. Dibaphar met à jour son registre de stocks en soustrayant la quantité vendue de la ligne du produit concerné, notant la date de sortie, une référence au reçu (comme un numéro séquentiel), et le nom approximatif du client pour les ordonnances (sans détails personnels exhaustifs pour respecter la confidentialité). Pour les produits sur ordonnance, il conserve une copie de l'ordonnance dans un dossier séparé pour des fins de traçabilité réglementaire.

Les sorties de stock ne se limitent pas aux ventes ; M. Dibaphar gère également les pertes dues à l'expiration ou aux dommages. Tous les mois, il effectue un inventaire manuel en comptant physiquement tous les produits et en comparant avec le registre. Si un produit est expiré (par exemple, un lot d'antibiotiques dont la date d'expiration est dépassée), il le retire des étagères, le place dans une zone de déchets médicaux sécurisée, et note la sortie dans le registre comme une perte, avec la quantité, la date et la raison. Ces déchets sont ensuite collectés par un service spécialisé de ramassage des déchets pharmaceutiques, qui fournit un certificat de destruction que M. Dibaphar archive. De même, pour les retours de clients (rares, mais possibles pour des produits non ouverts en cas d'erreur), il inspecte l'article, rembourse si approprié, et réintègre la quantité au stock en notant l'entrée de retour dans le registre.

Les interactions avec les fournisseurs ne se limitent pas aux achats ; ils fournissent occasionnellement des informations sur de nouveaux produits ou des rappels de lots défectueux via des courriers ou des visites. Dans ce cas, M. Dibaphar retire immédiatement les lots concernés du stock, les retourne au fournisseur pour un remboursement, et note la sortie comme un rappel dans le registre. Pour les clients, bien que la plupart des interactions soient directes et anonymes, les habitués peuvent passer des commandes par téléphone pour des produits spécifiques, que M. Dibaphar prépare à l'avance et met de côté, mais la vente n'est finalisée qu'à l'arrivée du client avec paiement et mise à jour du stock.

Enfin, M. Dibaphar maintient un registre séparé pour les rapports mensuels, où il compile les totaux d'entrées (achats), de sorties (ventes, pertes, retours), et les stocks finaux pour évaluer la rentabilité et anticiper les besoins futurs. Ce registre inclut des calculs manuels simples, comme le chiffre d'affaires par produit ou les marges bénéficiaires, basés sur les prix d'achat et de vente. Toute la documentation est archivée chronologiquement dans des classeurs pour d'éventuels contrôles par les autorités sanitaires, qui visitent périodiquement la pharmacie pour vérifier la conformité des stocks et des enregistrements.

Travail à faire : Construire les MCC, MCT, MOT (MOpt), MCD, MOD, MLD et MPD de l’énoncé ci-dessus.
</div>


<div>
  ### Étude de Cas : Gestion des Stocks dans la Pharmacie DIBAPHAR

La pharmacie DIBAPHAR est une petite structure familiale située en milieu urbain, gérée exclusivement par M. Dibaphar, un pharmacien qualifié qui s'occupe de l'ensemble des opérations quotidiennes. Étant le seul responsable, il gère tout de manière manuelle, sans recours à des systèmes informatisés, en s'appuyant sur des cahiers, des registres et des documents papier pour suivre les activités. L'objectif principal de cette pharmacie est de fournir des médicaments et des produits de santé essentiels à la population locale, en veillant à une gestion rigoureuse des stocks pour éviter les ruptures ou les pertes dues à l'expiration. La pharmacie opère du lundi au samedi, de 8 heures du matin à 18 heures, et reste fermée les dimanches et jours fériés, ce qui constitue la règle de base pour l'organisation des activités quotidiennes. M. Dibaphar ouvre personnellement la pharmacie chaque matin et la ferme le soir, en s'assurant que tous les enregistrements sont à jour avant la fermeture.

Les informations manipulées dans cette pharmacie sont consignées manuellement et incluent, pour chaque produit : le nom du médicament ou du produit (par exemple, paracétamol, antibiotiques, vitamines ou articles de parapharmacie comme des crèmes ou des bandages), un code interne simple (un numéro séquentiel attribué par M. Dibaphar, comme P001 pour un lot de paracétamol), la quantité en stock, le prix d'achat unitaire auprès du fournisseur, le prix de vente unitaire, la date d'achat, la date d'expiration, le nom du fournisseur, et des notes sur la catégorie (par exemple, sur ordonnance ou en vente libre). Pour les ventes, on enregistre la date de la vente, la quantité vendue, le montant total payé, et parfois le nom du client si c'est un habitué ou pour des produits contrôlés. Les fournisseurs sont identifiés par leur nom, leur adresse, leur numéro de téléphone, et les détails des commandes passées, y compris les factures et les bons de livraison. Les clients ne sont pas systématiquement enregistrés, sauf pour les ventes de médicaments sur ordonnance où l'on note le nom du patient, le nom du médecin prescripteur, et une copie de l'ordonnance est conservée. D'autres données incluent les totaux journaliers des ventes, les montants en caisse, et des rapports mensuels sur les stocks pour détecter les écarts.

Le fonctionnement de la pharmacie repose sur plusieurs processus clés, tous gérés par M. Dibaphar. Pour l'approvisionnement en produits, qui est essentiel pour maintenir le stock, M. Dibaphar contacte régulièrement ses fournisseurs, qui sont des grossistes en produits pharmaceutiques situés en ville ou dans des régions voisines. Il passe une commande par téléphone ou par visite directe, en listant les produits nécessaires basés sur ses observations du stock actuel et des besoins anticipés (par exemple, en tenant compte des saisons pour les médicaments contre la grippe). Une fois la commande confirmée, le fournisseur livre les produits à la pharmacie, accompagnés d'un bon de livraison et d'une facture détaillant les quantités, les prix unitaires, les dates d'expiration, et les numéros de lots. M. Dibaphar vérifie physiquement la livraison pour s'assurer de la conformité (quantité, qualité, et absence de dommages), signe le bon de livraison, et paie le fournisseur soit en espèces, soit par virement bancaire si le montant est élevé. Il enregistre ensuite l'entrée dans un registre dédié aux stocks : il note la date d'entrée, le code du produit, la quantité ajoutée, le prix d'achat, et met à jour le solde total en additionnant manuellement à la quantité précédente. Si un produit est proche de l'expiration, il le place dans une section séparée pour une vente prioritaire ou un retour au fournisseur si possible. Les fournisseurs envoient parfois des rappels pour des paiements en retard ou des promotions, et M. Dibaphar répond par téléphone ou en personne pour maintenir de bonnes relations commerciales.

Pour les ventes, qui constituent la principale sortie de stock, le processus commence lorsqu'un client entre dans la pharmacie pendant les heures d'ouverture. Le client peut parcourir les étagères librement pour les produits en vente libre, ou présenter une ordonnance pour des médicaments contrôlés. M. Dibaphar accueille le client, écoute sa demande (par exemple, un médicament pour un mal de tête ou une consultation rapide sur un symptôme), et vérifie si le produit est disponible en consultant son registre de stocks ou en regardant directement les étagères. Si c'est une vente sur ordonnance, il examine l'ordonnance pour confirmer sa validité (date, signature du médecin, et absence de contrefaçon), conseille le client sur l'utilisation et les précautions, et sélectionne le produit approprié. Pour tous les types de ventes, il retire la quantité demandée du stock physique, calcule le prix total en multipliant la quantité par le prix unitaire (en ajoutant éventuellement une petite marge pour les conseils), et informe le client du montant. Le client paie ensuite en espèces, ou parfois via un service de paiement mobile si disponible, et M. Dibaphar délivre un reçu manuscrit simple indiquant la date, les produits vendus, et le montant. Une fois le paiement effectué et le produit remis au client, la vente est clôturée : M. Dibaphar enregistre immédiatement la sortie dans son registre des ventes (date, produit, quantité, prix, et solde restant en stock après soustraction manuelle), et range le reçu dans une boîte pour les comptes journaliers. Il n'y a pas de retours systématiques après la vente, sauf en cas d'erreur évidente détectée sur place, et les clients ne reviennent pas pour des ajustements une fois partis.

En plus des entrées et sorties principales, M. Dibaphar effectue des inventaires manuels périodiques pour contrôler le stock. Tous les fins de mois, il compte physiquement tous les produits sur les étagères, compare avec les enregistrements dans le registre, et note les écarts (pertes, vols potentiels, ou erreurs de comptage). Pour les produits périmés, il les retire du stock, les enregistre comme pertes dans un cahier dédié, et les détruit ou les renvoie au fournisseur si une politique de retour existe, en obtenant un avoir pour une prochaine commande. Il suit également les ventes journalières en totalisant les recettes en fin de journée, en les comparant aux enregistrements, et en déposant l'argent à la banque le lendemain. Occasionnellement, des représentants des autorités sanitaires visitent la pharmacie pour des inspections : ils vérifient les conditions de stockage (température, hygiène), les dates d'expiration, et la conformité des enregistrements, et M. Dibaphar leur fournit les registres et les documents nécessaires. Si une anomalie est détectée, il reçoit un rapport écrit et doit corriger la situation, ce qui peut impliquer une mise à jour des stocks ou un retrait de produits. Les clients peuvent parfois signaler des problèmes post-vente (comme un produit défectueux), et M. Dibaphar les gère en échangeant le produit si possible, en mettant à jour le stock en conséquence.

La pharmacie interagit aussi avec d'autres entités pour des aspects secondaires impactant le stock. Par exemple, M. Dibaphar reçoit des alertes de fournisseurs sur des rappels de lots défectueux, ce qui l'amène à retirer immédiatement les produits concernés du stock et à les renvoyer pour remboursement. Il tient un petit registre des clients fidèles pour anticiper leurs besoins récurrents (comme des médicaments chroniques), ce qui aide à ajuster les commandes. Tous ces processus sont consignés dans des cahiers distincts : un pour les stocks généraux (entrées et sorties), un pour les ventes quotidiennes, un pour les comptes fournisseurs, et un pour les inventaires mensuels. M. Dibaphar archive les factures et bons de livraison dans des dossiers classés par mois, pour référence en cas de litige ou d'audit. Cette gestion manuelle, bien que simple, permet à la pharmacie de fonctionner efficacement, en se concentrant sur la fiabilité des stocks pour assurer un service continu à la communauté.

Travail à faire : Construire les MCC, MCT, MOT (MOpt), MCD, MOD, MLD et MPD de l’énoncé ci-dessus.
</div>

<!-- tous les modèles -->
<!-- 7kn3rfajak@zudpck.com -->
<prompt>
  Identifie :
Les entités, leurs propriétés/attributs, identifiant , relations, la cardinalité, les règles de gestion

Réalise :
le graphe de dépendances fonctionnelles et le dictionnaire des données 

Pour le dictionnaire des données voici les éléments , on a :
- Nom de la donnée 
- Format 
- longueur 
- Type ( Élémentaire | Calculée)
- Règle de calcul 
- Règle de gestion 
- Document

Les identifiants des on les identifient dans le dictionnaire avec le symbole * au début.
Nom de la donnée = attributs/propriétés/identifiant d'une entité 


C'est pour un MCD 

Faut toujours tout démontrer, des trucs comme la normalisation, la fusion,... Pour dire pourquoi on a cet aspect et non l'autre, pour s'expliquer sur le Pourquoi on a que 4 entités au lieu de 8, pour dire pourquoi on a ça ou ça au lieu de ça,... 

Dans chaque entité faut toujours mettre ses propriétés complets même si elles ne sont pas tous cités 

Pour :
- chaque entité déclaré tu dois montré l'extrait de la partie de l'énoncé qui permet cela 
- de même pours leurs propriétés, attributs 
- de même pour les relations,
- de même pour la cardinalité 

NB: Concernant les relations faut utiliser des verbes à l'infinitif qui qui s'applique de façon bidirectionnelle ou dans tous les sens utilisant ce même verbe 
Ça garantie la cohérence 

Il faut que ça soit tellement cohérent suivant l'énoncé à tel que nul ni personne pourrait contredire ça 

Tout doit avoir un extrait de l'énoncé mais sachant que ça peut toujours être explicite ou implicite 

Les extraits nous aides à ne peut pas nous permet, il nous permet de nous localiser, d'avoir une meilleure compréhension 

Tu peux réaliser un tableau pour les identifications des entités, propriétés/attributs, relations/cardinalités, règles de gestion, chacun avec une zone extrait de l'énoncé pour comprendre et tu peux ajouter d'autres éléments nécessaires 

N'oublie pas : Dans chaque entité faut toujours mettre ses propriétés complets même si elles sont implicite ou explicite 

Car on a besoin des propriétés, une entité ou une table ne doit pas seulement être créer pour avoir une seule propriété ou  champ

Fait en sorte qu'en lisant le MCD ça nous donne presque les mêmes chemins que quand on avait lu l'énoncé 

Tout ça c'était pour le MCD 
Tu ferras le MOD (celui qui parle de responsabilité pour chaque poste : ajouter , modifier, supprimer, consulter,...etc) et le MLD en se basant sur le MCD qui a été construite

Voici l'énoncé :


  ### Étude de Cas : Gestion des Stocks dans la Pharmacie DIBAPHAR

La pharmacie DIBAPHAR est une petite structure familiale gérée exclusivement par M. Dibaphar, un pharmacien expérimenté qui s'occupe de l'ensemble des opérations quotidiennes de manière manuelle, sans recours à des systèmes informatisés. Située dans un quartier résidentiel animé, elle propose une gamme variée de médicaments, de produits parapharmaceutiques et d'articles de soins de santé essentiels, comme des antidouleurs, des antibiotiques, des vitamines, des crèmes dermatologiques et des accessoires médicaux tels que des thermomètres ou des bandages. M. Dibaphar, souvent appelé affectueusement "PAPA DIBAPHAR" par les habitués, gère seul les achats, les ventes, le contrôle des stocks, les interactions avec les clients et les fournisseurs, ainsi que les tâches administratives basiques. La pharmacie opère du lundi au samedi de 8 heures du matin à 20 heures du soir, avec une pause déjeuner de 13 heures à 14 heures, et reste fermée les dimanches et jours fériés, sauf en cas d'urgence où M. Dibaphar peut ouvrir exceptionnellement sur appel téléphonique.

Les stocks sont maintenus dans un espace de rangement sécurisé à l'arrière de la pharmacie, organisé en étagères étiquetées par catégories de produits : médicaments sur ordonnance, produits en vente libre, articles périssables nécessitant une réfrigération (comme certains vaccins ou insulines), et produits non périssables. Chaque produit est identifié par un code simple que M. Dibaphar attribue manuellement, composé d'une lettre pour la catégorie (par exemple, "A" pour antidouleurs) suivie d'un numéro séquentiel (comme A001 pour le paracétamol). Pour chaque produit, il note dans un registre dédié les informations essentielles : le nom générique et commercial, le fournisseur d'origine, la date d'achat, la date d'expiration, le prix d'achat unitaire, le prix de vente unitaire, la quantité initiale reçue, et des remarques sur les conditions de stockage (comme "conserver au frais" ou "protéger de la lumière"). Ces registres sont des cahiers à pages numérotées, conservés dans un tiroir verrouillé pour éviter les erreurs ou les pertes.

Le processus d'achat commence lorsque M. Dibaphar identifie un besoin de réapprovisionnement, généralement en consultant son registre de stocks le soir après la fermeture ou le matin avant l'ouverture. Il vérifie les niveaux de stock en comptant physiquement les unités restantes sur les étagères et compare avec les entrées notées. Si un produit approche de la rupture (par exemple, moins de 10 unités pour les articles populaires), il passe une commande verbale ou écrite auprès d'un fournisseur, qui est typiquement un grossiste pharmaceutique local ou un représentant de laboratoire. La commande inclut le nom du produit, la quantité désirée (souvent en boîtes ou en lots de 50 à 100 unités), et une demande de facture. Le fournisseur livre les produits directement à la pharmacie, généralement dans les 48 heures, accompagnés d'une facture détaillant le nom du produit, la quantité livrée, le prix unitaire, le montant total, et la date de livraison. M. Dibaphar inspecte la livraison pour vérifier la conformité (quantité, état, dates d'expiration), signe la facture comme accusé de réception, et paie comptant ou par chèque sur place. Il enregistre ensuite l'entrée dans son registre de stocks en ajoutant la quantité reçue à la ligne correspondante du produit, notant la date de l'entrée, le numéro de la facture, et met à jour le stock total. Si un produit est endommagé ou non conforme, il le retourne immédiatement au fournisseur, qui émet un avoir, et M. Dibaphar note cette sortie comme une correction dans le registre sans impact sur les ventes.

Les ventes constituent le cœur de l'activité et modifient directement les stocks. Un client entre librement dans la pharmacie pendant les heures d'ouverture, parcourt les étagères des produits en vente libre ou demande conseil à M. Dibaphar pour des médicaments sur ordonnance. Pour une vente typique, le client présente une ordonnance médicale si nécessaire (émise par un médecin, avec des détails comme le nom du patient, le nom du médicament, la posologie et la durée du traitement), ou décrit simplement ses symptômes pour des produits en libre-service. M. Dibaphar écoute les besoins, vérifie la disponibilité en consultant rapidement son registre ou en regardant les étagères, et conseille sur l'utilisation appropriée, les contre-indications et les alternatives si le produit exact n'est pas en stock. Il sélectionne ensuite les articles demandés, les place sur le comptoir, et calcule le montant total en multipliant la quantité par le prix de vente unitaire, en ajoutant éventuellement une petite marge pour les services de conseil. Le client paie en espèces, par carte bancaire via un terminal portable, ou exceptionnellement par chèque pour les clients réguliers. M. Dibaphar délivre un reçu manuel écrit à la main sur un bloc-notes carbone, indiquant la date, les produits vendus, les quantités, les prix unitaires, le total payé, et son tampon de pharmacie. Une fois le paiement effectué et le reçu remis, la vente est clôturée : le client quitte la pharmacie avec les produits emballés. Immédiatement après, M. Dibaphar met à jour son registre de stocks en soustrayant la quantité vendue de la ligne du produit concerné, notant la date de sortie, une référence au reçu (comme un numéro séquentiel), et le nom approximatif du client pour les ordonnances (sans détails personnels exhaustifs pour respecter la confidentialité). Pour les produits sur ordonnance, il conserve une copie de l'ordonnance dans un dossier séparé pour des fins de traçabilité réglementaire.

Les sorties de stock ne se limitent pas aux ventes ; M. Dibaphar gère également les pertes dues à l'expiration ou aux dommages. Tous les mois, il effectue un inventaire manuel en comptant physiquement tous les produits et en comparant avec le registre. Si un produit est expiré (par exemple, un lot d'antibiotiques dont la date d'expiration est dépassée), il le retire des étagères, le place dans une zone de déchets médicaux sécurisée, et note la sortie dans le registre comme une perte, avec la quantité, la date et la raison. Ces déchets sont ensuite collectés par un service spécialisé de ramassage des déchets pharmaceutiques, qui fournit un certificat de destruction que M. Dibaphar archive. De même, pour les retours de clients (rares, mais possibles pour des produits non ouverts en cas d'erreur), il inspecte l'article, rembourse si approprié, et réintègre la quantité au stock en notant l'entrée de retour dans le registre.

Les interactions avec les fournisseurs ne se limitent pas aux achats ; ils fournissent occasionnellement des informations sur de nouveaux produits ou des rappels de lots défectueux via des courriers ou des visites. Dans ce cas, M. Dibaphar retire immédiatement les lots concernés du stock, les retourne au fournisseur pour un remboursement, et note la sortie comme un rappel dans le registre. Pour les clients, bien que la plupart des interactions soient directes et anonymes, les habitués peuvent passer des commandes par téléphone pour des produits spécifiques, que M. Dibaphar prépare à l'avance et met de côté, mais la vente n'est finalisée qu'à l'arrivée du client avec paiement et mise à jour du stock.

Enfin, M. Dibaphar maintient un registre séparé pour les rapports mensuels, où il compile les totaux d'entrées (achats), de sorties (ventes, pertes, retours), et les stocks finaux pour évaluer la rentabilité et anticiper les besoins futurs. Ce registre inclut des calculs manuels simples, comme le chiffre d'affaires par produit ou les marges bénéficiaires, basés sur les prix d'achat et de vente. Toute la documentation est archivée chronologiquement dans des classeurs pour d'éventuels contrôles par les autorités sanitaires, qui visitent périodiquement la pharmacie pour vérifier la conformité des stocks et des enregistrements.

Travail à faire : Construire les MCC, MCT, MOT (MOpt), MCD, MOD, MLD et MPD de l’énoncé ci-dessus.
</prompt>
<div> 
# Analyse Complète du Système de Gestion de la Pharmacie DIBAPHAR

## 1. IDENTIFICATION DES ENTITÉS, PROPRIÉTÉS, RELATIONS ET RÈGLES DE GESTION

### 1.1 Tableau d'Identification des Entités et Propriétés

| **Entité** | **Justification/Extrait de l'énoncé** | **Propriétés identifiées** | **Extrait pour chaque propriété** |
|------------|---------------------------------------|---------------------------|-----------------------------------|
| **PRODUIT** | "Chaque produit est identifié par un code simple que M. Dibaphar attribue manuellement" / "Pour chaque produit, il note dans un registre dédié les informations essentielles" | *codeProduit<br>nomGenerique<br>nomCommercial<br>categorie<br>prixAchatUnitaire<br>prixVenteUnitaire<br>conditionStockage<br>seuilRapprovisionnement<br>stockActuel | "code simple...composé d'une lettre pour la catégorie suivie d'un numéro séquentiel"<br>"le nom générique et commercial"<br>"le nom générique et commercial"<br>"lettre pour la catégorie (par exemple, 'A' pour antidouleurs)"<br>"le prix d'achat unitaire"<br>"le prix de vente unitaire"<br>"conditions de stockage (comme 'conserver au frais')"<br>"moins de 10 unités pour les articles populaires" (implicite)<br>"quantité...stock total" |
| **FOURNISSEUR** | "il passe une commande verbale ou écrite auprès d'un fournisseur, qui est typiquement un grossiste pharmaceutique local ou un représentant de laboratoire" | *codeFournisseur<br>nomFournisseur<br>typeFournisseur<br>adresse<br>telephone<br>email | "un grossiste pharmaceutique local ou un représentant de laboratoire"<br>"nom du fournisseur" (implicite pour identification)<br>"grossiste pharmaceutique local ou représentant de laboratoire"<br>Propriétés implicites nécessaires pour contacter/identifier<br>Propriétés implicites nécessaires pour contacter/identifier<br>Propriétés implicites nécessaires pour contacter/identifier |
| **LOT_PRODUIT** | "Il enregistre ensuite l'entrée dans son registre de stocks" / "date d'expiration" / "le numéro de la facture" | *numeroLot<br>#codeProduit<br>#numeroCommande<br>quantiteRecue<br>dateReception<br>dateExpiration<br>etatLot | "numéro de la facture" (référence unique)<br>Référence au produit concerné<br>Référence à la commande d'origine<br>"la quantité livrée"<br>"la date de livraison"<br>"la date d'expiration"<br>"endommagé ou non conforme" (actif/expiré/endommagé) |
| **COMMANDE** | "il passe une commande verbale ou écrite auprès d'un fournisseur" / "Le fournisseur livre les produits...accompagnés d'une facture" | *numeroCommande<br>#codeFournisseur<br>dateCommande<br>dateLivraison<br>montantTotal<br>modePaiement<br>statutCommande | "une commande verbale ou écrite"<br>Référence au fournisseur sollicité<br>"passe une commande" (date implicite)<br>"dans les 48 heures...date de livraison"<br>"le montant total"<br>"paie comptant ou par chèque"<br>"livre...inspecte...signe" (statut implicite) |
| **VENTE** | "Les ventes constituent le cœur de l'activité" / "délivre un reçu manuel écrit à la main" | *numeroVente<br>dateVente<br>heureVente<br>montantTotal<br>modePaiement<br>typeVente<br>nomClientApproximatif<br>numeroOrdonnance | "reçu manuel...numéro séquentiel"<br>"indiquant la date"<br>Heure implicite pour traçabilité<br>"le total payé"<br>"paie en espèces, par carte bancaire...ou...par chèque"<br>"sur ordonnance" ou "libre-service" (implicite)<br>"le nom approximatif du client pour les ordonnances"<br>"présente une ordonnance médicale...avec des détails" |
| **MOUVEMENT_STOCK** | "met à jour son registre de stocks" / "soustrayant la quantité vendue" / "note la sortie...comme une perte" | *numeroMouvement<br>#codeProduit<br>#numeroLot<br>typeMouvement<br>quantite<br>dateMouvement<br>motif<br>referenceDocument | Entité technique pour traçabilité complète<br>Référence au produit concerné<br>Référence au lot spécifique<br>"entrée...sortie" (entrée/sortie)<br>"quantité reçue...quantité vendue"<br>"notant la date"<br>"vente, perte, retour, rappel"<br>"référence au reçu...numéro de la facture" |

### 1.2 Analyse de Normalisation et Fusion

**Pourquoi 6 entités principales et non plus ou moins ?**

**Justification de PRODUIT (entité séparée) :**
- **Extrait** : "Chaque produit est identifié par un code simple"
- **Raison** : Les produits ont une existence indépendante avec des propriétés stables (nom, catégorie, prix) qui ne changent pas à chaque mouvement
- **Normalisation** : Évite la redondance en stockant une seule fois les informations produit

**Justification de LOT_PRODUIT (entité distincte de PRODUIT) :**
- **Extrait** : "la date d'expiration" / "quantité livrée" / "inspecte la livraison"
- **Raison** : Un même produit peut avoir plusieurs lots avec des dates d'expiration différentes
- **Cas concret** : Le paracétamol A001 peut avoir un lot reçu en janvier expirant en 2026 et un autre lot reçu en mars expirant en 2027
- **Normalisation** : Permet de gérer les FIFO (First In First Out), les rappels de lots spécifiques et les expirations par lot

**Justification de COMMANDE (entité séparée) :**
- **Extrait** : "passe une commande...incluant le nom du produit, la quantité désirée"
- **Raison** : Une commande peut contenir plusieurs produits différents
- **Normalisation** : Évite de répéter les informations de commande (date, fournisseur, paiement) pour chaque ligne de produit

**Justification de VENTE (entité séparée) :**
- **Extrait** : "délivre un reçu manuel...indiquant la date, les produits vendus, les quantités"
- **Raison** : Une vente peut concerner plusieurs produits à la fois
- **Normalisation** : Groupe les produits vendus ensemble dans une transaction unique

**Justification de MOUVEMENT_STOCK (entité centrale de traçabilité) :**
- **Extrait** : "met à jour son registre de stocks en soustrayant" / "note la sortie dans le registre comme une perte"
- **Raison** : Traçabilité complète de tous les mouvements (achats, ventes, pertes, retours, rappels)
- **Normalisation** : Journal unique de tous les événements affectant le stock

**Pourquoi pas d'entité CLIENT ?**
- **Extrait** : "le nom approximatif du client pour les ordonnances (sans détails personnels exhaustifs pour respecter la confidentialité)"
- **Raison** : Pas de gestion structurée des clients, interactions majoritairement anonymes
- **Décision** : L'attribut "nomClientApproximatif" dans VENTE suffit pour la traçabilité réglementaire

### 1.3 Tableau des Relations et Cardinalités

| **Relation** | **Entités liées** | **Verbe (bidirectionnel)** | **Extrait justificatif** | **Cardinalité** | **Justification cardinalité** |
|--------------|-------------------|---------------------------|--------------------------|----------------|------------------------------|
| **CONCERNER_P** | PRODUIT ↔ LOT_PRODUIT | Concerner | "Chaque produit...quantité reçue" | (1,n) - (1,1) | Un produit peut avoir plusieurs lots (1,n), chaque lot concerne un seul produit (1,1) |
| **FOURNIR** | FOURNISSEUR ↔ COMMANDE | Fournir | "passe une commande...auprès d'un fournisseur" | (1,n) - (1,1) | Un fournisseur peut recevoir plusieurs commandes (1,n), chaque commande provient d'un seul fournisseur (1,1) |
| **COMPOSER_C** | COMMANDE ↔ PRODUIT | Composer | "La commande inclut le nom du produit, la quantité désirée" | (1,n) - (0,n) | Une commande contient plusieurs produits (1,n), un produit peut être dans plusieurs commandes (0,n - car nouveau produit jamais commandé) |
| **GENERER_L** | COMMANDE ↔ LOT_PRODUIT | Générer | "Le fournisseur livre les produits...Il enregistre l'entrée" | (1,n) - (1,1) | Une commande génère plusieurs lots (1,n - un lot par produit commandé), chaque lot provient d'une commande (1,1) |
| **COMPOSER_V** | VENTE ↔ PRODUIT | Composer | "les produits vendus, les quantités" | (1,n) - (0,n) | Une vente contient plusieurs produits (1,n), un produit peut être dans plusieurs ventes (0,n) |
| **IMPACTER** | MOUVEMENT_STOCK ↔ PRODUIT | Impacter | "met à jour son registre de stocks...du produit concerné" | (1,n) - (1,1) | Plusieurs mouvements pour un produit (1,n), chaque mouvement concerne un seul produit (1,1) |
| **PROVENIR_L** | MOUVEMENT_STOCK ↔ LOT_PRODUIT | Provenir | "retire les lots concernés du stock" | (0,n) - (0,1) | Un lot peut avoir plusieurs mouvements (0,n), un mouvement peut concerner un lot spécifique (0,1 - optionnel pour certains mouvements) |
| **ORIGINER_V** | MOUVEMENT_STOCK ↔ VENTE | Originer | "soustrayant la quantité vendue...notant...référence au reçu" | (0,n) - (0,1) | Plusieurs mouvements peuvent être liés à une vente (0,n), un mouvement peut provenir d'une vente (0,1 - optionnel pour achats/pertes) |

**Propriétés des relations (attributs portés) :**

**COMPOSER_C** (Commande-Produit) :
- quantiteCommandee : "la quantité désirée"
- prixAchatUnitaire : "le prix unitaire" (peut varier selon la commande)

**GENERER_L** (Commande-Lot) :
- Pas d'attribut car les informations sont dans LOT_PRODUIT

**COMPOSER_V** (Vente-Produit) :
- quantiteVendue : "les quantités"
- prixVenteUnitaire : "les prix unitaires" (peut varier selon promotions)

### 1.4 Règles de Gestion Identifiées

| **Code RG** | **Règle de Gestion** | **Extrait de l'énoncé** | **Type** |
|-------------|---------------------|-------------------------|----------|
| **RG01** | Chaque produit doit avoir un code unique composé d'une lettre de catégorie et d'un numéro séquentiel | "code simple...composé d'une lettre pour la catégorie suivie d'un numéro séquentiel (comme A001)" | Contrainte d'unicité |
| **RG02** | Un produit avec un stock inférieur au seuil de réapprovisionnement déclenche une commande | "Si un produit approche de la rupture (par exemple, moins de 10 unités), il passe une commande" | Règle métier |
| **RG03** | Un lot dont la date d'expiration est dépassée doit être retiré du stock et noté comme perte | "Si un produit est expiré...il le retire des étagères...note la sortie...comme une perte" | Règle métier |
| **RG04** | Toute sortie de stock (vente, perte, retour, rappel) doit générer un mouvement de stock | "met à jour son registre de stocks en soustrayant la quantité" | Contrainte d'intégrité |
| **RG05** | Toute entrée de stock (réception de commande) doit générer un mouvement de stock et créer un lot | "Il enregistre ensuite l'entrée dans son registre de stocks en ajoutant la quantité reçue" | Contrainte d'intégrité |
| **RG06** | Une vente de produit sur ordonnance doit obligatoirement avoir un numéro d'ordonnance | "Pour les produits sur ordonnance, il conserve une copie de l'ordonnance" | Contrainte réglementaire |
| **RG07** | Une commande doit être livrée dans les 48 heures maximum | "livre les produits...généralement dans les 48 heures" | Règle métier |
| **RG08** | La livraison doit être inspectée pour conformité (quantité, état, dates) avant acceptation | "M. Dibaphar inspecte la livraison pour vérifier la conformité" | Règle métier |
| **RG09** | Un produit endommagé ou non conforme doit être retourné immédiatement au fournisseur | "Si un produit est endommagé ou non conforme, il le retourne immédiatement" | Règle métier |
| **RG10** | Un inventaire mensuel doit être réalisé pour vérifier la cohérence entre stock physique et registre | "Tous les mois, il effectue un inventaire manuel en comptant physiquement tous les produits" | Règle métier |
| **RG11** | Le prix de vente unitaire doit être supérieur au prix d'achat unitaire pour assurer une marge | Implicite dans "évaluer la rentabilité...marges bénéficiaires" | Règle métier |
| **RG12** | Chaque mouvement de stock doit avoir une référence documentaire (facture, reçu, certificat) | "référence au reçu...numéro de la facture...certificat de destruction" | Contrainte réglementaire |

## 2. GRAPHE DES DÉPENDANCES FONCTIONNELLES

### 2.1 Dépendances Fonctionnelles par Entité

**PRODUIT :**
```
codeProduit → nomGenerique, nomCommercial, categorie, prixAchatUnitaire, 
              prixVenteUnitaire, conditionStockage, seuilRapprovisionnement, stockActuel
```
**Justification** : "Chaque produit est identifié par un code simple" → Le code produit détermine toutes les autres propriétés du produit

**LOT_PRODUIT :**
```
numeroLot → codeProduit, numeroCommande, quantiteRecue, dateReception, 
            dateExpiration, etatLot
```
**Justification** : "le numéro de la facture" (servant de numéro de lot) détermine toutes les caractéristiques du lot

**FOURNISSEUR :**
```
codeFournisseur → nomFournisseur, typeFournisseur, adresse, telephone, email
```
**Justification** : Chaque fournisseur a un identifiant unique qui détermine ses coordonnées

**COMMANDE :**
```
numeroCommande → codeFournisseur, dateCommande, dateLivraison, montantTotal, 
                 modePaiement, statutCommande
```
**Justification** : "une commande...accompagnés d'une facture" → Chaque commande unique détermine ses caractéristiques

**VENTE :**
```
numeroVente → dateVente, heureVente, montantTotal, modePaiement, typeVente, 
              nomClientApproximatif, numeroOrdonnance
```
**Justification** : "reçu manuel...numéro séquentiel" → Chaque vente unique détermine ses informations

**MOUVEMENT_STOCK :**
```
numeroMouvement → codeProduit, numeroLot, typeMouvement, quantite, dateMouvement, 
                  motif, referenceDocument
```
**Justification** : Chaque mouvement enregistré a un identifiant unique qui détermine toutes ses caractéristiques

### 2.2 Dépendances Fonctionnelles Composées (Relations)

**COMPOSER_C (Commande-Produit) :**
```
(numeroCommande, codeProduit) → quantiteCommandee, prixAchatUnitaire
```
**Justification** : "La commande inclut le nom du produit, la quantité désirée" → Pour une commande et un produit donnés, on a une quantité et un prix spécifiques

**COMPOSER_V (Vente-Produit) :**
```
(numeroVente, codeProduit) → quantiteVendue, prixVenteUnitaire
```
**Justification** : "les produits vendus, les quantités, les prix unitaires" → Pour une vente et un produit donnés, on a une quantité et un prix spécifiques

### 2.3 Graphe de Dépendances Fonctionnelles (Représentation textuelle)

```
Niveau 1 (Identifiants primaires) :
==================================
codeProduit* ──→ {nomGenerique, nomCommercial, categorie, prixAchatUnitaire, 
                  prixVenteUnitaire, conditionStockage, seuilRapprovisionnement, stockActuel}

codeFournisseur* ──→ {nomFournisseur, typeFournisseur, adresse, telephone, email}

numeroCommande* ──→ {codeFournisseur#, dateCommande, dateLivraison, montantTotal, 
                     modePaiement, statutCommande}

numeroVente* ──→ {dateVente, heureVente, montantTotal, modePaiement, typeVente, 
                  nomClientApproximatif, numeroOrdonnance}

numeroLot* ──→ {codeProduit#, numeroCommande#, quantiteRecue, dateReception, 
                dateExpiration, etatLot}

numeroMouvement* ──→ {codeProduit#, numeroLot#, typeMouvement, quantite, dateMouvement, 
                      motif, referenceDocument}

Niveau 2 (Clés composées - Relations) :
========================================
(numeroCommande*, codeProduit*) ──→ {quantiteCommandee, prixAchatUnitaire}

(numeroVente*, codeProduit*) ──→ {quantiteVendue, prixVenteUnitaire}

Dépendances transitives (validées) :
====================================
numeroLot* ──→ numeroCommande# ──→ codeFournisseur#
(Acceptable car préserve l'information de traçabilité : quel lot provient de quel fournisseur)

numeroMouvement* ──→ codeProduit# ──→ {nomGenerique, categorie...}
(Acceptable pour la consultation rapide des informations produit lors de l'analyse des mouvements)
```

**Vérification de la 3ème Forme Normale (3FN) :**
- ✅ Toutes les entités sont en 1FN (pas d'attributs multi-valués)
- ✅ Toutes les entités sont en 2FN (pas de dépendances partielles)
- ✅ Les dépendances transitives identifiées sont justifiées pour la traçabilité métier

## 3. DICTIONNAIRE DES DONNÉES

| Nom de la donnée | Format | Longueur | Type | Règle de calcul | Règle de gestion | Document |
|-----------------|--------|----------|------|----------------|------------------|----------|
| ***codeProduit** | AN | 10 | Élémentaire | - | RG01 : Format = Lettre catégorie + Numéro séquentiel (ex: A001) | Registre de stocks, Étiquettes produits |
| nomGenerique | A | 100 | Élémentaire | - | Obligatoire, Nom DCI du médicament | Registre de stocks, Facture fournisseur |
| nomCommercial | A | 100 | Élémentaire | - | Obligatoire, Nom de marque | Registre de stocks, Facture fournisseur |
| categorie | A | 50 | Élémentaire | - | RG01 : Valeurs = {Antidouleurs, Antibiotiques, Vitamines, Crèmes, Accessoires...} | Registre de stocks |
| prixAchatUnitaire | N | 10,2 | Élémentaire | - | RG11 : Doit être < prixVenteUnitaire | Facture fournisseur |
| prixVenteUnitaire | N | 10,2 | Élémentaire | - | RG11 : Doit être > prixAchatUnitaire | Registre de stocks, Reçu de vente |
| conditionStockage | A | 200 | Élémentaire | - | Exemples : "Conserver au frais", "Protéger de la lumière" | Registre de stocks, Notice produit |
| seuilRapprovisionnement | N | 5 | Élémentaire | - | RG02 : Valeur typique = 10 unités pour articles populaires | Registre de stocks |
| stockActuel | N | 8 | Calculée | stockActuel = Σ(Entrées) - Σ(Sorties) | RG04, RG05 : Mis à jour à chaque mouvement | Registre de stocks |
| ***codeFournisseur** | AN | 10 | Élémentaire | - | Identifiant unique du fournisseur | Registre fournisseurs |
| nomFournisseur | A | 150 | Élémentaire | - | Obligatoire, Raison sociale complète | Facture, Contrat |
| typeFournisseur | A | 50 | Élémentaire | - | Valeurs = {Grossiste pharmaceutique, Représentant laboratoire} | Registre fournisseurs |
| adresse | A | 250 | Élémentaire | - | Adresse postale complète | Registre fournisseurs |
| telephone | AN | 20 | Élémentaire | - | Format international recommandé | Registre fournisseurs |
| email | AN | 100 | Élémentaire | - | Format email valide | Registre fournisseurs |
| ***numeroCommande** | AN | 15 | Élémentaire | - | Numéro séquentiel unique ou numéro facture | Facture fournisseur |
| dateCommande | D | 10 | Élémentaire | - | Format : JJ/MM/AAAA | Registre commandes |
| dateLivraison | D | 10 | Élémentaire | - | RG07 : ≤ dateCommande + 48h | Facture fournisseur |
| montantTotal | N | 12,2 | Calculée | montantTotal = Σ(quantiteCommandee × prixAchatUnitaire) | - | Facture fournisseur |
| modePaiement | A | 20 | Élémentaire | - | Valeurs = {Espèces, Chèque, Carte bancaire} | Facture fournisseur |
| statutCommande | A | 20 | Élémentaire | - | Valeurs = {En attente, Livrée, Conforme, Non conforme, Retournée} | Registre commandes |
| ***numeroVente** | AN | 15 | Élémentaire | - | Numéro séquentiel du reçu | Reçu de vente |
| dateVente | D | 10 | Élémentaire | - | Format : JJ/MM/AAAA | Reçu de vente |
| heureVente | H | 8 | Élémentaire | - | Format : HH:MM:SS | Reçu de vente (implicite) |
| montantTotalVente | N | 12,2 | Calculée | montantTotal = Σ(quantiteVendue × prixVenteUnitaire) | - | Reçu de vente |
| modePaiementVente | A | 20 | Élémentaire | - | Valeurs = {Espèces, Chèque, Carte bancaire} | Reçu de vente |
| typeVente | A | 30 | Élémentaire | - | Valeurs = {Sur ordonnance, Libre-service} | Reçu de vente |
| nomClientApproximatif | A | 100 | Élémentaire | - | RG06 : Obligatoire si typeVente = "Sur ordonnance" | Dossier ordonnances |
| numeroOrdonnance | AN | 20 | Élémentaire | - | RG06 : Obligatoire si typeVente = "Sur ordonnance" | Ordonnance médicale |
| ***numeroLot** | AN | 20 | Élémentaire | - | Référence unique du lot (ex: numéro facture) | Facture fournisseur |
| quantiteRecue | N | 8 | Élémentaire | - | Quantité livrée pour ce lot | Facture fournisseur |
| dateReception | D | 10 | Élémentaire | - | Format : JJ/MM/AAAA | Facture fournisseur |
| dateExpiration | D | 10 | Élémentaire | - | RG03 : Si dépassée → retrait obligatoire | Étiquette produit |
| etatLot | A | 20 | Élémentaire | - | Valeurs = {Actif, Expiré, Endommagé, Retourné, Rappelé} | Registre de stocks |
| ***numeroMouvement** | AN | 15 | Élémentaire | - | Identifiant unique séquentiel du mouvement | Registre de stocks |
| typeMouvement | A | 20 | Élémentaire | - | Valeurs = {Entrée, Sortie} | Registre de stocks |
| quantite | N | 8 | Élémentaire | - | Quantité concernée par le mouvement (+ pour entrée, - pour sortie) | Registre de stocks |
| dateMouvement | D | 10 | Élémentaire | - | Format : JJ/MM/AAAA | Registre de stocks |
| motif | A | 50 | Élémentaire | - | Valeurs = {Achat, Vente, Perte expiration, Retour client, Rappel lot, Dommage} | Registre de stocks |
| referenceDocument | AN | 30 | Élémentaire | - | RG12 : Référence facture, reçu ou certificat | Document source |
| quantiteCommandee | N | 8 | Élémentaire | - | Quantité commandée pour un produit dans une commande | Facture fournisseur |
| prixAchatUnitaireCmd | N | 10,2 | Élémentaire | - | Prix d'achat pour ce produit dans cette commande | Facture fournisseur |
| quantiteVendue | N | 8 | Élémentaire | - | Quantité vendue pour un produit dans une vente | Reçu de vente |
| prixVenteUnitaireVte | N | 10,2 | Élémentaire | - | Prix de vente pour ce produit dans cette vente | Reçu de vente |

**Légende :**
- **Format** : A = Alphabétique, N = Numérique, AN = Alphanumérique, D = Date, H = Heure
- **Longueur** : Nombre de caractères (pour numérique : chiffres entiers, décimales)
- ***** = Identifiant (clé primaire)
- **#** = Clé étrangère

## 4. MODÈLE CONCEPTUEL DE COMMUNICATION (MCC)

### 4.1 Acteurs Externes et Internes

| **Acteur** | **Type** | **Rôle** | **Extrait de l'énoncé** |
|------------|----------|----------|------------------------|
| M. Dibaphar (PAPA DIBAPHAR) | Interne | Pharmacien gérant unique | "gérée exclusivement par M. Dibaphar, un pharmacien expérimenté qui s'occupe de l'ensemble des opérations" |
| Client | Externe | Acheteur de produits | "Un client entre librement dans la pharmacie...demande conseil" |
| Fournisseur | Externe | Approvisionneur de produits | "passe une commande...auprès d'un fournisseur, qui est typiquement un grossiste pharmaceutique" |
| Service Déchets Médicaux | Externe | Collecteur de déchets pharmaceutiques | "ces déchets sont ensuite collectés par un service spécialisé de ramassage" |
| Autorités Sanitaires | Externe | Contrôleur réglementaire | "d'éventuels contrôles par les autorités sanitaires, qui visitent périodiquement la pharmacie" |

### 4.2 Flux d'Information

```
DIAGRAMME MCC (représentation textuelle) :

┌─────────────────┐         Demande conseil/produit          ┌──────────────┐
│                 │◄──────────────────────────────────────────│              │
│                 │                                            │              │
│                 │         Conseil + Produits + Reçu          │              │
│  M. DIBAPHAR    │───────────────────────────────────────────►│   CLIENT     │
│  (Pharmacien)   │                                            │              │
│                 │         Présentation ordonnance            │              │
│                 │◄──────────────────────────────────────────│              │
└────────┬────────┘                                            └──────────────┘
         │                                                             
         │ Bon de commande                                   ┌──────────────┐
         │────────────────────────────────────────────────────►              │
         │                                                     │              │
         │ Facture + Produits livrés                          │ FOURNISSEUR  │
         │◄────────────────────────────────────────────────────│              │
         │                                                     │              │
         │ Paiement + Accusé réception                        │              │
         │────────────────────────────────────────────────────►              │
         │                                                     └──────────────┘
         │ Retour produits non conformes                               
         │────────────────────────────────────────────────────►              
         │                                                                    
         │ Avoir/Remboursement                                               
         │◄────────────────────────────────────────────────────               
         │
         │ Produits expirés/endommagés                        ┌──────────────┐
         │────────────────────────────────────────────────────►              │
         │                                                     │  SERVICE     │
         │ Certificat de destruction                          │  DÉCHETS     │
         │◄────────────────────────────────────────────────────│  MÉDICAUX    │
         │                                                     └──────────────┘
         │
         │ Registres de stocks + Factures                     ┌──────────────┐
         │────────────────────────────────────────────────────►              │
         │                                                     │  AUTORITÉS   │
         │ Rapport de conformité                              │  SANITAIRES  │
         │◄────────────────────────────────────────────────────│              │
         │                                                     └──────────────┘
         │ Avis de rappel de lot                                       
         │◄────────────────────────────────────────────────────               
```

**Messages échangés (détail) :**

1. **Client → M. Dibaphar** : Demande de produit/conseil, Présentation ordonnance, Paiement
2. **M. Dibaphar → Client** : Conseil pharmaceutique, Produits, Reçu de vente
3. **M. Dibaphar → Fournisseur** : Bon de commande, Paiement, Retour produits, Accusé réception
4. **Fournisseur → M. Dibaphar** : Facture, Produits livrés, Avoir, Avis de rappel
5. **M. Dibaphar → Service Déchets** : Produits expirés/endommagés
6. **Service Déchets → M. Dibaphar** : Certificat de destruction
7. **M. Dibaphar → Autorités** : Registres, Factures, Ordonnances
8. **Autorités → M. Dibaphar** : Rapport de conformité, Demandes de vérification

## 5. MODÈLE CONCEPTUEL DE TRAITEMENT (MCT)

### 5.1 Événements Déclencheurs

| **Événement** | **Extrait de l'énoncé** | **Condition** |
|---------------|------------------------|--------------|
| E1 : Stock faible détecté | "Si un produit approche de la rupture...il passe une commande" | stockActuel ≤ seuilRapprovisionnement |
| E2 : Commande validée | "passe une commande verbale ou écrite auprès d'un fournisseur" | Besoin identifié |
| E3 : Livraison reçue | "Le fournisseur livre les produits...dans les 48 heures" | Commande en attente |
| E4 : Client demande produit | "Un client entre...demande conseil" | Heures d'ouverture |
| E5 : Vente finalisée | "Le client paie...la vente est clôturée" | Produit disponible + Paiement reçu |
| E6 : Expiration détectée | "Tous les mois, il effectue un inventaire...Si un produit est expiré" | dateCourante > dateExpiration |
| E7 : Rappel de lot reçu | "fournissent...des rappels de lots défectueux" | Communication fournisseur |
| E8 : Contrôle réglementaire | "autorités...visitent périodiquement la pharmacie" | Planification autorités |

### 5.2 Processus Métier Détaillés

#### **PROCESSUS 1 : GESTION DES APPROVISIONNEMENTS**

```
┌─────────────────────────────────────────────────────────────────────────┐
│ PROCESSUS : Approvisionnement et Réception                              │
└─────────────────────────────────────────────────────────────────────────┘

[E1: Stock faible détecté] OU [Inventaire mensuel]
    │
    ▼
┌──────────────────────────────────┐
│ OPÉRATION 1 :                    │
│ Consulter registre de stocks    │
│                                   │
│ Extrait : "consulte son registre │
│ de stocks...vérifie les niveaux" │
│                                   │
│ Règle : RG02, RG10               │
└──────────┬───────────────────────┘
           │
           ▼
    [stockActuel ≤ seuilRapprovisionnement?]
           │
           │ OUI
           ▼
┌──────────────────────────────────┐
│ OPÉRATION 2 :                    │
│ Créer commande fournisseur       │
│                                   │
│ Extrait : "passe une commande    │
│ verbale ou écrite incluant le    │
│ nom du produit, la quantité"     │
│                                   │
│ Sortie : numeroCommande          │
│ Règle : Choix fournisseur        │
└──────────┬───────────────────────┘
           │
           ▼
┌──────────────────────────────────┐
│ OPÉRATION 3 :                    │
│ Envoyer bon de commande          │
│                                   │
│ Flux : M.Dibaphar → Fournisseur  │
└──────────┬───────────────────────┘
           │
           ▼
    [Attente livraison : 48h max]
           │
           ▼
[E3: Livraison reçue]
           │
           ▼
┌──────────────────────────────────┐
│ OPÉRATION 4 :                    │
│ Inspecter livraison              │
│                                   │
│ Extrait : "inspecte la livraison │
│ pour vérifier la conformité      │
│ (quantité, état, dates)"         │
│                                   │
│ Règle : RG08                     │
└──────────┬───────────────────────┘
           │
           ▼
    [Livraison conforme?]
           │
           ├─── NON ───┐
           │           │
           │           ▼
           │    ┌──────────────────────────────┐
           │    │ OPÉRATION 5a :               │
           │    │ Retourner produits           │
           │    │                              │
           │    │ Extrait : "le retourne       │
           │    │ immédiatement au fournisseur"│
           │    │                              │
           │    │ Règle : RG09                 │
           │    │ statutCommande = "Retournée" │
           │    └──────────┬───────────────────┘
           │               │
           │               ▼
           │        [Recevoir avoir]
           │               │
           │               └──► [FIN PROCESSUS]
           │
           │ OUI
           ▼
┌──────────────────────────────────┐
│ OPÉRATION 5b :                   │
│ Créer lot(s) produit             │
│                                   │
│ Extrait : "enregistre l'entrée"  │
│                                   │
│ Pour chaque produit commandé :   │
│  - numeroLot = numéro facture    │
│  - dateReception = date courante │
│  - etatLot = "Actif"             │
│                                   │
│ Règle : RG05                     │
└──────────┬───────────────────────┘
           │
           ▼
┌──────────────────────────────────┐
│ OPÉRATION 6 :                    │
│ Enregistrer mouvements d'entrée  │
│                                   │
│ Extrait : "ajoute la quantité    │
│ reçue...met à jour le stock"     │
│                                   │
│ Pour chaque lot :                │
│  - typeMouvement = "Entrée"      │
│  - motif = "Achat"               │
│  - quantite = quantiteRecue      │
│  - stockActuel += quantite       │
│                                   │
│ Règle : RG05                     │
└──────────┬───────────────────────┘
           │
           ▼
┌──────────────────────────────────┐
│ OPÉRATION 7 :                    │
│ Effectuer paiement               │
│                                   │
│ Extrait : "paie comptant ou      │
│ par chèque sur place"            │
│                                   │
│ statutCommande = "Livrée"        │
└──────────┬───────────────────────┘
           │
           ▼
┌──────────────────────────────────┐
│ OPÉRATION 8 :                    │
│ Archiver facture                 │
│                                   │
│ Extrait : "documentation est     │
│ archivée chronologiquement"      │
│                                   │
│ Règle : RG12                     │
└──────────┬───────────────────────┘
           │
           ▼
    [FIN PROCESSUS]
```

#### **PROCESSUS 2 : GESTION DES VENTES**

```
┌─────────────────────────────────────────────────────────────────────────┐
│ PROCESSUS : Vente de produits                                           │
└─────────────────────────────────────────────────────────────────────────┘

[E4: Client demande produit]
    │
    ▼
┌──────────────────────────────────┐
│ OPÉRATION 1 :                    │
│ Accueillir client et identifier  │
│ besoin                            │
│                                   │
│ Extrait : "Un client entre...    │
│ demande conseil...présente une   │
│ ordonnance...ou décrit symptômes"│
└──────────┬───────────────────────┘
           │
           ▼
    [Type de demande?]
           │
           ├──► Sur ordonnance ──┐
           │                     │
           │                     ▼
           │          ┌──────────────────────┐
           │          │ Vérifier ordonnance  │
           │          │ Règle : RG06         │
           │          │ Enregistrer          │
           │          │ numeroOrdonnance +   │
           │          │ nomClientApproximatif│
           │          └──────────┬───────────┘
           │                     │
           └──► Libre-service ───┴───────┐
                                         │
                                         ▼
                            ┌────────────────────────┐
                            │ OPÉRATION 2 :          │
                            │ Conseiller et vérifier │
                            │ disponibilité          │
                            │                        │
                            │ Extrait : "écoute les  │
                            │ besoins, vérifie la    │
                            │ disponibilité...       │
                            │ conseille"             │
                            └──────────┬─────────────┘
                                       │
                                       ▼
                            [Produit en stock?]
                                       │
                                       ├─── NON ───┐
                                       │           │
                                       │           ▼
                                       │   ┌───────────────┐
                                       │   │ Proposer      │
                                       │   │ alternative   │
                                       │   │ ou commander  │
                                       │   └───────────────┘
                                       │
                                       │ OUI
                                       ▼
                            ┌────────────────────────┐
                            │ OPÉRATION 3 :          │
                            │ Préparer produits      │
                            │                        │
                            │ Extrait : "sélectionne │
                            │ les articles...place   │
                            │ sur le comptoir"       │
                            └──────────┬─────────────┘
                                       │
                                       ▼
                            ┌────────────────────────┐
                            │ OPÉRATION 4 :          │
                            │ Calculer montant total │
                            │                        │
                            │ Extrait : "calcule le  │
                            │ montant total en       │
                            │ multipliant quantité × │
                            │ prix"                  │
                            │                        │
                            │ montantTotal = Σ(qté × │
                            │ prixVenteUnitaire)     │
                            └──────────┬─────────────┘
                                       │
                                       ▼
                            ┌────────────────────────┐
                            │ OPÉRATION 5 :          │
                            │ Encaisser paiement     │
                            │                        │
                            │ Extrait : "Le client   │
                            │ paie en espèces, par   │
                            │ carte ou chèque"       │
                            └──────────┬─────────────┘
                                       │
                                       ▼
[E5: Vente finalisée]
                                       │
                                       ▼
                            ┌────────────────────────┐
                            │ OPÉRATION 6 :          │
                            │ Créer vente et émettre │
                            │ reçu                   │
                            │                        │
                            │ Extrait : "délivre un  │
                            │ reçu manuel indiquant  │
                            │ date, produits,        │
                            │ quantités, prix, total"│
                            │                        │
                            │ numeroVente généré     │
                            └──────────┬─────────────┘
                                       │
                                       ▼
                            ┌────────────────────────┐
                            │ OPÉRATION 7 :          │
                            │ Enregistrer lignes de  │
                            │ vente (COMPOSER_V)     │
                            │                        │
                            │ Pour chaque produit :  │
                            │  - quantiteVendue      │
                            │  - prixVenteUnitaire   │
                            └──────────┬─────────────┘
                                       │
                                       ▼
                            ┌────────────────────────┐
                            │ OPÉRATION 8 :          │
                            │ Mettre à jour stocks   │
                            │                        │
                            │ Extrait : "met à jour  │
                            │ son registre en        │
                            │ soustrayant la quantité│
                            │ vendue"                │
                            │                        │
                            │ Pour chaque produit :  │
                            │  - typeMouvement =     │
                            │    "Sortie"            │
                            │  - motif = "Vente"     │
                            │  - quantite = -qté     │
                            │  - stockActuel -= qté  │
                            │                        │
                            │ Règle : RG04           │
                            └──────────┬─────────────┘
                                       │
                                       ▼
                            ┌────────────────────────┐
                            │ OPÉRATION 9 :          │
                            │ Archiver ordonnance    │
                            │ (si applicable)        │
                            │                        │
                            │ Extrait : "conserve une│
                            │ copie de l'ordonnance" │
                            │                        │
                            │ Règle : RG06           │
                            └──────────┬─────────────┘
                                       │
                                       ▼
                                [FIN PROCESSUS]
```

#### **PROCESSUS 3 : GESTION DES PERTES ET RAPPELS**

```
┌─────────────────────────────────────────────────────────────────────────┐
│ PROCESSUS : Gestion des pertes, expirations et rappels                  │
└─────────────────────────────────────────────────────────────────────────┘

[E6: Inventaire mensuel] OU [E7: Rappel de lot]
    │
    ▼
┌──────────────────────────────────┐
│ OPÉRATION 1 :                    │
│ Identifier lots concernés        │
│                                   │
│ Pour expiration :                │
│  Extrait : "effectue un          │
│  inventaire...Si produit expiré" │
│  Condition : dateCourante >      │
│              dateExpiration      │
│                                   │
│ Pour rappel :                    │
│  Extrait : "rappels de lots      │
│  défectueux via courriers"       │
│  Condition : Avis fournisseur    │
│                                   │
│ Règle : RG03                     │
└──────────┬───────────────────────┘
           │
           ▼
┌──────────────────────────────────┐
│ OPÉRATION 2 :                    │
│ Retirer lots des étagères        │
│                                   │
│ Extrait : "il le retire des      │
│ étagères, le place dans une zone │
│ de déchets sécurisée"            │
│                                   │
│ Mettre à jour :                  │
│  etatLot = "Expiré" ou "Rappelé" │
└──────────┬───────────────────────┘
           │
           ▼
    [Type de sortie?]
           │
           ├──► Expiration/Dommage ──┐
           │                         │
           │                         ▼
           │              ┌──────────────────────┐
           │              │ OPÉRATION 3a :       │
           │              │ Enregistrer perte    │
           │              │                      │
           │              │ Extrait : "note la   │
           │              │ sortie...comme perte"│
           │              │                      │
           │              │ - typeMouvement =    │
           │              │   "Sortie"           │
           │              │ - motif = "Perte     │
           │              │   expiration" ou     │
           │              │   "Dommage"          │
           │              │ - stockActuel -= qté │
           │              │                      │
           │              │ Règle : RG03, RG04   │
           │              └──────────┬───────────┘
           │                         │
           │                         ▼
           │              ┌──────────────────────┐
           │              │ Contacter service    │
           │              │ déchets médicaux     │
           │              │                      │
           │              │ Extrait : "collectés │
           │              │ par service          │
           │              │ spécialisé"          │
           │              └──────────┬───────────┘
           │                         │
           │                         ▼
           │              [Recevoir certificat destruction]
           │                         │
           │                         └──► [Archiver certificat]
           │
           └──► Rappel ──────────────┐
                                     │
                                     ▼
                          ┌──────────────────────┐
                          │ OPÉRATION 3b :       │
                          │ Retourner au         │
                          │ fournisseur          │
                          │                      │
                          │ Extrait : "retire    │
                          │ immédiatement les    │
                          │ lots...les retourne  │
                          │ au fournisseur"      │
                          │                      │
                          │ - typeMouvement =    │
                          │   "Sortie"           │
                          │ - motif = "Rappel    │
                          │   lot"               │
                          │ - stockActuel -= qté │
                          │                      │
                          │ Règle : RG04         │
                          └──────────┬───────────┘
                                     │
                                     ▼
                          [Recevoir remboursement/avoir]
                                     │
                                     └──► [Archiver avoir]
```

## 6. MODÈLE ORGANISATIONNEL DE TRAITEMENT (MOT/MOpt)

### 6.1 Postes de Travail

| **Poste** | **Acteur** | **Responsabilités** | **Extrait de l'énoncé** |
|-----------|------------|-------------------|------------------------|
| Pharmacien Gérant | M. Dibaphar | • Gestion des approvisionnements<br>• Conseil et vente<br>• Gestion des stocks<br>• Relations fournisseurs<br>• Administration<br>• Contrôle qualité | "gérée exclusivement par M. Dibaphar...s'occupe de l'ensemble des opérations quotidiennes de manière manuelle" |

**Remarque importante** : La pharmacie DIBAPHAR fonctionne avec un seul poste multifonction (M. Dibaphar). Dans un MOT classique avec plusieurs postes, nous aurions séparé les responsabilités, mais ici tout est centralisé.

### 6.2 Procédures Organisées par Poste

#### **PROCÉDURE 1 : Approvisionnement**

| **Phase** | **Opération** | **Poste** | **Durée** | **Périodicité** | **Extrait justificatif** |
|-----------|--------------|-----------|-----------|----------------|-------------------------|
| 1 | Vérifier les stocks | Pharmacien Gérant | 30-45 min | Quotidien (soir/matin) | "consulte son registre de stocks le soir après la fermeture ou le matin avant l'ouverture" |
| 2 | Compter physiquement les unités | Pharmacien Gérant | Variable | Quotidien pour articles critiques | "compte physiquement les unités restantes sur les étagères" |
| 3 | Identifier produits à commander | Pharmacien Gérant | 15 min | Si stock < seuil | "Si un produit approche de la rupture...moins de 10 unités" |
| 4 | Passer commande au fournisseur | Pharmacien Gérant | 10-20 min | Selon besoins | "passe une commande verbale ou écrite" |
| 5 | Réceptionner et inspecter livraison | Pharmacien Gérant | 20-30 min | Sous 48h après commande | "inspecte la livraison pour vérifier la conformité (quantité, état, dates)" |
| 6 | Enregistrer réception dans registre | Pharmacien Gérant | 15 min | À chaque livraison | "enregistre l'entrée dans son registre de stocks" |
| 7 | Payer le fournisseur | Pharmacien Gérant | 5 min | À chaque livraison | "paie comptant ou par chèque sur place" |
| 8 | Archiver facture | Pharmacien Gérant | 2 min | À chaque livraison | "documentation est archivée chronologiquement dans des classeurs" |

#### **PROCÉDURE 2 : Vente**

| **Phase** | **Opération** | **Poste** | **Durée** | **Périodicité** | **Extrait justificatif** |
|-----------|--------------|-----------|-----------|----------------|-------------------------|
| 1 | Accueillir et écouter le client | Pharmacien Gérant | 2-5 min | Chaque client | "Un client entre...demande conseil" |
| 2 | Analyser l'ordonnance (si applicable) | Pharmacien Gérant | 3-5 min | Si ordonnance | "présente une ordonnance médicale...détails comme nom du patient, médicament, posologie" |
| 3 | Conseiller sur l'utilisation | Pharmacien Gérant | 5-10 min | Chaque vente | "conseille sur l'utilisation appropriée, les contre-indications et les alternatives" |
| 4 | Vérifier disponibilité | Pharmacien Gérant | 1-2 min | Chaque vente | "vérifie la disponibilité en consultant rapidement son registre ou en regardant les étagères" |
| 5 | Préparer les produits | Pharmacien Gérant | 2-3 min | Chaque vente | "sélectionne les articles...place sur le comptoir" |
| 6 | Calculer le montant | Pharmacien Gérant | 1 min | Chaque vente | "calcule le montant total en multipliant la quantité par le prix" |
| 7 | Encaisser le paiement | Pharmacien Gérant | 1-2 min | Chaque vente | "Le client paie en espèces, par carte bancaire...ou par chèque" |
| 8 | Émettre le reçu | Pharmacien Gérant | 2 min | Chaque vente | "délivre un reçu manuel écrit à la main sur un bloc-notes carbone" |
| 9 | Mettre à jour le registre de stocks | Pharmacien Gérant | 3 min | Après chaque vente | "met à jour son registre de stocks en soustrayant la quantité vendue" |
| 10 | Archiver ordonnance (si applicable) | Pharmacien Gérant | 1 min | Si ordonnance | "conserve une copie de l'ordonnance dans un dossier séparé" |

#### **PROCÉDURE 3 : Inventaire et Gestion des Pertes**

| **Phase** | **Opération** | **Poste** | **Durée** | **Périodicité** | **Extrait justificatif** |
|-----------|--------------|-----------|-----------|----------------|-------------------------|
| 1 | Effectuer inventaire complet | Pharmacien Gérant | 2-4 heures | Mensuel | "Tous les mois, il effectue un inventaire manuel en comptant physiquement tous les produits" |
| 2 | Comparer stock physique/registre | Pharmacien Gérant | 30 min | Mensuel | "compare avec le registre" |
| 3 | Identifier produits expirés | Pharmacien Gérant | 20 min | Mensuel | "Si un produit est expiré (date d'expiration dépassée)" |
| 4 | Retirer produits expirés | Pharmacien Gérant | 15 min | Selon détection | "il le retire des étagères, le place dans une zone de déchets médicaux sécurisée" |
| 5 | Enregistrer perte dans registre | Pharmacien Gérant | 5 min | À chaque perte | "note la sortie dans le registre comme une perte, avec la quantité, la date et la raison" |
| 6 | Contacter service de déchets | Pharmacien Gérant | 10 min | Selon volume | "collectés par un service spécialisé de ramassage des déchets pharmaceutiques" |
| 7 | Archiver certificat de destruction | Pharmacien Gérant | 2 min | Après collecte | "certificat de destruction que M. Dibaphar archive" |

### 6.3 Diagramme Temporel (Journée type)

```
JOURNÉE TYPE DE M. DIBAPHAR :

07:30 - 08:00 │ Arrivée, ouverture, consultation registre stocks
━━━━━━━━━━━━━━┼━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
08:00 - 13:00 │ ████████████████████ Accueil clients / Ventes
              │ (Moyenne : 4-6 clients/heure)
              │ Activités :
              │  - Conseil pharmaceutique
              │  - Ventes avec/sans ordonnance
              │  - Mise à jour registre après chaque vente
              │  - Réception livraisons éventuelles
━━━━━━━━━━━━━━┼━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
13:00 - 14:00 │ ░░░░░░░░░░░ PAUSE DÉJEUNER (Fermé)
━━━━━━━━━━━━━━┼━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
14:00 - 20:00 │ ████████████████████ Accueil clients / Ventes
              │ (Moyenne : 5-8 clients/heure - pic 17h-19h)
              │ Activités :
              │  - Conseil pharmaceutique
              │  - Ventes avec/sans ordonnance
              │  - Mise à jour registre après chaque vente
              │  - Rangement/réapprovisionnement étagères
━━━━━━━━━━━━━━┼━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
20:00 - 20:30 │ Clôture caisse / Vérification stocks critiques
              │ Préparation commandes si nécessaire
━━━━━━━━━━━━━━┼━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
20:30         │ Fermeture

ACTIVITÉS MENSUELLES (hors heures ouverture ou dimanche) :
- Inventaire complet : 1 dimanche/mois (2-4h)
- Archivage et rapports : 1-2h/mois
- Contrôles réglementaires : Selon calendrier autorités
```

## 7. MODÈLE CONCEPTUEL DE DONNÉES (MCD)

### 7.1 Schéma MCD Textuel Complet

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      MODÈLE CONCEPTUEL DE DONNÉES                        │
│                       Pharmacie DIBAPHAR                                 │
└─────────────────────────────────────────────────────────────────────────┘

ENTITÉ : PRODUIT
━━━━━━━━━━━━━━━━
*codeProduit (AN10) [PK]
nomGenerique (A100)
nomCommercial (A100)
categorie (A50)
prixAchatUnitaire (N10,2)
prixVenteUnitaire (N10,2)
conditionStockage (A200)
seuilRapprovisionnement (N5)
stockActuel (N8) [Calculé]

ENTITÉ : FOURNISSEUR
━━━━━━━━━━━━━━━━━━━━
*codeFournisseur (AN10) [PK]
nomFournisseur (A150)
typeFournisseur (A50)
adresse (A250)
telephone (AN20)
email (AN100)

ENTITÉ : COMMANDE
━━━━━━━━━━━━━━━━━
*numeroCommande (AN15) [PK]
#codeFournisseur (AN10) [FK → FOURNISSEUR]
dateCommande (D10)
dateLivraison (D10)
montantTotal (N12,2) [Calculé]
modePaiement (A20)
statutCommande (A20)

ENTITÉ : LOT_PRODUIT
━━━━━━━━━━━━━━━━━━━━
*numeroLot (AN20) [PK]
#codeProduit (AN10) [FK → PRODUIT]
#numeroCommande (AN15) [FK → COMMANDE]
quantiteRecue (N8)
dateReception (D10)
dateExpiration (D10)
etatLot (A20)

ENTITÉ : VENTE
━━━━━━━━━━━━━━
*numeroVente (AN15) [PK]
dateVente (D10)
heureVente (H8)
montantTotal (N12,2) [Calculé]
modePaiement (A20)
typeVente (A30)
nomClientApproximatif (A100)
numeroOrdonnance (AN20)

ENTITÉ : MOUVEMENT_STOCK
━━━━━━━━━━━━━━━━━━━━━━━━
*numeroMouvement (AN15) [PK]
#codeProduit (AN10) [FK → PRODUIT]
#numeroLot (AN20) [FK → LOT_PRODUIT] [Optionnel]
typeMouvement (A20)
quantite (N8)
dateMouvement (D10)
motif (A50)
referenceDocument (AN30)

RELATION : FOURNIR
━━━━━━━━━━━━━━━━━━
FOURNISSEUR (1,n) ──[FOURNIR]── (1,1) COMMANDE
Extrait : "passe une commande auprès d'un fournisseur"

RELATION : CONCERNER_P
━━━━━━━━━━━━━━━━━━━━━━
PRODUIT (1,n) ──[CONCERNER_P]── (1,1) LOT_PRODUIT
Extrait : "Chaque produit...quantité reçue"

RELATION : GENERER_L
━━━━━━━━━━━━━━━━━━━━
COMMANDE (1,n) ──[GENERER_L]── (1,1) LOT_PRODUIT
Extrait : "Le fournisseur livre...Il enregistre l'entrée"

RELATION : COMPOSER_C (avec attributs)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
COMMANDE (1,n) ──[COMPOSER_C]── (0,n) PRODUIT
Attributs de la relation :
  - quantiteCommandee (N8)
  - prixAchatUnitaire (N10,2)
Extrait : "La commande inclut le nom du produit, la quantité désirée"

RELATION : COMPOSER_V (avec attributs)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
VENTE (1,n) ──[COMPOSER_V]── (0,n) PRODUIT
Attributs de la relation :
  - quantiteVendue (N8)
  - prixVenteUnitaire (N10,2)
Extrait : "les produits vendus, les quantités, les prix unitaires"

RELATION : IMPACTER
━━━━━━━━━━━━━━━━━━━
MOUVEMENT_STOCK (1,n) ──[IMPACTER]── (1,1) PRODUIT
Extrait : "met à jour son registre...du produit concerné"

RELATION : PROVENIR_L
━━━━━━━━━━━━━━━━━━━━━
MOUVEMENT_STOCK (0,n) ──[PROVENIR_L]── (0,1) LOT_PRODUIT
Extrait : "retire les lots concernés du stock"

RELATION : ORIGINER_V
━━━━━━━━━━━━━━━━━━━━━
MOUVEMENT_STOCK (0,n) ──[ORIGINER_V]── (0,1) VENTE
Extrait : "soustrayant la quantité vendue...référence au reçu"
```

### 7.2 Représentation Graphique MCD (notation textuelle)

```
                    ┌──────────────┐
                    │ FOURNISSEUR  │
                    │━━━━━━━━━━━━━━│
                    │*codeFourniss.│
                    │ nomFourniss. │
                    │ typeFourniss.│
                    │ adresse      │
                    │ telephone    │
                    │ email        │
                    └──────┬───────┘
                           │ (1,n)
                           │
                      [FOURNIR]
                           │
                           │ (1,1)
                    ┌──────▼───────┐           ┌──────────────┐
                    │  COMMANDE    │──(1,n)───[COMPOSER_C]──(0,n)──│   PRODUIT    │
                    │━━━━━━━━━━━━━━│           │ qteCommandee │     │━━━━━━━━━━━━━━│
                    │*numeroComman.│           │ prixAchatUni.│     │*codeProduit  │
                    │#codeFourniss.│           └──────────────┘     │ nomGenerique │
                    │ dateCommande │                                │ nomCommercial│
                    │ dateLivraison│                                │ categorie    │
                    │ montantTotal │                                │ prixAchatUni.│
                    │ modePaiement │                                │ prixVenteUni.│
                    │ statutComman.│                                │ conditionSto.│
                    └──────┬───────┘                                │ seuilReappro.│
                           │ (1,n)                                  │ stockActuel  │
                           │                                        └──────┬───────┘
                      [GENERER_L]                                         │ (1,n)
                           │                                              │
                           │ (1,1)                                [CONCERNER_P]
                    ┌──────▼───────┐                                      │
                    │ LOT_PRODUIT  │                                      │ (1,1)
                    │━━━━━━━━━━━━━━│◄─────────────────────────────────────┘
                    │*numeroLot    │
                    │#codeProduit  │
                    │#numeroComman.│
                    │ quantiteRecue│                 ┌──────────────┐
                    │ dateReception│                 │    VENTE     │
                    │ dateExpiratio│                 │━━━━━━━━━━━━━━│
                    │ etatLot      │                 │*numeroVente  │
                    └──────┬───────┘                 │ dateVente    │
                           │ (0,1)                   │ heureVente   │
                           │                         │ montantTotal │
                    [PROVENIR_L]                     │ modePaiement │
                           │                         │ typeVente    │
                           │ (0,n)                   │ nomClientApp.│
                    ┌──────▼───────┐                 │ numeroOrdonn.│
                    │MOUVEMENT_STOC│                 └──────┬───────┘
                    │━━━━━━━━━━━━━━│                        │ (1,n)
                    │*numeroMouvem.│                        │
                    │#codeProduit  │                  [COMPOSER_V]
                    │#numeroLot    │                        │
                    │ typeMouvement│           ┌────────────▼─────┐
                    │ quantite     │           │ qteVendue        │──(0,n)──[vers PRODUIT]
                    │ dateMouvement│           │ prixVenteUnitaire│
                    │ motif        │           └──────────────────┘
                    │ referencDoc. │
                    └──────┬───────┘
                           │ (1,n)
                           │
                      [IMPACTER]
                           │
                           │ (1,1)
                           └─────────────────► [vers PRODUIT]
                           
                           │ (0,1)
                           │
                    [ORIGINER_V]
                           │
                           │ (0,n)
                           └─────────────────► [vers VENTE]
```

### 7.3 Contraintes d'Intégrité

**CI1 (Unicité)** : Chaque code produit est unique dans le système
```
∀ p1, p2 ∈ PRODUIT : p1.codeProduit = p2.codeProduit ⇒ p1 = p2
```

**CI2 (Référentielle)** : Un lot doit toujours référencer un produit existant
```
∀ lot ∈ LOT_PRODUIT : ∃ p ∈ PRODUIT tel que lot.codeProduit = p.codeProduit
```

**CI3 (Métier)** : Le prix de vente doit être supérieur au prix d'achat
```
∀ p ∈ PRODUIT : p.prixVenteUnitaire > p.prixAchatUnitaire
```

**CI4 (Métier)** : Le stock actuel ne peut être négatif
```
∀ p ∈ PRODUIT : p.stockActuel ≥ 0
```

**CI5 (Temporelle)** : La date de livraison doit être après la date de commande
```
∀ c ∈ COMMANDE : c.dateLivraison ≥ c.dateCommande
```

**CI6 (Métier)** : Une vente sur ordonnance doit avoir un numéro d'ordonnance
```
∀ v ∈ VENTE : v.typeVente = "Sur ordonnance" ⇒ v.numeroOrdonnance ≠ NULL
```

**CI7 (Calculée)** : Le montant total d'une commande est la somme des lignes
```
∀ c ∈ COMMANDE : c.montantTotal = Σ(COMPOSER_C.quantiteCommandee × COMPOSER_C.prixAchatUnitaire)
```

**CI8 (Calculée)** : Le stock actuel est la différence entre entrées et sorties
```
∀ p ∈ PRODUIT : p.stockActuel = Σ(MOUVEMENT_STOCK.quantite WHERE typeMouvement="Entrée") 
                                - Σ(MOUVEMENT_STOCK.quantite WHERE typeMouvement="Sortie")
```

## 8. MODÈLE ORGANISATIONNEL DE DONNÉES (MOD)

### 8.1 Responsabilités par Poste sur les Données

| **Donnée/Entité** | **Poste Responsable** | **Ajouter** | **Modifier** | **Supprimer** | **Consulter** | **Justification** |
|-------------------|----------------------|-------------|--------------|---------------|---------------|-------------------|
| **PRODUIT** | Pharmacien Gérant | ✓ | ✓ | ✗ | ✓ | Extrait : "M. Dibaphar attribue manuellement" le code. Pas de suppression physique (traçabilité réglementaire) |
| **FOURNISSEUR** | Pharmacien Gérant | ✓ | ✓ | ✗ | ✓ | Extrait : Contacts gérés manuellement. Historique conservé pour audit |
| **COMMANDE** | Pharmacien Gérant | ✓ | ✓ | ✗ | ✓ | Extrait : "passe une commande...signe la facture". Modification limitée au statut. Pas de suppression (obligation légale) |
| **LOT_PRODUIT** | Pharmacien Gérant | ✓ | ✓ | ✗ | ✓ | Extrait : "enregistre l'entrée". Modification de l'état (actif/expiré). Pas de suppression (traçabilité lots) |
| **VENTE** | Pharmacien Gérant | ✓ | ✗ | ✗ | ✓ | Extrait : "délivre un reçu". Immuable après création (intégrité fiscale). Consultation pour rapports |
| **MOUVEMENT_STOCK** | Pharmacien Gérant | ✓ | ✗ | ✗ | ✓ | Extrait : "met à jour son registre". Journal immuable (traçabilité réglementaire) |
| **COMPOSER_C** (lignes commande) | Pharmacien Gérant | ✓ | ✗ | ✗ | ✓ | Détails commandes immuables après validation |
| **COMPOSER_V** (lignes vente) | Pharmacien Gérant | ✓ | ✗ | ✗ | ✓ | Détails ventes immuables après création reçu |

### 8.2 Règles de Gestion Organisationnelles

**RGO1 : Habilitations d'accès**
- Seul M. Dibaphar a accès à toutes les données
- **Extrait** : "gérée exclusivement par M. Dibaphar"
- **Impact MOD** : Système mono-utilisateur, pas de gestion de droits complexes

**RGO2 : Archivage réglementaire**
- Toutes les données doivent être conservées minimum 10 ans
- **Extrait** : "documentation est archivée chronologiquement dans des classeurs pour d'éventuels contrôles par les autorités sanitaires"
- **Impact MOD** : Pas de suppression logique ou physique des données historiques

**RGO3 : Traçabilité obligatoire**
- Chaque mouvement de stock doit avoir une référence documentaire
- **Extrait** : "référence au reçu...numéro de la facture"
- **Impact MOD** : Contrainte d'intégrité sur referenceDocument (NOT NULL)

**RGO4 : Confidentialité ordonnances**
- Les données clients sur ordonnances sont limitées
- **Extrait** : "le nom approximatif du client...sans détails personnels exhaustifs pour respecter la confidentialité"
- **Impact MOD** : Pas de stockage détaillé des informations personnelles

**RGO5 : Responsabilité unique**
- Toutes les opérations sont effectuées et validées par M. Dibaphar
- **Extrait** : "gère seul les achats, les ventes, le contrôle des stocks"
- **Impact MOD** : Pas de workflow de validation multi-niveaux

### 8.3 Cycles de Vie des Données

**Cycle de vie PRODUIT :**
```
[Création] ──► [Actif avec stock] ──► [Stock faible] ──► [Rupture temporaire]
                     │                                          │
                     │                                          │
                     └────────────────┬─────────────────────────┘
                                      │
                                      ▼
                            [Obsolète - conservation archive]
```
**Extrait** : "Ces registres sont des cahiers à pages numérotées, conservés dans un tiroir verrouillé"

**Cycle de vie LOT_PRODUIT :**
```
[Réception] ──► [Actif] ──┬──► [Vendu progressivement] ──► [Épuisé]
                          │
                          ├──► [Expiré] ──► [Retiré] ──► [Détruit]
                          │
                          └──► [Rappelé] ──► [Retourné fournisseur]
```
**Extrait** : "Si un produit est expiré...il le retire...note la sortie comme une perte"

**Cycle de vie COMMANDE :**
```
[Passée] ──► [En attente livraison] ──┬──► [Livrée conforme] ──► [Archivée]
                                       │
                                       └──► [Non conforme] ──► [Retournée] ──► [Archivée]
```
**Extrait** : "inspecte la livraison...Si endommagé...le retourne immédiatement"

**Cycle de vie VENTE :**
```
[Création reçu] ──► [Finalisée] ──► [Archivée]
       │                │
       │                └──► [Retour exceptionnel] ──► [Correction mouvement stock]
       │
       └──► [Annulée avant paiement] (rare, informel)
```
**Extrait** : "retours de clients (rares...pour produits non ouverts)"

## 9. MODÈLE LOGIQUE DE DONNÉES (MLD)

### 9.1 Passage MCD → MLD : Règles Appliquées

**Règle 1 : Transformation des entités**
- Chaque entité devient une table
- L'identifiant devient clé primaire (PK)

**Règle 2 : Transformation des relations (1,n)-(1,1)**
- Ajout de clé étrangère (FK) du côté (1,1)
- Exemples : 
  - FOURNIR : FK dans COMMANDE
  - CONCERNER_P : FK dans LOT_PRODUIT
  - GENERER_L : FK dans LOT_PRODUIT

**Règle 3 : Transformation des relations (1,n)-(0,n)**
- Création d'une table d'association
- Exemples :
  - COMPOSER_C → Table LIGNE_COMMANDE
  - COMPOSER_V → Table LIGNE_VENTE

**Règle 4 : Transformation des relations (0,n)-(0,1)**
- FK optionnelle (NULL autorisé)
- Exemples :
  - PROVENIR_L : FK numeroLot dans MOUVEMENT_STOCK (optionnelle)
  - ORIGINER_V : FK numeroVente dans MOUVEMENT_STOCK (optionnelle)

### 9.2 Schéma Relationnel Complet

```sql
-- ============================================================
-- MODÈLE LOGIQUE DE DONNÉES - Pharmacie DIBAPHAR
-- ============================================================

-- TABLE 1 : PRODUIT
-- Extrait : "Chaque produit est identifié par un code simple"
-- ============================================================
PRODUIT (
    codeProduit         VARCHAR(10) PRIMARY KEY,
    nomGenerique        VARCHAR(100) NOT NULL,
    nomCommercial       VARCHAR(100) NOT NULL,
    categorie           VARCHAR(50) NOT NULL,
    prixAchatUnitaire   DECIMAL(10,2) NOT NULL CHECK (prixAchatUnitaire > 0),
    prixVenteUnitaire   DECIMAL(10,2) NOT NULL CHECK (prixVenteUnitaire > prixAchatUnitaire),
    conditionStockage   VARCHAR(200),
    seuilRapprovisionnement INT DEFAULT 10 CHECK (seuilRapprovisionnement >= 0),
    stockActuel         INT DEFAULT 0 CHECK (stockActuel >= 0)
)

INDEX idx_produit_categorie ON PRODUIT(categorie)
INDEX idx_produit_stock_faible ON PRODUIT(stockActuel) WHERE stockActuel <= seuilRapprovisionnement

-- TABLE 2 : FOURNISSEUR
-- Extrait : "fournisseur...grossiste pharmaceutique local ou représentant de laboratoire"
-- ============================================================
FOURNISSEUR (
    codeFournisseur     VARCHAR(10) PRIMARY KEY,
    nomFournisseur      VARCHAR(150) NOT NULL UNIQUE,
    typeFournisseur     VARCHAR(50) NOT NULL CHECK (typeFournisseur IN ('Grossiste pharmaceutique', 'Représentant laboratoire')),
    adresse             VARCHAR(250),
    telephone           VARCHAR(20),
    email               VARCHAR(100)
)

-- TABLE 3 : COMMANDE
-- Extrait : "passe une commande...Le fournisseur livre...facture"
-- ============================================================
COMMANDE (
    numeroCommande      VARCHAR(15) PRIMARY KEY,
    codeFournisseur     VARCHAR(10) NOT NULL,
    dateCommande        DATE NOT NULL DEFAULT CURRENT_DATE,
    dateLivraison       DATE CHECK (dateLivraison >= dateCommande),
    montantTotal        DECIMAL(12,2) DEFAULT 0 CHECK (montantTotal >= 0),
    modePaiement        VARCHAR(20) CHECK (modePaiement IN ('Espèces', 'Chèque', 'Carte bancaire')),
    statutCommande      VARCHAR(20) NOT NULL DEFAULT 'En attente' 
                        CHECK (statutCommande IN ('En attente', 'Livrée', 'Conforme', 'Non conforme', 'Retournée')),
    
    CONSTRAINT fk_commande_fournisseur 
        FOREIGN KEY (codeFournisseur) REFERENCES FOURNISSEUR(codeFournisseur)
        ON DELETE RESTRICT ON UPDATE CASCADE
)

INDEX idx_commande_fournisseur ON COMMANDE(codeFournisseur)
INDEX idx_commande_date ON COMMANDE(dateCommande DESC)
INDEX idx_commande_statut ON COMMANDE(statutCommande)

-- TABLE 4 : LIGNE_COMMANDE (relation COMPOSER_C)
-- Extrait : "La commande inclut le nom du produit, la quantité désirée"
-- ============================================================
LIGNE_COMMANDE (
    numeroCommande      VARCHAR(15),
    codeProduit         VARCHAR(10),
    quantiteCommandee   INT NOT NULL CHECK (quantiteCommandee > 0),
    prixAchatUnitaire   DECIMAL(10,2) NOT NULL CHECK (prixAchatUnitaire > 0),
    
    PRIMARY KEY (numeroCommande, codeProduit),
    
    CONSTRAINT fk_ligne_cmd_commande 
        FOREIGN KEY (numeroCommande) REFERENCES COMMANDE(numeroCommande)
        ON DELETE RESTRICT ON UPDATE CASCADE,
    CONSTRAINT fk_ligne_cmd_produit 
        FOREIGN KEY (codeProduit) REFERENCES PRODUIT(codeProduit)
        ON DELETE RESTRICT ON UPDATE CASCADE
)

INDEX idx_ligne_cmd_produit ON LIGNE_COMMANDE(codeProduit)

-- TABLE 5 : LOT_PRODUIT
-- Extrait : "date d'expiration...quantité livrée...enregistre l'entrée"
-- ============================================================
LOT_PRODUIT (
    numeroLot           VARCHAR(20) PRIMARY KEY,
    codeProduit         VARCHAR(10) NOT NULL,
    numeroCommande      VARCHAR(15) NOT NULL,
    quantiteRecue       INT NOT NULL CHECK (quantiteRecue > 0),
    dateReception       DATE NOT NULL DEFAULT CURRENT_DATE,
    dateExpiration      DATE NOT NULL CHECK (dateExpiration > dateReception),
    etatLot             VARCHAR(20) NOT NULL DEFAULT 'Actif' 
                        CHECK (etatLot IN ('Actif', 'Expiré', 'Endommagé', 'Retourné', 'Rappelé')),
    
    CONSTRAINT fk_lot_produit 
        FOREIGN KEY (codeProduit) REFERENCES PRODUIT(codeProduit)
        ON DELETE RESTRICT ON UPDATE CASCADE,
    CONSTRAINT fk_lot_commande 
        FOREIGN KEY (numeroCommande) REFERENCES COMMANDE(numeroCommande)
        ON DELETE RESTRICT ON UPDATE CASCADE
)

INDEX idx_lot_produit ON LOT_PRODUIT(codeProduit)
INDEX idx_lot_expiration ON LOT_PRODUIT(dateExpiration)
INDEX idx_lot_etat ON LOT_PRODUIT(etatLot)
INDEX idx_lot_expires ON LOT_PRODUIT(dateExpiration) WHERE dateExpiration < CURRENT_DATE AND etatLot = 'Actif'

-- TABLE 6 : VENTE
-- Extrait : "délivre un reçu manuel...indiquant la date, produits, quantités, prix, total"
-- ============================================================
VENTE (
    numeroVente         VARCHAR(15) PRIMARY KEY,
    dateVente           DATE NOT NULL DEFAULT CURRENT_DATE,
    heureVente          TIME NOT NULL DEFAULT CURRENT_TIME,
    montantTotal        DECIMAL(12,2) DEFAULT 0 CHECK (montantTotal >= 0),
    modePaiement        VARCHAR(20) NOT NULL CHECK (modePaiement IN ('Espèces', 'Chèque', 'Carte bancaire')),
    typeVente           VARCHAR(30) NOT NULL CHECK (typeVente IN ('Sur ordonnance', 'Libre-service')),
    nomClientApproximatif VARCHAR(100),
    numeroOrdonnance    VARCHAR(20),
    
    CONSTRAINT chk_vente_ordonnance 
        CHECK (typeVente = 'Libre-service' OR (typeVente = 'Sur ordonnance' AND numeroOrdonnance IS NOT NULL))
)

INDEX idx_vente_date ON VENTE(dateVente DESC)
INDEX idx_vente_type ON VENTE(typeVente)
INDEX idx_vente_ordonnance ON VENTE(numeroOrdonnance) WHERE numeroOrdonnance IS NOT NULL

-- TABLE 7 : LIGNE_VENTE (relation COMPOSER_V)
-- Extrait : "les produits vendus, les quantités, les prix unitaires"
-- ============================================================
LIGNE_VENTE (
    numeroVente         VARCHAR(15),
    codeProduit         VARCHAR(10),
    quantiteVendue      INT NOT NULL CHECK (quantiteVendue > 0),
    prixVenteUnitaire   DECIMAL(10,2) NOT NULL CHECK (prixVenteUnitaire > 0),
    
    PRIMARY KEY (numeroVente, codeProduit),
    
    CONSTRAINT fk_ligne_vente_vente 
        FOREIGN KEY (numeroVente) REFERENCES VENTE(numeroVente)
        ON DELETE RESTRICT ON UPDATE CASCADE,
    CONSTRAINT fk_ligne_vente_produit 
        FOREIGN KEY (codeProduit) REFERENCES PRODUIT(codeProduit)
        ON DELETE RESTRICT ON UPDATE CASCADE
)

INDEX idx_ligne_vente_produit ON LIGNE_VENTE(codeProduit)

-- TABLE 8 : MOUVEMENT_STOCK
-- Extrait : "met à jour son registre de stocks...note la sortie...comme une perte"
-- ============================================================
MOUVEMENT_STOCK (
    numeroMouvement     VARCHAR(15) PRIMARY KEY,
    codeProduit         VARCHAR(10) NOT NULL,
    numeroLot           VARCHAR(20),  -- Optionnel (NULL pour certains mouvements)
    numeroVente         VARCHAR(15),  -- Optionnel (NULL si non lié à vente)
    typeMouvement       VARCHAR(20) NOT NULL CHECK (typeMouvement IN ('Entrée', 'Sortie')),
    quantite            INT NOT NULL CHECK (quantite != 0),
    dateMouvement       DATE NOT NULL DEFAULT CURRENT_DATE,
    motif               VARCHAR(50) NOT NULL 
                        CHECK (motif IN ('Achat', 'Vente', 'Perte expiration', 'Retour client', 'Rappel lot', 'Dommage')),
    referenceDocument   VARCHAR(30) NOT NULL, -- RG12 : Obligation de référence
    
    CONSTRAINT fk_mvt_produit 
        FOREIGN KEY (codeProduit) REFERENCES PRODUIT(codeProduit)
        ON DELETE RESTRICT ON UPDATE CASCADE,
    CONSTRAINT fk_mvt_lot 
        FOREIGN KEY (numeroLot) REFERENCES LOT_PRODUIT(numeroLot)
        ON DELETE RESTRICT ON UPDATE CASCADE,
    CONSTRAINT fk_mvt_vente 
        FOREIGN KEY (numeroVente) REFERENCES VENTE(numeroVente)
        ON DELETE RESTRICT ON UPDATE CASCADE,
    
    -- Contrainte métier : Entrée = quantité positive, Sortie = quantité négative
    CONSTRAINT chk_mvt_coherence_quantite 
        CHECK ((typeMouvement = 'Entrée' AND quantite > 0) OR (typeMouvement = 'Sortie' AND quantite < 0))
)

INDEX idx_mvt_produit ON MOUVEMENT_STOCK(codeProduit)
INDEX idx_mvt_date ON MOUVEMENT_STOCK(dateMouvement DESC)
INDEX idx_mvt_type ON MOUVEMENT_STOCK(typeMouvement)
INDEX idx_mvt_lot ON MOUVEMENT_STOCK(numeroLot) WHERE numeroLot IS NOT NULL
INDEX idx_mvt_vente ON MOUVEMENT_STOCK(numeroVente) WHERE numeroVente IS NOT NULL
```

### 9.3 Dépendances Référentielles (Graphe)

```
FOURNISSEUR (1) ──────► COMMANDE (n)
                             │
                             │ (1)
                             ▼
                        LIGNE_COMMANDE (n) ◄────── PRODUIT (1)
                             │                         │
                             │                         │
                             ▼                         │
                        LOT_PRODUIT (n) ◄──────────────┘
                             │                         │
                             │                         │
                             ▼                         ▼
                    MOUVEMENT_STOCK (n) ◄───────┬─────┘
                             │                   │
                             │                   │
                             └───────┐           │
                                     ▼           ▼
                                   VENTE (1) ──► LIGNE_VENTE (n) ◄── PRODUIT (1)
```

### 9.4 Contraintes d'Intégrité Supplémentaires (Triggers)

**Trigger 1 : Mise à jour automatique du stock actuel**
```sql
-- Extrait : "met à jour son registre de stocks en soustrayant la quantité vendue"
CREATE TRIGGER trg_update_stock_after_mouvement
AFTER INSERT ON MOUVEMENT_STOCK
FOR EACH ROW
BEGIN
    UPDATE PRODUIT
    SET stockActuel = stockActuel + NEW.quantite
    WHERE codeProduit = NEW.codeProduit;
END;
```

**Trigger 2 : Calcul automatique du montant total commande**
```sql
-- Extrait : "le montant total"
CREATE TRIGGER trg_update_montant_commande
AFTER INSERT OR UPDATE OR DELETE ON LIGNE_COMMANDE
FOR EACH ROW
BEGIN
    UPDATE COMMANDE
    SET montantTotal = (
        SELECT COALESCE(SUM(quantiteCommandee * prixAchatUnitaire), 0)
        FROM LIGNE_COMMANDE
        WHERE numeroCommande = NEW.numeroCommande
    )
    WHERE numeroCommande = NEW.numeroCommande;
END;
```

**Trigger 3 : Calcul automatique du montant total vente**
```sql
-- Extrait : "le total payé"
CREATE TRIGGER trg_update_montant_vente
AFTER INSERT OR UPDATE OR DELETE ON LIGNE_VENTE
FOR EACH ROW
BEGIN
    UPDATE VENTE
    SET montantTotal = (
        SELECT COALESCE(SUM(quantiteVendue * prixVenteUnitaire), 0)
        FROM LIGNE_VENTE
        WHERE numeroVente = NEW.numeroVente
    )
    WHERE numeroVente = NEW.numeroVente;
END;
```

**Trigger 4 : Vérification stock suffisant avant vente**
```sql
-- Extrait : "vérifie la disponibilité"
CREATE TRIGGER trg_check_stock_before_vente
BEFORE INSERT ON LIGNE_VENTE
FOR EACH ROW
BEGIN
    DECLARE stock_disponible INT;
    
    SELECT stockActuel INTO stock_disponible
    FROM PRODUIT
    WHERE codeProduit = NEW.codeProduit;
    
    IF stock_disponible < NEW.quantiteVendue THEN
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Stock insuffisant pour effectuer cette vente';
    END IF;
END;
```

**Trigger 5 : Création automatique mouvement lors de réception lot**
```sql
-- Extrait : "Il enregistre l'entrée...en ajoutant la quantité reçue"
CREATE TRIGGER trg_create_mouvement_reception
AFTER INSERT ON LOT_PRODUIT
FOR EACH ROW
BEGIN
    INSERT INTO MOUVEMENT_STOCK (
        numeroMouvement, codeProduit, numeroLot, typeMouvement, 
        quantite, dateMouvement, motif, referenceDocument
    )
    VALUES (
        CONCAT('MVT', LPAD(NEXTVAL(seq_mouvement), 10, '0')),
        NEW.codeProduit,
        NEW.numeroLot,
        'Entrée',
        NEW.quantiteRecue,
        NEW.dateReception,
        'Achat',
        NEW.numeroCommande
    );
END;
```

**Trigger 6 : Création automatique mouvement lors de vente**
```sql
-- Extrait : "note...référence au reçu"
CREATE TRIGGER trg_create_mouvement_vente
AFTER INSERT ON LIGNE_VENTE
FOR EACH ROW
BEGIN
    INSERT INTO MOUVEMENT_STOCK (
        numeroMouvement, codeProduit, numeroVente, typeMouvement, 
        quantite, dateMouvement, motif, referenceDocument
    )
    VALUES (
        CONCAT('MVT', LPAD(NEXTVAL(seq_mouvement), 10, '0')),
        NEW.codeProduit,
        NEW.numeroVente,
        'Sortie',
        -NEW.quantiteVendue,  -- Négatif pour sortie
        CURRENT_DATE,
        'Vente',
        NEW.numeroVente
    );
END;
```

**Trigger 7 : Alerte stock faible**
```sql
-- Extrait : "Si un produit approche de la rupture...il passe une commande"
CREATE TRIGGER trg_alert_stock_faible
AFTER UPDATE ON PRODUIT
FOR EACH ROW
WHEN (NEW.stockActuel <= NEW.seuilRapprovisionnement 
      AND OLD.stockActuel > OLD.seuilRapprovisionnement)
BEGIN
    -- Insertion dans table d'alertes (à créer)
    INSERT INTO ALERTE_STOCK (codeProduit, dateAlerte, message)
    VALUES (
        NEW.codeProduit,
        CURRENT_DATE,
        CONCAT('Stock faible : ', NEW.stockActuel, ' unités restantes (seuil : ', NEW.seuilRapprovisionnement, ')')
    );
END;
```

### 9.5 Vues Métier Utiles

**Vue 1 : Stock disponible par produit avec alertes**
```sql
CREATE VIEW V_STOCK_DISPONIBLE AS
SELECT 
    p.codeProduit,
    p.nomGenerique,
    p.nomCommercial,
    p.categorie,
    p.stockActuel,
    p.seuilRapprovisionnement,
    CASE 
        WHEN p.stockActuel = 0 THEN 'RUPTURE'
        WHEN p.stockActuel <= p.seuilRapprovisionnement THEN 'ALERTE'
        ELSE 'OK'
    END AS statutStock,
    p.prixVenteUnitaire,
    p.conditionStockage
FROM PRODUIT p
ORDER BY 
    CASE 
        WHEN p.stockActuel = 0 THEN 1
        WHEN p.stockActuel <= p.seuilRapprovisionnement THEN 2
        ELSE 3
    END,
    p.categorie,
    p.nomGenerique;
```
**Extrait** : "vérifie les niveaux de stock...Si un produit approche de la rupture"

**Vue 2 : Produits expirés ou proches de l'expiration**
```sql
CREATE VIEW V_LOTS_A_VERIFIER AS
SELECT 
    l.numeroLot,
    p.codeProduit,
    p.nomGenerique,
    p.nomCommercial,
    l.quantiteRecue,
    l.dateExpiration,
    DATEDIFF(l.dateExpiration, CURRENT_DATE) AS joursRestants,
    l.etatLot,
    CASE 
        WHEN l.dateExpiration < CURRENT_DATE THEN 'EXPIRÉ - À RETIRER'
        WHEN DATEDIFF(l.dateExpiration, CURRENT_DATE) <= 30 THEN 'EXPIRE BIENTÔT'
        ELSE 'OK'
    END AS alerte
FROM LOT_PRODUIT l
JOIN PRODUIT p ON l.codeProduit = p.codeProduit
WHERE l.etatLot = 'Actif'
ORDER BY l.dateExpiration ASC;
```
**Extrait** : "Tous les mois, il effectue un inventaire...Si un produit est expiré"

**Vue 3 : Rapport mensuel des ventes**
```sql
CREATE VIEW V_RAPPORT_VENTES_MOIS AS
SELECT 
    DATE_FORMAT(v.dateVente, '%Y-%m') AS mois,
    p.categorie,
    p.codeProduit,
    p.nomGenerique,
    SUM(lv.quantiteVendue) AS quantiteTotale,
    SUM(lv.quantiteVendue * lv.prixVenteUnitaire) AS chiffreAffaires,
    COUNT(DISTINCT v.numeroVente) AS nombreVentes
FROM VENTE v
JOIN LIGNE_VENTE lv ON v.numeroVente = lv.numeroVente
JOIN PRODUIT p ON lv.codeProduit = p.codeProduit
WHERE v.dateVente >= DATE_SUB(CURRENT_DATE, INTERVAL 12 MONTH)
GROUP BY DATE_FORMAT(v.dateVente, '%Y-%m'), p.categorie, p.codeProduit, p.nomGenerique
ORDER BY mois DESC, chiffreAffaires DESC;
```
**Extrait** : "maintient un registre séparé pour les rapports mensuels...compile les totaux"

**Vue 4 : Historique complet des mouvements par produit**
```sql
CREATE VIEW V_HISTORIQUE_MOUVEMENTS AS
SELECT 
    m.numeroMouvement,
    m.dateMouvement,
    p.codeProduit,
    p.nomGenerique,
    m.typeMouvement,
    m.motif,
    m.quantite,
    m.referenceDocument,
    l.numeroLot,
    l.dateExpiration,
    v.numeroVente,
    v.typeVente
FROM MOUVEMENT_STOCK m
JOIN PRODUIT p ON m.codeProduit = p.codeProduit
LEFT JOIN LOT_PRODUIT l ON m.numeroLot = l.numeroLot
LEFT JOIN VENTE v ON m.numeroVente = v.numeroVente
ORDER BY m.dateMouvement DESC, m.numeroMouvement DESC;
```
**Extrait** : "registre de stocks...journal de tous les événements"

**Vue 5 : Performance fournisseurs**
```sql
CREATE VIEW V_PERFORMANCE_FOURNISSEURS AS
SELECT 
    f.codeFournisseur,
    f.nomFournisseur,
    f.typeFournisseur,
    COUNT(DISTINCT c.numeroCommande) AS nombreCommandes,
    SUM(c.montantTotal) AS montantTotalAchats,
    AVG(DATEDIFF(c.dateLivraison, c.dateCommande)) AS delaiMoyenLivraison,
    SUM(CASE WHEN c.statutCommande = 'Non conforme' OR c.statutCommande = 'Retournée' THEN 1 ELSE 0 END) AS commandesProblematiques,
    MAX(c.dateCommande) AS derniereCommande
FROM FOURNISSEUR f
LEFT JOIN COMMANDE c ON f.codeFournisseur = c.codeFournisseur
GROUP BY f.codeFournisseur, f.nomFournisseur, f.typeFournisseur
ORDER BY montantTotalAchats DESC;
```
**Extrait** : "généralement dans les 48 heures...inspecte la livraison pour vérifier la conformité"

## 10. MODÈLE PHYSIQUE DE DONNÉES (MPD)

### 10.1 Choix Technologiques

**Système de Gestion de Base de Données : MySQL 8.0 / MariaDB 10.6**

**Justification** :
- Open source, gratuit pour usage commercial
- Adapté aux petites structures (faible coût)
- Compatible avec archivage manuel actuel
- Facilite migration progressive depuis registres papier
- Performance suffisante pour volumétrie pharmacie (estimé : < 100 000 lignes/an toutes tables confondues)

**Extrait de l'énoncé** : "petite structure familiale...opérations quotidiennes de manière manuelle, sans recours à des systèmes informatisés"

### 10.2 Scripts SQL de Création (Production-Ready)

```sql
-- ============================================================
-- MODÈLE PHYSIQUE DE DONNÉES - Pharmacie DIBAPHAR
-- SGBD : MySQL 8.0 / MariaDB 10.6
-- Encodage : UTF8MB4 (support caractères spéciaux)
-- Moteur : InnoDB (transactions ACID)
-- ============================================================

-- Configuration base de données
CREATE DATABASE IF NOT EXISTS dibaphar_db
CHARACTER SET utf8mb4
COLLATE utf8mb4_unicode_ci;

USE dibaphar_db;

-- Configuration moteur transactionnel
SET default_storage_engine = InnoDB;
SET FOREIGN_KEY_CHECKS = 1;

-- ============================================================
-- SÉQUENCES / AUTO-INCREMENT
-- ============================================================
CREATE SEQUENCE seq_mouvement START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE seq_vente START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE seq_commande START WITH 1 INCREMENT BY 1;

-- ============================================================
-- TABLE 1 : PRODUIT
-- ============================================================
CREATE TABLE PRODUIT (
    codeProduit VARCHAR(10) NOT NULL,
    nomGenerique VARCHAR(100) NOT NULL,
    nomCommercial VARCHAR(100) NOT NULL,
    categorie VARCHAR(50) NOT NULL,
    prixAchatUnitaire DECIMAL(10,2) NOT NULL,
    prixVenteUnitaire DECIMAL(10,2) NOT NULL,
    conditionStockage VARCHAR(200),
    seuilRapprovisionnement INT NOT NULL DEFAULT 10,
    stockActuel INT NOT NULL DEFAULT 0,
    dateCreation TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    dateModification TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    PRIMARY KEY (codeProduit),
    
    CONSTRAINT chk_prix_achat_positif CHECK (prixAchatUnitaire > 0),
    CONSTRAINT chk_prix_vente_positif CHECK (prixVenteUnitaire > 0),
    CONSTRAINT chk_marge_beneficiaire CHECK (prixVenteUnitaire > prixAchatUnitaire),
    CONSTRAINT chk_seuil_positif CHECK (seuilRapprovisionnement >= 0),
    CONSTRAINT chk_stock_positif CHECK (stockActuel >= 0)
) ENGINE=InnoDB
  DEFAULT CHARSET=utf8mb4
  COLLATE=utf8mb4_unicode_ci
  COMMENT='Table des produits pharmaceutiques';

-- Index de performance
CREATE INDEX idx_produit_categorie ON PRODUIT(categorie);
CREATE INDEX idx_produit_stock_faible ON PRODUIT(stockActuel, seuilRapprovisionnement);
CREATE INDEX idx_produit_nom_generique ON PRODUIT(nomGenerique);

-- ============================================================
-- TABLE 2 : FOURNISSEUR
-- ============================================================
CREATE TABLE FOURNISSEUR (
    codeFournisseur VARCHAR(10) NOT NULL,
    nomFournisseur VARCHAR(150) NOT NULL,
    typeFournisseur VARCHAR(50) NOT NULL,
    adresse VARCHAR(250),
    telephone VARCHAR(20),
    email VARCHAR(100),
    actif BOOLEAN NOT NULL DEFAULT TRUE,
    dateCreation TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    dateModification TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    PRIMARY KEY (codeFournisseur),
    
    CONSTRAINT unq_nom_fournisseur UNIQUE (nomFournisseur),
    CONSTRAINT chk_type_fournisseur CHECK (typeFournisseur IN ('Grossiste pharmaceutique', 'Représentant laboratoire'))
) ENGINE=InnoDB
  DEFAULT CHARSET=utf8mb4
  COLLATE=utf8mb4_unicode_ci
  COMMENT='Table des fournisseurs pharmaceutiques';

CREATE INDEX idx_fournisseur_actif ON FOURNISSEUR(actif);

-- ============================================================
-- TABLE 3 : COMMANDE
-- ============================================================
CREATE TABLE COMMANDE (
    numeroCommande VARCHAR(15) NOT NULL,
    codeFournisseur VARCHAR(10) NOT NULL,
    dateCommande DATE NOT NULL,
    dateLivraison DATE,
    montantTotal DECIMAL(12,2) NOT NULL DEFAULT 0,
    modePaiement VARCHAR(20),
    statutCommande VARCHAR(20) NOT NULL DEFAULT 'En attente',
    dateCreation TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    dateModification TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    PRIMARY KEY (numeroCommande),
    
    CONSTRAINT fk_commande_fournisseur 
        FOREIGN KEY (codeFournisseur) 
        REFERENCES FOURNISSEUR(codeFournisseur)
        ON DELETE RESTRICT
        ON UPDATE CASCADE,
    
    CONSTRAINT chk_date_livraison CHECK (dateLivraison IS NULL OR dateLivraison >= dateCommande),
    CONSTRAINT chk_montant_commande CHECK (montantTotal >= 0),
    CONSTRAINT chk_mode_paiement_cmd CHECK (modePaiement IN ('Espèces', 'Chèque', 'Carte bancaire')),
    CONSTRAINT chk_statut_commande CHECK (statutCommande IN ('En attente', 'Livrée', 'Conforme', 'Non conforme', 'Retournée'))
) ENGINE=InnoDB
  DEFAULT CHARSET=utf8mb4
  COLLATE=utf8mb4_unicode_ci
  COMMENT='Table des commandes passées aux fournisseurs';

CREATE INDEX idx_commande_fournisseur ON COMMANDE(codeFournisseur);
CREATE INDEX idx_commande_date ON COMMANDE(dateCommande DESC);
CREATE INDEX idx_commande_statut ON COMMANDE(statutCommande);

-- ============================================================
-- TABLE 4 : LIGNE_COMMANDE
-- ============================================================
CREATE TABLE LIGNE_COMMANDE (
    numeroCommande VARCHAR(15) NOT NULL,
    codeProduit VARCHAR(10) NOT NULL,
    quantiteCommandee INT NOT NULL,
    prixAchatUnitaire DECIMAL(10,2) NOT NULL,
    dateCreation TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    PRIMARY KEY (numeroCommande, codeProduit),
    
    CONSTRAINT fk_ligne_cmd_commande 
        FOREIGN KEY (numeroCommande) 
        REFERENCES COMMANDE(numeroCommande)
        ON DELETE RESTRICT
        ON UPDATE CASCADE,
    
    CONSTRAINT fk_ligne_cmd_produit 
        FOREIGN KEY (codeProduit) 
        REFERENCES PRODUIT(codeProduit)
        ON DELETE RESTRICT
        ON UPDATE CASCADE,
    
    CONSTRAINT chk_qte_commandee CHECK (quantiteCommandee > 0),
    CONSTRAINT chk_prix_achat_ligne CHECK (prixAchatUnitaire > 0)
) ENGINE=InnoDB
  DEFAULT CHARSET=utf8mb4
  COLLATE=utf8mb4_unicode_ci
  COMMENT='Détail des produits dans chaque commande';

CREATE INDEX idx_ligne_cmd_produit ON LIGNE_COMMANDE(codeProduit);

-- ============================================================
-- TABLE 5 : LOT_PRODUIT
-- ============================================================
CREATE TABLE LOT_PRODUIT (
    numeroLot VARCHAR(20) NOT NULL,
    codeProduit VARCHAR(10) NOT NULL,
    numeroCommande VARCHAR(15) NOT NULL,
    quantiteRecue INT NOT NULL,
    dateReception DATE NOT NULL,
    dateExpiration DATE NOT NULL,
    etatLot VARCHAR(20) NOT NULL DEFAULT 'Actif',
    dateCreation TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    dateModification TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    PRIMARY KEY (numeroLot),
    
    CONSTRAINT fk_lot_produit 
        FOREIGN KEY (codeProduit) 
        REFERENCES PRODUIT(codeProduit)
        ON DELETE RESTRICT
        ON UPDATE CASCADE,
    
    CONSTRAINT fk_lot_commande 
        FOREIGN KEY (numeroCommande) 
        REFERENCES COMMANDE(numeroCommande)
        ON DELETE RESTRICT
        ON UPDATE CASCADE,
    
    CONSTRAINT chk_qte_recue CHECK (quantiteRecue > 0),
    CONSTRAINT chk_date_expiration CHECK (dateExpiration > dateReception),
    CONSTRAINT chk_etat_lot CHECK (etatLot IN ('Actif', 'Expiré', 'Endommagé', 'Retourné', 'Rappelé'))
) ENGINE=InnoDB
  DEFAULT CHARSET=utf8mb4
  COLLATE=utf8mb4_unicode_ci
  COMMENT='Lots de produits reçus avec dates d''expiration';

CREATE INDEX idx_lot_produit ON LOT_PRODUIT(codeProduit);
CREATE INDEX idx_lot_expiration ON LOT_PRODUIT(dateExpiration);
CREATE INDEX idx_lot_etat ON LOT_PRODUIT(etatLot);
CREATE INDEX idx_lot_commande ON LOT_PRODUIT(numeroCommande);

-- ============================================================
-- TABLE 6 : VENTE
-- ============================================================
CREATE TABLE VENTE (
    numeroVente VARCHAR(15) NOT NULL,
    dateVente DATE NOT NULL,
    heureVente TIME NOT NULL,
    montantTotal DECIMAL(12,2) NOT NULL DEFAULT 0,
    modePaiement VARCHAR(20) NOT NULL,
    typeVente VARCHAR(30) NOT NULL,
    nomClientApproximatif VARCHAR(100),
    numeroOrdonnance VARCHAR(20),
    dateCreation TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    PRIMARY KEY (numeroVente),
    
    CONSTRAINT chk_montant_vente CHECK (montantTotal >= 0),
    CONSTRAINT chk_mode_paiement_vente CHECK (modePaiement IN ('Espèces', 'Chèque', 'Carte bancaire')),
    CONSTRAINT chk_type_vente CHECK (typeVente IN ('Sur ordonnance', 'Libre-service')),
    CONSTRAINT chk_vente_ordonnance CHECK (
        typeVente = 'Libre-service' OR 
        (typeVente = 'Sur ordonnance' AND numeroOrdonnance IS NOT NULL AND nomClientApproximatif IS NOT NULL)
    )
) ENGINE=InnoDB
  DEFAULT CHARSET=utf8mb4
  COLLATE=utf8mb4_unicode_ci
  COMMENT='Transactions de vente aux clients';

CREATE INDEX idx_vente_date ON VENTE(dateVente DESC);
CREATE INDEX idx_vente_type ON VENTE(typeVente);
CREATE INDEX idx_vente_ordonnance ON VENTE(numeroOrdonnance);

-- ============================================================
-- TABLE 7 : LIGNE_VENTE
-- ============================================================
CREATE TABLE LIGNE_VENTE (
    numeroVente VARCHAR(15) NOT NULL,
    codeProduit VARCHAR(10) NOT NULL,
    quantiteVendue INT NOT NULL,
    prixVenteUnitaire DECIMAL(10,2) NOT NULL,
    dateCreation TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    PRIMARY KEY (numeroVente, codeProduit),
    
    CONSTRAINT fk_ligne_vente_vente 
        FOREIGN KEY (numeroVente) 
        REFERENCES VENTE(numeroVente)
        ON DELETE RESTRICT
        ON UPDATE CASCADE,
    
    CONSTRAINT fk_ligne_vente_produit 
        FOREIGN KEY (codeProduit) 
        REFERENCES PRODUIT(codeProduit)
        ON DELETE RESTRICT
        ON UPDATE CASCADE,
    
    CONSTRAINT chk_qte_vendue CHECK (quantiteVendue > 0),
    CONSTRAINT chk_prix_vente_ligne CHECK (prixVenteUnitaire > 0)
) ENGINE=InnoDB
  DEFAULT CHARSET=utf8mb4
  COLLATE=utf8mb4_unicode_ci
  COMMENT='Détail des produits vendus dans chaque transaction';

CREATE INDEX idx_ligne_vente_produit ON LIGNE_VENTE(codeProduit);

-- ============================================================
-- TABLE 8 : MOUVEMENT_STOCK
-- ============================================================
CREATE TABLE MOUVEMENT_STOCK (
    numeroMouvement VARCHAR(15) NOT NULL,
    codeProduit VARCHAR(10) NOT NULL,
    numeroLot VARCHAR(20),
    numeroVente VARCHAR(15),
    typeMouvement VARCHAR(20) NOT NULL,
    quantite INT NOT NULL,
    dateMouvement DATE NOT NULL,
    motif VARCHAR(50) NOT NULL,
    referenceDocument VARCHAR(30) NOT NULL,
    dateCreation TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    PRIMARY KEY (numeroMouvement),
    
    CONSTRAINT fk_mvt_produit 
        FOREIGN KEY (codeProduit) 
        REFERENCES PRODUIT(codeProduit)
        ON DELETE RESTRICT
        ON UPDATE CASCADE,
    
    CONSTRAINT fk_mvt_lot 
        FOREIGN KEY (numeroLot) 
        REFERENCES LOT_PRODUIT(numeroLot)
        ON DELETE RESTRICT
        ON UPDATE CASCADE,
    
    CONSTRAINT fk_mvt_vente 
        FOREIGN KEY (numeroVente) 
        REFERENCES VENTE(numeroVente)
        ON DELETE RESTRICT
        ON UPDATE CASCADE,
    
    CONSTRAINT chk_type_mvt CHECK (typeMouvement IN ('Entrée', 'Sortie')),
    CONSTRAINT chk_qte_mvt CHECK (quantite != 0),
    CONSTRAINT chk_motif_mvt CHECK (motif IN ('Achat', 'Vente', 'Perte expiration', 'Retour client', 'Rappel lot', 'Dommage')),
    CONSTRAINT chk_mvt_coherence CHECK (
        (typeMouvement = 'Entrée' AND quantite > 0) OR 
        (typeMouvement = 'Sortie' AND quantite < 0)
    )
) ENGINE=InnoDB
  DEFAULT CHARSET=utf8mb4
  COLLATE=utf8mb4_unicode_ci
  COMMENT='Journal de tous les mouvements de stock (traçabilité complète)';

CREATE INDEX idx_mvt_produit ON MOUVEMENT_STOCK(codeProduit);
CREATE INDEX idx_mvt_date ON MOUVEMENT_STOCK(dateMouvement DESC);
CREATE INDEX idx_mvt_type ON MOUVEMENT_STOCK(typeMouvement);
CREATE INDEX idx_mvt_lot ON MOUVEMENT_STOCK(numeroLot);
CREATE INDEX idx_mvt_vente ON MOUVEMENT_STOCK(numeroVente);
CREATE INDEX idx_mvt_reference ON MOUVEMENT_STOCK(referenceDocument);

-- ============================================================
-- TABLE 9 : ALERTE_STOCK (table technique)
-- ============================================================
CREATE TABLE ALERTE_STOCK (
    idAlerte INT NOT NULL AUTO_INCREMENT,
    codeProduit VARCHAR(10) NOT NULL,
    dateAlerte DATE NOT NULL,
    message VARCHAR(255) NOT NULL,
    traitee BOOLEAN NOT NULL DEFAULT FALSE,
    dateTraitement TIMESTAMP NULL,
    dateCreation TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    PRIMARY KEY (idAlerte),
    
    CONSTRAINT fk_alerte_produit 
        FOREIGN KEY (codeProduit) 
        REFERENCES PRODUIT(codeProduit)
        ON DELETE CASCADE
        ON UPDATE CASCADE
) ENGINE=InnoDB
  DEFAULT CHARSET=utf8mb4
  COLLATE=utf8mb4_unicode_ci
  COMMENT='Alertes automatiques pour stocks faibles';

CREATE INDEX idx_alerte_produit ON ALERTE_STOCK(codeProduit);
CREATE INDEX idx_alerte_date ON ALERTE_STOCK(dateAlerte DESC);
CREATE INDEX idx_alerte_traitee ON ALERTE_STOCK(traitee);

-- ============================================================
-- TRIGGERS
-- ============================================================

-- Trigger 1 : Mise à jour automatique du stock
DELIMITER //
CREATE TRIGGER trg_update_stock_after_mouvement
AFTER INSERT ON MOUVEMENT_STOCK
FOR EACH ROW
BEGIN
    UPDATE PRODUIT
    SET stockActuel = stockActuel + NEW.quantite,
        dateModification = CURRENT_TIMESTAMP
    WHERE codeProduit = NEW.codeProduit;
END//
DELIMITER ;

-- Trigger 2 : Calcul montant total commande
DELIMITER //
CREATE TRIGGER trg_update_montant_commande_insert
AFTER INSERT ON LIGNE_COMMANDE
FOR EACH ROW
BEGIN
    UPDATE COMMANDE
    SET montantTotal = (
        SELECT COALESCE(SUM(quantiteCommandee * prixAchatUnitaire), 0)
        FROM LIGNE_COMMANDE
        WHERE numeroCommande = NEW.numeroCommande
    ),
    dateModification = CURRENT_TIMESTAMP
    WHERE numeroCommande = NEW.numeroCommande;
END//
DELIMITER ;

-- Trigger 3 : Calcul montant total vente
DELIMITER //
CREATE TRIGGER trg_update_montant_vente_insert
AFTER INSERT ON LIGNE_VENTE
FOR EACH ROW
BEGIN
    UPDATE VENTE
    SET montantTotal = (
        SELECT COALESCE(SUM(quantiteVendue * prixVenteUnitaire), 0)
        FROM LIGNE_VENTE
        WHERE numeroVente = NEW.numeroVente
    )
    WHERE numeroVente = NEW.numeroVente;
END//
DELIMITER ;

-- Trigger 4 : Vérification stock suffisant avant vente
DELIMITER //
CREATE TRIGGER trg_check_stock_before_vente
BEFORE INSERT ON LIGNE_VENTE
FOR EACH ROW
BEGIN
    DECLARE stock_disponible INT;
    
    SELECT stockActuel INTO stock_disponible
    FROM PRODUIT
    WHERE codeProduit = NEW.codeProduit;
    
    IF stock_disponible < NEW.quantiteVendue THEN
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Stock insuffisant pour effectuer cette vente';
    END IF;
END//
DELIMITER ;

-- Trigger 5 : Création automatique mouvement lors de réception lot
DELIMITER //
CREATE TRIGGER trg_create_mouvement_reception
AFTER INSERT ON LOT_PRODUIT
FOR EACH ROW
BEGIN
    INSERT INTO MOUVEMENT_STOCK (
        numeroMouvement, codeProduit, numeroLot, typeMouvement, 
        quantite, dateMouvement, motif, referenceDocument
    )
    VALUES (
        CONCAT('MVT', LPAD(NEXTVAL(seq_mouvement), 10, '0')),
        NEW.codeProduit,
        NEW.numeroLot,
        'Entrée',
        NEW.quantiteRecue,
        NEW.dateReception,
        'Achat',
        NEW.numeroCommande
    );
END//
DELIMITER ;

-- Trigger 6 : Création automatique mouvement lors de vente
DELIMITER //
CREATE TRIGGER trg_create_mouvement_vente
AFTER INSERT ON LIGNE_VENTE
FOR EACH ROW
BEGIN
    DECLARE num_mvt VARCHAR(15);
    DECLARE date_vte DATE;
    
    SELECT dateVente INTO date_vte
    FROM VENTE
    WHERE numeroVente = NEW.numeroVente;
    
    SET num_mvt = CONCAT('MVT', LPAD(NEXTVAL(seq_mouvement), 10, '0'));
    
    INSERT INTO MOUVEMENT_STOCK (
        numeroMouvement, codeProduit, numeroVente, typeMouvement, 
        quantite, dateMouvement, motif, referenceDocument
    )
    VALUES (
        num_mvt,
        NEW.codeProduit,
        NEW.numeroVente,
        'Sortie',
        -NEW.quantiteVendue,
        date_vte,
  
</div>

<!-- MCD -->
<!-- d7ykht18xb@zudpck.com -->
<prompt>
  Identifie :
Les entités, leurs propriétés/attributs, identifiant , relations, la cardinalité, les règles de gestion

Réalise :
le graphe de dépendances fonctionnelles et le dictionnaire des données 

Pour le dictionnaire des données voici les éléments , on a :
- Nom de la donnée 
- Format 
- longueur 
- Type ( Élémentaire | Calculée)
- Règle de calcul 
- Règle de gestion 
- Document

Les identifiants des on les identifient dans le dictionnaire avec le symbole * au début.
Nom de la donnée = attributs/propriétés/identifiant d'une entité 


C'est pour un MCD 

Faut toujours tout démontrer, des trucs comme la normalisation, la fusion,... Pour dire pourquoi on a cet aspect et non l'autre, pour s'expliquer sur le Pourquoi on a que 4 entités au lieu de 8, pour dire pourquoi on a ça ou ça au lieu de ça,... 

Dans chaque entité faut toujours mettre ses propriétés complets même si elles ne sont pas tous cités 

Pour :
- chaque entité déclaré tu dois montré l'extrait de la partie de l'énoncé qui permet cela 
- de même pours leurs propriétés, attributs 
- de même pour les relations,
- de même pour la cardinalité 

NB: Concernant les relations faut utiliser des verbes à l'infinitif qui qui s'applique de façon bidirectionnelle ou dans tous les sens utilisant ce même verbe 
Ça garantie la cohérence 

Il faut que ça soit tellement cohérent suivant l'énoncé à tel que nul ni personne pourrait contredire ça 

Tout doit avoir un extrait de l'énoncé mais sachant que ça peut toujours être explicite ou implicite 

Les extraits nous aides à ne peut pas nous permet, il nous permet de nous localiser, d'avoir une meilleure compréhension 

Tu peux réaliser un tableau pour les identifications des entités, propriétés/attributs, relations/cardinalités, règles de gestion, chacun avec une zone extrait de l'énoncé pour comprendre et tu peux ajouter d'autres éléments nécessaires 

N'oublie pas : Dans chaque entité faut toujours mettre ses propriétés complets même si elles sont implicite ou explicite 

Car on a besoin des propriétés, une entité ou une table ne doit pas seulement être créer pour avoir une seule propriété ou  champ

Fait en sorte qu'en lisant le MCD ça nous donne presque les mêmes chemins que quand on avait lu l'énoncé 

Tout ça c'était pour le MCD 
Tu ferras le MOD (celui qui parle de responsabilité pour chaque poste : ajouter , modifier, supprimer, consulter,...etc) et le MLD en se basant sur le MCD qui a été construite

Voici l'énoncé :


  ### Étude de Cas : Gestion des Stocks dans la Pharmacie DIBAPHAR

La pharmacie DIBAPHAR est une petite structure familiale gérée exclusivement par M. Dibaphar, un pharmacien expérimenté qui s'occupe de l'ensemble des opérations quotidiennes de manière manuelle, sans recours à des systèmes informatisés. Située dans un quartier résidentiel animé, elle propose une gamme variée de médicaments, de produits parapharmaceutiques et d'articles de soins de santé essentiels, comme des antidouleurs, des antibiotiques, des vitamines, des crèmes dermatologiques et des accessoires médicaux tels que des thermomètres ou des bandages. M. Dibaphar, souvent appelé affectueusement "PAPA DIBAPHAR" par les habitués, gère seul les achats, les ventes, le contrôle des stocks, les interactions avec les clients et les fournisseurs, ainsi que les tâches administratives basiques. La pharmacie opère du lundi au samedi de 8 heures du matin à 20 heures du soir, avec une pause déjeuner de 13 heures à 14 heures, et reste fermée les dimanches et jours fériés, sauf en cas d'urgence où M. Dibaphar peut ouvrir exceptionnellement sur appel téléphonique.

Les stocks sont maintenus dans un espace de rangement sécurisé à l'arrière de la pharmacie, organisé en étagères étiquetées par catégories de produits : médicaments sur ordonnance, produits en vente libre, articles périssables nécessitant une réfrigération (comme certains vaccins ou insulines), et produits non périssables. Chaque produit est identifié par un code simple que M. Dibaphar attribue manuellement, composé d'une lettre pour la catégorie (par exemple, "A" pour antidouleurs) suivie d'un numéro séquentiel (comme A001 pour le paracétamol). Pour chaque produit, il note dans un registre dédié les informations essentielles : le nom générique et commercial, le fournisseur d'origine, la date d'achat, la date d'expiration, le prix d'achat unitaire, le prix de vente unitaire, la quantité initiale reçue, et des remarques sur les conditions de stockage (comme "conserver au frais" ou "protéger de la lumière"). Ces registres sont des cahiers à pages numérotées, conservés dans un tiroir verrouillé pour éviter les erreurs ou les pertes.

Le processus d'achat commence lorsque M. Dibaphar identifie un besoin de réapprovisionnement, généralement en consultant son registre de stocks le soir après la fermeture ou le matin avant l'ouverture. Il vérifie les niveaux de stock en comptant physiquement les unités restantes sur les étagères et compare avec les entrées notées. Si un produit approche de la rupture (par exemple, moins de 10 unités pour les articles populaires), il passe une commande verbale ou écrite auprès d'un fournisseur, qui est typiquement un grossiste pharmaceutique local ou un représentant de laboratoire. La commande inclut le nom du produit, la quantité désirée (souvent en boîtes ou en lots de 50 à 100 unités), et une demande de facture. Le fournisseur livre les produits directement à la pharmacie, généralement dans les 48 heures, accompagnés d'une facture détaillant le nom du produit, la quantité livrée, le prix unitaire, le montant total, et la date de livraison. M. Dibaphar inspecte la livraison pour vérifier la conformité (quantité, état, dates d'expiration), signe la facture comme accusé de réception, et paie comptant ou par chèque sur place. Il enregistre ensuite l'entrée dans son registre de stocks en ajoutant la quantité reçue à la ligne correspondante du produit, notant la date de l'entrée, le numéro de la facture, et met à jour le stock total. Si un produit est endommagé ou non conforme, il le retourne immédiatement au fournisseur, qui émet un avoir, et M. Dibaphar note cette sortie comme une correction dans le registre sans impact sur les ventes.

Les ventes constituent le cœur de l'activité et modifient directement les stocks. Un client entre librement dans la pharmacie pendant les heures d'ouverture, parcourt les étagères des produits en vente libre ou demande conseil à M. Dibaphar pour des médicaments sur ordonnance. Pour une vente typique, le client présente une ordonnance médicale si nécessaire (émise par un médecin, avec des détails comme le nom du patient, le nom du médicament, la posologie et la durée du traitement), ou décrit simplement ses symptômes pour des produits en libre-service. M. Dibaphar écoute les besoins, vérifie la disponibilité en consultant rapidement son registre ou en regardant les étagères, et conseille sur l'utilisation appropriée, les contre-indications et les alternatives si le produit exact n'est pas en stock. Il sélectionne ensuite les articles demandés, les place sur le comptoir, et calcule le montant total en multipliant la quantité par le prix de vente unitaire, en ajoutant éventuellement une petite marge pour les services de conseil. Le client paie en espèces, par carte bancaire via un terminal portable, ou exceptionnellement par chèque pour les clients réguliers. M. Dibaphar délivre un reçu manuel écrit à la main sur un bloc-notes carbone, indiquant la date, les produits vendus, les quantités, les prix unitaires, le total payé, et son tampon de pharmacie. Une fois le paiement effectué et le reçu remis, la vente est clôturée : le client quitte la pharmacie avec les produits emballés. Immédiatement après, M. Dibaphar met à jour son registre de stocks en soustrayant la quantité vendue de la ligne du produit concerné, notant la date de sortie, une référence au reçu (comme un numéro séquentiel), et le nom approximatif du client pour les ordonnances (sans détails personnels exhaustifs pour respecter la confidentialité). Pour les produits sur ordonnance, il conserve une copie de l'ordonnance dans un dossier séparé pour des fins de traçabilité réglementaire.

Les sorties de stock ne se limitent pas aux ventes ; M. Dibaphar gère également les pertes dues à l'expiration ou aux dommages. Tous les mois, il effectue un inventaire manuel en comptant physiquement tous les produits et en comparant avec le registre. Si un produit est expiré (par exemple, un lot d'antibiotiques dont la date d'expiration est dépassée), il le retire des étagères, le place dans une zone de déchets médicaux sécurisée, et note la sortie dans le registre comme une perte, avec la quantité, la date et la raison. Ces déchets sont ensuite collectés par un service spécialisé de ramassage des déchets pharmaceutiques, qui fournit un certificat de destruction que M. Dibaphar archive. De même, pour les retours de clients (rares, mais possibles pour des produits non ouverts en cas d'erreur), il inspecte l'article, rembourse si approprié, et réintègre la quantité au stock en notant l'entrée de retour dans le registre.

Les interactions avec les fournisseurs ne se limitent pas aux achats ; ils fournissent occasionnellement des informations sur de nouveaux produits ou des rappels de lots défectueux via des courriers ou des visites. Dans ce cas, M. Dibaphar retire immédiatement les lots concernés du stock, les retourne au fournisseur pour un remboursement, et note la sortie comme un rappel dans le registre. Pour les clients, bien que la plupart des interactions soient directes et anonymes, les habitués peuvent passer des commandes par téléphone pour des produits spécifiques, que M. Dibaphar prépare à l'avance et met de côté, mais la vente n'est finalisée qu'à l'arrivée du client avec paiement et mise à jour du stock.

Enfin, M. Dibaphar maintient un registre séparé pour les rapports mensuels, où il compile les totaux d'entrées (achats), de sorties (ventes, pertes, retours), et les stocks finaux pour évaluer la rentabilité et anticiper les besoins futurs. Ce registre inclut des calculs manuels simples, comme le chiffre d'affaires par produit ou les marges bénéficiaires, basés sur les prix d'achat et de vente. Toute la documentation est archivée chronologiquement dans des classeurs pour d'éventuels contrôles par les autorités sanitaires, qui visitent périodiquement la pharmacie pour vérifier la conformité des stocks et des enregistrements.

Travail à faire : Construire les MCD, MOD, MLD de l’énoncé ci-dessus.
</prompt>
<div>
  # ANALYSE COMPLÈTE - GESTION DES STOCKS PHARMACIE DIBAPHAR

## PHASE 1 : IDENTIFICATION ET JUSTIFICATION

### 1.1 TABLEAU D'IDENTIFICATION DES ENTITÉS

| **ENTITÉ** | **EXTRAIT DE L'ÉNONCÉ (JUSTIFICATION)** | **PROPRIÉTÉS IDENTIFIÉES** | **JUSTIFICATION DES PROPRIÉTÉS** |
|------------|----------------------------------------|---------------------------|----------------------------------|
| **PRODUIT** | "Chaque produit est identifié par un code simple... composé d'une lettre pour la catégorie suivie d'un numéro séquentiel (comme A001 pour le paracétamol)" | *codeProduit, nomGenerique, nomCommercial, categorie, prixAchat, prixVente, conditionStockage, seuilRupture | - Code : "code simple que M. Dibaphar attribue manuellement"<br>- Noms : "le nom générique et commercial"<br>- Prix : "le prix d'achat unitaire, le prix de vente unitaire"<br>- Condition : "des remarques sur les conditions de stockage (comme 'conserver au frais')" |
| **FOURNISSEUR** | "il passe une commande verbale ou écrite auprès d'un fournisseur, qui est typiquement un grossiste pharmaceutique local ou un représentant de laboratoire" | *codeFournisseur, nomFournisseur, typeFournisseur, adresse, telephone, email | - Identité explicite : "un fournisseur, qui est typiquement un grossiste pharmaceutique local"<br>- Contact implicite : pour "passer une commande verbale ou écrite" nécessite des coordonnées |
| **MOUVEMENT_STOCK** | "Il enregistre ensuite l'entrée dans son registre de stocks en ajoutant la quantité reçue... notant la date de l'entrée, le numéro de la facture" + "met à jour son registre de stocks en soustrayant la quantité vendue... notant la date de sortie" | *numeroMouvement, dateMouvement, typeMouvement, quantite, prixUnitaire, montantTotal, motif, numeroReference | - Numéro : identifiant unique implicite pour traçabilité<br>- Date : "notant la date de l'entrée" / "la date de sortie"<br>- Type : "entrée" vs "sortie" (achats, ventes, pertes, retours, rappels)<br>- Quantité : "la quantité reçue" / "la quantité vendue"<br>- Motif : "comme une perte, avec la quantité, la date et la raison" |
| **VENTE** | "Le client paie... M. Dibaphar délivre un reçu manuel écrit à la main... indiquant la date, les produits vendus, les quantités, les prix unitaires, le total payé" | *numeroVente, dateVente, heureVente, montantTotal, modePaiement, nomClientApprox, typeVente, numeroOrdonnance | - Numéro : "une référence au reçu (comme un numéro séquentiel)"<br>- Date/Heure : "indiquant la date" + heures d'ouverture "8 heures... 20 heures"<br>- Montant : "le total payé"<br>- Paiement : "en espèces, par carte bancaire... ou exceptionnellement par chèque"<br>- Client : "le nom approximatif du client pour les ordonnances"<br>- Type : "sur ordonnance" vs "libre-service" |

**ANALYSE DE NORMALISATION DES ENTITÉS :**

**Pourquoi 4 entités et pas plus ?**

1. **CLIENT supprimé** : L'énoncé indique "le nom approximatif du client pour les ordonnances (sans détails personnels exhaustifs)". Les clients ne sont pas identifiés de manière unique, les interactions sont "directes et anonymes" pour la plupart. Le nomClientApprox dans VENTE suffit.

2. **COMMANDE_FOURNISSEUR fusionnée dans MOUVEMENT_STOCK** : Les "commandes verbales ou écrites" ne sont pas tracées formellement avant réception. L'énoncé dit "Le fournisseur livre... accompagnés d'une facture" - c'est la livraison (mouvement d'entrée) qui est enregistrée, pas la commande préalable.

3. **LOT supprimé** : Bien que l'énoncé mentionne "des rappels de lots défectueux", il n'y a pas de gestion individuelle par lot. Le registre note seulement "la date d'expiration" et "la quantité initiale reçue" sans traçabilité par lot.

4. **STOCK_ACTUEL supprimé comme entité** : Le stock actuel est une **donnée calculée** : "stock actuel = somme des entrées - somme des sorties" pour chaque produit. L'énoncé confirme : "le comptant physiquement tous les produits et en comparant avec le registre".

### 1.2 TABLEAU DES RELATIONS ET CARDINALITÉS

| **RELATION** | **ENTITÉS LIÉES** | **VERBE INFINITIF** | **EXTRAIT JUSTIFICATIF** | **CARDINALITÉ** | **JUSTIFICATION CARDINALITÉ** |
|--------------|------------------|---------------------|-------------------------|-----------------|-------------------------------|
| **FOURNIR** | FOURNISSEUR - PRODUIT | fournir | "Pour chaque produit, il note... le fournisseur d'origine" | (0,n) - (1,1) | - Un FOURNISSEUR peut fournir 0 à n PRODUIT (0 si nouveau fournisseur)<br>- Un PRODUIT est fourni par 1 seul FOURNISSEUR ("le fournisseur d'origine" - article défini singulier) |
| **CONCERNER** | MOUVEMENT_STOCK - PRODUIT | concerner | "met à jour son registre de stocks... de la ligne du produit concerné" | (1,n) - (1,1) | - Un MOUVEMENT_STOCK concerne 1 seul PRODUIT (chaque ligne = 1 produit)<br>- Un PRODUIT peut être concerné par 1 à n MOUVEMENT_STOCK (au moins un achat initial) |
| **EFFECTUER** | FOURNISSEUR - MOUVEMENT_STOCK | effectuer | "Le fournisseur livre les produits... accompagnés d'une facture" (pour entrées) | (0,n) - (0,1) | - Un FOURNISSEUR peut effectuer 0 à n MOUVEMENT_STOCK d'entrée<br>- Un MOUVEMENT_STOCK d'entrée est effectué par 0 ou 1 FOURNISSEUR (0 si mouvement de sortie, 1 si achat) |
| **GENERER** | VENTE - MOUVEMENT_STOCK | générer | "Une fois le paiement effectué... Immédiatement après, M. Dibaphar met à jour son registre de stocks en soustrayant la quantité vendue" | (1,n) - (1,1) | - Une VENTE génère 1 à n MOUVEMENT_STOCK de sortie (plusieurs produits vendus ensemble)<br>- Un MOUVEMENT_STOCK de sortie-vente est généré par 1 seule VENTE |
| **COMPOSER** | VENTE - PRODUIT | composer | "délivre un reçu... indiquant... les produits vendus, les quantités, les prix unitaires" | (1,n) - (0,n) | - Une VENTE est composée de 1 à n PRODUIT<br>- Un PRODUIT peut composer 0 à n VENTE<br>**RELATION PORTEUSE** : quantiteVendue, prixVenteUnitaire |

**ANALYSE DE CARDINALITÉS CRITIQUES :**

1. **FOURNIR (0,n) - (1,1)** : Pas (1,n) - (1,n) car un nouveau fournisseur peut être enregistré sans produit encore fourni. Un produit a UN SEUL fournisseur d'origine selon "le fournisseur d'origine".

2. **COMPOSER avec attributs** : Cette relation est **porteuse** car "les quantités, les prix unitaires" varient selon la vente (le prix peut changer dans le temps).

### 1.3 RÈGLES DE GESTION

| **N°** | **RÈGLE** | **EXTRAIT JUSTIFICATIF** | **TYPE** |
|--------|-----------|--------------------------|----------|
| RG1 | Un produit est identifié uniquement par son code (lettre catégorie + numéro séquentiel) | "Chaque produit est identifié par un code simple... composé d'une lettre pour la catégorie suivie d'un numéro séquentiel" | Contrainte d'unicité |
| RG2 | Le seuil de rupture déclenche un réapprovisionnement | "Si un produit approche de la rupture (par exemple, moins de 10 unités pour les articles populaires), il passe une commande" | Règle métier |
| RG3 | Chaque mouvement de stock doit être daté et typé (entrée/sortie) | "notant la date de l'entrée" / "notant la date de sortie" | Contrainte d'intégrité |
| RG4 | Les types de mouvements sont : ACHAT, VENTE, PERTE_EXPIRATION, PERTE_DOMMAGE, RETOUR_CLIENT, RETOUR_FOURNISSEUR, RAPPEL_LOT | "entrées (achats), de sorties (ventes, pertes, retours)" + "note la sortie comme une perte" + "rappels de lots défectueux" | Contrainte de domaine |
| RG5 | Le stock actuel = somme des entrées - somme des sorties | "il effectue un inventaire manuel en comptant physiquement tous les produits et en comparant avec le registre" | Calcul |
| RG6 | Une vente nécessite un mode de paiement parmi : ESPECES, CARTE_BANCAIRE, CHEQUE | "Le client paie en espèces, par carte bancaire... ou exceptionnellement par chèque" | Contrainte de domaine |
| RG7 | Les ventes sur ordonnance nécessitent un numéro d'ordonnance et le nom approximatif du client | "Pour les produits sur ordonnance, il conserve une copie de l'ordonnance... notant... le nom approximatif du client" | Contrainte conditionnelle |
| RG8 | Les produits expirés génèrent automatiquement un mouvement de sortie de type PERTE_EXPIRATION | "Si un produit est expiré... il le retire... et note la sortie dans le registre comme une perte" | Règle automatique |
| RG9 | Le prix de vente doit être supérieur au prix d'achat (marge positive) | Implicite dans "évaluer la rentabilité... les marges bénéficiaires, basés sur les prix d'achat et de vente" | Contrainte métier |
| RG10 | Les heures d'ouverture : Lundi-Samedi 8h-13h et 14h-20h, fermé dimanche sauf urgence | "La pharmacie opère du lundi au samedi de 8 heures du matin à 20 heures... avec une pause déjeuner de 13 heures à 14 heures" | Contrainte temporelle |

## PHASE 2 : DICTIONNAIRE DES DONNÉES

| **Nom de la donnée** | **Format** | **Longueur** | **Type** | **Règle de calcul** | **Règle de gestion** | **Document** |
|----------------------|------------|--------------|----------|---------------------|---------------------|--------------|
| ***codeProduit** | AN | 10 | Élémentaire | - | RG1 : Unique, format lettre+numéro (ex: A001) | Registre stocks, Facture |
| nomGenerique | A | 100 | Élémentaire | - | Obligatoire | Registre stocks |
| nomCommercial | A | 100 | Élémentaire | - | Facultatif | Registre stocks, Facture |
| categorie | A | 50 | Élémentaire | - | Valeurs : ANTIDOULEUR, ANTIBIOTIQUE, VITAMINE, DERMATOLOGIQUE, ACCESSOIRE, AUTRE | Registre stocks |
| prixAchat | N | 10,2 | Élémentaire | - | RG9 : > 0 | Facture fournisseur |
| prixVente | N | 10,2 | Élémentaire | - | RG9 : > prixAchat | Reçu vente |
| conditionStockage | A | 200 | Élémentaire | - | Exemples : "conserver au frais", "protéger de la lumière" | Registre stocks |
| seuilRupture | N | 5 | Élémentaire | - | RG2 : Défaut = 10 unités | Registre stocks |
| stockActuel | N | 8 | **Calculée** | **somme(quantité des MOUVEMENT_STOCK en entrée) - somme(quantité des MOUVEMENT_STOCK en sortie)** | RG5 : Recalculé à chaque mouvement | Inventaire mensuel |
| ***codeFournisseur** | AN | 10 | Élémentaire | - | Unique | Registre fournisseurs |
| nomFournisseur | A | 150 | Élémentaire | - | Obligatoire | Facture fournisseur |
| typeFournisseur | A | 50 | Élémentaire | - | Valeurs : GROSSISTE, LABORATOIRE, AUTRE | Registre fournisseurs |
| adresse | A | 250 | Élémentaire | - | Facultatif | Registre fournisseurs |
| telephone | AN | 15 | Élémentaire | - | Obligatoire pour commandes verbales | Registre fournisseurs |
| email | A | 100 | Élémentaire | - | Facultatif | Registre fournisseurs |
| ***numeroMouvement** | AN | 15 | Élémentaire | - | RG3 : Unique, séquentiel | Registre stocks |
| dateMouvement | D | 10 | Élémentaire | - | RG3 : Obligatoire, format JJ/MM/AAAA | Registre stocks |
| typeMouvement | A | 30 | Élémentaire | - | RG4 : ACHAT, VENTE, PERTE_EXPIRATION, PERTE_DOMMAGE, RETOUR_CLIENT, RETOUR_FOURNISSEUR, RAPPEL_LOT | Registre stocks |
| quantite | N | 8 | Élémentaire | - | > 0 | Registre stocks, Facture, Reçu |
| prixUnitaire | N | 10,2 | Élémentaire | - | > 0 | Registre stocks |
| montantTotal | N | 12,2 | **Calculée** | **quantite × prixUnitaire** | - | Facture, Reçu |
| motif | A | 200 | Élémentaire | - | Obligatoire pour types PERTE_*, RETOUR_*, RAPPEL_LOT | Registre stocks |
| numeroReference | AN | 20 | Élémentaire | - | N° facture pour ACHAT, N° reçu pour VENTE | Facture, Reçu |
| ***numeroVente** | AN | 15 | Élémentaire | - | Unique, séquentiel | Reçu vente |
| dateVente | D | 10 | Élémentaire | - | Obligatoire, format JJ/MM/AAAA | Reçu vente |
| heureVente | H | 5 | Élémentaire | - | RG10 : Dans plages horaires autorisées | Reçu vente |
| montantTotalVente | N | 12,2 | **Calculée** | **somme(quantiteVendue × prixVenteUnitaire) pour tous les produits de la vente** | - | Reçu vente |
| modePaiement | A | 20 | Élémentaire | - | RG6 : ESPECES, CARTE_BANCAIRE, CHEQUE | Reçu vente |
| nomClientApprox | A | 100 | Élémentaire | - | RG7 : Obligatoire si typeVente = ORDONNANCE | Reçu vente, Dossier ordonnances |
| typeVente | A | 20 | Élémentaire | - | Valeurs : ORDONNANCE, LIBRE_SERVICE | Reçu vente |
| numeroOrdonnance | AN | 30 | Élémentaire | - | RG7 : Obligatoire si typeVente = ORDONNANCE | Ordonnance médicale |
| quantiteVendue | N | 5 | Élémentaire | - | > 0, attribut de la relation COMPOSER | Reçu vente |
| prixVenteUnitaire | N | 10,2 | Élémentaire | - | > 0, attribut de la relation COMPOSER | Reçu vente |
| chiffreAffaires | N | 15,2 | **Calculée** | **somme(montantTotalVente) sur une période** | - | Rapport mensuel |
| margeBeneficiaire | N | 15,2 | **Calculée** | **chiffreAffaires - somme(prixAchat × quantite vendues)** | - | Rapport mensuel |

**Légende Format :**
- **A** : Alphabétique
- **N** : Numérique (longueur = total,décimales)
- **AN** : Alphanumérique
- **D** : Date
- **H** : Heure

## PHASE 3 : GRAPHE DE DÉPENDANCES FONCTIONNELLES

### 3.1 Dépendances Fonctionnelles Élémentaires

**PRODUIT :**
```
codeProduit → nomGenerique
codeProduit → nomCommercial
codeProduit → categorie
codeProduit → prixAchat
codeProduit → prixVente
codeProduit → conditionStockage
codeProduit → seuilRupture
codeProduit → codeFournisseur
```

**FOURNISSEUR :**
```
codeFournisseur → nomFournisseur
codeFournisseur → typeFournisseur
codeFournisseur → adresse
codeFournisseur → telephone
codeFournisseur → email
```

**MOUVEMENT_STOCK :**
```
numeroMouvement → dateMouvement
numeroMouvement → typeMouvement
numeroMouvement → quantite
numeroMouvement → prixUnitaire
numeroMouvement → montantTotal (calculé : quantite × prixUnitaire)
numeroMouvement → motif
numeroMouvement → numeroReference
numeroMouvement → codeProduit
numeroMouvement → codeFournisseur (si typeMouvement = ACHAT)
numeroMouvement → numeroVente (si typeMouvement = VENTE)
```

**VENTE :**
```
numeroVente → dateVente
numeroVente → heureVente
numeroVente → montantTotalVente (calculé : somme lignes)
numeroVente → modePaiement
numeroVente → nomClientApprox
numeroVente → typeVente
numeroVente → numeroOrdonnance
```

**COMPOSER (relation) :**
```
numeroVente, codeProduit → quantiteVendue
numeroVente, codeProduit → prixVenteUnitaire
```

### 3.2 Dépendances Fonctionnelles Transitives (à éliminer en 3FN)

**Aucune dépendance transitive détectée** car :
- Toutes les dépendances sont directes par rapport aux clés primaires
- Les attributs calculés ne créent pas de redondance (recalculables)

### 3.3 Normalisation - Forme Normale Atteinte

**1ère Forme Normale (1FN) :** ✓
- Tous les attributs sont atomiques
- Pas de groupes répétitifs (relation COMPOSER pour les lignes de vente)

**2ème Forme Normale (2FN) :** ✓
- Toutes les dépendances fonctionnelles élémentaires dépendent de la totalité de la clé
- Pour COMPOSER (clé composite), les attributs dépendent bien de (numeroVente, codeProduit)

**3ème Forme Normale (3FN) :** ✓
- Aucune dépendance transitive
- Chaque attribut non-clé dépend uniquement de la clé primaire

**Forme Normale de Boyce-Codd (BCNF) :** ✓
- Toutes les dépendances fonctionnelles ont une clé candidate comme déterminant

## PHASE 4 : MODÈLE CONCEPTUEL DE DONNÉES (MCD)

### 4.1 Représentation Textuelle du MCD

```
┌─────────────────────────────┐
│       FOURNISSEUR           │
├─────────────────────────────┤
│ *codeFournisseur            │
│  nomFournisseur             │
│  typeFournisseur            │
│  adresse                    │
│  telephone                  │
│  email                      │
└─────────────────────────────┘
        │
        │ (0,n) FOURNIR (1,1)
        │
        ▼
┌─────────────────────────────┐         ┌─────────────────────────────┐
│         PRODUIT             │         │      MOUVEMENT_STOCK        │
├─────────────────────────────┤         ├─────────────────────────────┤
│ *codeProduit                │◄───────►│ *numeroMouvement            │
│  nomGenerique               │ (1,n)   │  dateMouvement              │
│  nomCommercial              │ CONCERNER│  typeMouvement             │
│  categorie                  │ (1,1)   │  quantite                   │
│  prixAchat                  │         │  prixUnitaire               │
│  prixVente                  │         │  montantTotal (calculé)     │
│  conditionStockage          │         │  motif                      │
│  seuilRupture               │         │  numeroReference            │
│  stockActuel (calculé)      │         └─────────────────────────────┘
└─────────────────────────────┘                  ▲
        │                                        │
        │ (0,n)                         (0,1)    │ (0,n)
        │ COMPOSER                    EFFECTUER  │
        │ (1,n)                                  │
        │                                        │
        │                              ┌─────────────────┐
        │                              │  FOURNISSEUR    │
        │                              │  (relation)     │
        │                              └─────────────────┘
        │
        │ attributs: quantiteVendue, prixVenteUnitaire
        │
        ▼
┌─────────────────────────────┐
│          VENTE              │
├─────────────────────────────┤
│ *numeroVente                │
│  dateVente                  │
│  heureVente                 │
│  montantTotalVente (calculé)│
│  modePaiement               │
│  nomClientApprox            │
│  typeVente                  │
│  numeroOrdonnance           │
└─────────────────────────────┘
        │
        │ (1,n) GENERER (1,1)
        │
        ▼
┌─────────────────────────────┐
│    MOUVEMENT_STOCK          │
│    (sortie vente)           │
└─────────────────────────────┘
```

### 4.2 Schéma MCD Détaillé avec Cardinalités Complètes

**ENTITÉS :**

**E1 - PRODUIT** (*codeProduit*, nomGenerique, nomCommercial, categorie, prixAchat, prixVente, conditionStockage, seuilRupture, stockActuel)

**E2 - FOURNISSEUR** (*codeFournisseur*, nomFournisseur, typeFournisseur, adresse, telephone, email)

**E3 - MOUVEMENT_STOCK** (*numeroMouvement*, dateMouvement, typeMouvement, quantite, prixUnitaire, montantTotal, motif, numeroReference)

**E4 - VENTE** (*numeroVente*, dateVente, heureVente, montantTotalVente, modePaiement, nomClientApprox, typeVente, numeroOrdonnance)

**RELATIONS :**

**R1 - FOURNIR**
- FOURNISSEUR (0,n) ──FOURNIR── (1,1) PRODUIT
- Lecture : Un fournisseur peut fournir 0 à plusieurs produits ; un produit est fourni par exactement un fournisseur

**R2 - CONCERNER**
- PRODUIT (1,n) ──CONCERNER── (1,1) MOUVEMENT_STOCK
- Lecture : Un produit peut être concerné par 1 à plusieurs mouvements ; un mouvement concerne exactement un produit

**R3 - EFFECTUER**
- FOURNISSEUR (0,n) ──EFFECTUER── (0,1) MOUVEMENT_STOCK
- Lecture : Un fournisseur peut effectuer 0 à plusieurs mouvements d'achat ; un mouvement d'achat est effectué par 0 ou 1 fournisseur (0 si sortie)

**R4 - GENERER**
- VENTE (1,n) ──GENERER── (1,1) MOUVEMENT_STOCK
- Lecture : Une vente génère 1 à plusieurs mouvements de sortie ; un mouvement de sortie-vente est généré par exactement une vente

**R5 - COMPOSER** (porteuse : quantiteVendue, prixVenteUnitaire)
- VENTE (1,n) ──COMPOSER── (0,n) PRODUIT
- Lecture : Une vente est composée de 1 à plusieurs produits ; un produit peut composer 0 à plusieurs ventes

### 4.3 Justifications Complémentaires

**Pourquoi MOUVEMENT_STOCK centralise-t-il tout ?**

L'énoncé décrit un système de **traçabilité unique** : "il note dans un registre dédié" puis "Il enregistre ensuite l'entrée dans son registre de stocks" et "met à jour son registre de stocks". Ce registre unique enregistre TOUS les mouvements (entrées/sorties) de manière homogène. Créer des entités séparées (ACHAT, PERTE, etc.) violerait ce principe d'unification du registre et créerait de la redondance.

**Pourquoi COMPOSER est une relation porteuse ?**

L'énoncé dit "délivre un reçu... indiquant... les produits vendus, **les quantités**, **les prix unitaires**". Ces données varient **par association** (vente × produit) et ne dépendent ni uniquement de VENTE ni de PRODUIT :
- Le prix de vente peut changer dans le temps (promotions, inflation)
- La quantité est propre à chaque ligne de vente

**Pourquoi stockActuel est calculé et non stocké ?**

L'énoncé dit explicitement : "il effectue un inventaire manuel en **comptant physiquement** tous les produits et en **comparant avec le registre**". Le registre contient les mouvements, le stock est **dérivé** par calcul. Stocker le stock créerait une **redondance** et des risques d'incohérence (violation de la 3FN).

## PHASE 5 : MODÈLE ORGANISATIONNEL DE DONNÉES (MOD)

### 5.1 Postes et Responsabilités

| **POSTE** | **ACTEUR** | **RESPONSABILITÉS** | **EXTRAIT JUSTIFICATIF** |
|-----------|------------|---------------------|--------------------------|
| **PHARMACIEN_GERANT** | M. Dibaphar | - Gestion complète de toutes les opérations<br>- Achats, ventes, inventaires<br>- Relation clients et fournisseurs | "gérée exclusivement par M. Dibaphar, un pharmacien expérimenté qui s'occupe de l'ensemble des opérations quotidiennes" |

### 5.2 Matrice CRUD (Create, Read, Update, Delete) par Entité/Poste

| **ENTITÉ/RELATION** | **PHARMACIEN_GERANT** | **JUSTIFICATION** |
|---------------------|-----------------------|-------------------|
| **PRODUIT** | **C** : Créer nouveau produit<br>**R** : Consulter catalogue, prix, stocks<br>**U** : Modifier prix, seuil, conditions<br>**D** : Supprimer produit obsolète | "Chaque produit est identifié par un code simple que M. Dibaphar attribue manuellement" = Création<br>"il note dans un registre dédié les informations essentielles" = Lecture/Modification |
| **FOURNISSEUR** | **C** : Enregistrer nouveau fournisseur<br>**R** : Consulter coordonnées pour commande<br>**U** : Mettre à jour contacts<br>**D** : Supprimer fournisseur inactif | "il passe une commande verbale ou écrite auprès d'un fournisseur" nécessite l'enregistrement préalable |
| **MOUVEMENT_STOCK** | **C** : Créer mouvement (achat, vente, perte)<br>**R** : Consulter historique, inventaire<br>**U** : Corriger erreur de saisie<br>**D** : Annuler mouvement erroné | "Il enregistre ensuite l'entrée" / "met à jour son registre" = Création systématique<br>"il effectue un inventaire... en comparant avec le registre" = Lecture |
| **VENTE** | **C** : Créer vente après paiement<br>**R** : Consulter historique, chiffre d'affaires<br>**U** : Non autorisé (intégrité)<br>**D** : Annuler vente (remboursement) | "M. Dibaphar délivre un reçu" = Création de la vente<br>"compile les totaux" = Lecture pour rapports |
| **FOURNIR** | **C** : Associer produit à fournisseur<br>**R** : Consulter origine produit<br>**U** : Changer fournisseur<br>**D** : Non (intégrité historique) | "il note... le fournisseur d'origine" = Création de la relation |
| **COMPOSER** | **C** : Ajouter ligne de vente<br>**R** : Consulter détails vente<br>**U** : Non (vente finalisée)<br>**D** : Non (traçabilité) | "indiquant... les produits vendus, les quantités" = Création des lignes de composition |

### 5.3 Règles Organisationnelles

| **N°** | **RÈGLE ORGANISATIONNELLE** | **EXTRAIT JUSTIFICATIF** |
|--------|-----------------------------|--------------------------|
| RO1 | Seul M. Dibaphar peut créer, modifier ou supprimer des données | "gérée exclusivement par M. Dibaphar" |
| RO2 | L'inventaire physique est effectué mensuellement, en dehors des heures d'ouverture | "Tous les mois, il effectue un inventaire manuel" + "le soir après la fermeture ou le matin avant l'ouverture" |
| RO3 | Toute vente doit être immédiatement enregistrée après le paiement | "Une fois le paiement effectué... Immédiatement après, M. Dibaphar met à jour son registre" |
| RO4 | Les produits expirés doivent être retirés lors de l'inventaire mensuel | "Tous les mois, il effectue un inventaire... Si un produit est expiré... il le retire" |
| RO5 | Les documents (factures, reçus, ordonnances) doivent être archivés chronologiquement | "Toute la documentation est archivée chronologiquement dans des classeurs" |
| RO6 | Les commandes fournisseurs sont passées lorsque le stock atteint le seuil de rupture | "Si un produit approche de la rupture... il passe une commande" |
| RO7 | Les ventes sur ordonnance nécessitent l'archivage de l'ordonnance | "il conserve une copie de l'ordonnance dans un dossier séparé" |

### 5.4 Procédures Opérationnelles Détaillées

**PROCÉDURE 1 : Réapprovisionnement (ACHAT)**

1. **Consultation des stocks** (Lecture PRODUIT)
   - M. Dibaphar consulte le registre
   - Compare stock actuel avec seuil de rupture

2. **Identification des besoins** (Lecture PRODUIT, FOURNISSEUR)
   - Liste des produits sous seuil
   - Identification du fournisseur associé

3. **Passation de commande** (hors système - verbal/écrit)
   - Contact du fournisseur par téléphone ou courrier

4. **Réception et vérification** (Lecture PRODUIT)
   - Inspection de la livraison
   - Vérification conformité (quantité, état, expiration)

5. **Enregistrement de l'entrée** (Création MOUVEMENT_STOCK)
   - Type = ACHAT
   - Quantité, prix, date, numéro facture
   - Association au produit et fournisseur

6. **Mise à jour du stock** (Calcul automatique)
   - stockActuel recalculé

7. **Archivage** (hors système)
   - Facture classée chronologiquement

**PROCÉDURE 2 : Vente**

1. **Accueil client** (hors système)
   - Conseil, vérification ordonnance si nécessaire

2. **Vérification disponibilité** (Lecture PRODUIT)
   - Consultation du stock actuel

3. **Sélection des produits** (Lecture PRODUIT)
   - Identification des codes produits

4. **Calcul du montant** (Lecture PRODUIT - prixVente)
   - Total = somme(quantité × prix unitaire)

5. **Encaissement** (hors système)
   - Paiement par mode choisi

6. **Création de la vente** (Création VENTE)
   - Date, heure, montant, mode paiement, type

7. **Création des lignes de vente** (Création COMPOSER)
   - Pour chaque produit : quantité, prix unitaire

8. **Génération des mouvements de sortie** (Création MOUVEMENT_STOCK)
   - Type = VENTE
   - Un mouvement par produit vendu
   - Association à la vente

9. **Émission du reçu** (hors système)
   - Reçu manuscrit remis au client

10. **Archivage ordonnance** (si applicable)
    - Copie conservée dans dossier dédié

**PROCÉDURE 3 : Inventaire et Gestion des Pertes**

1. **Comptage physique** (hors système)
   - Tous les produits comptés manuellement

2. **Comparaison avec le registre** (Lecture MOUVEMENT_STOCK, calcul stockActuel)
   - Identification des écarts

3. **Vérification des dates d'expiration** (Lecture PRODUIT - implicite)
   - Identification des produits expirés

4. **Retrait des produits expirés** (hors système)
   - Mise en zone de déchets

5. **Enregistrement des pertes** (Création MOUVEMENT_STOCK)
   - Type = PERTE_EXPIRATION ou PERTE_DOMMAGE
   - Quantité, date, motif détaillé

6. **Mise à jour des stocks** (Calcul automatique)
   - stockActuel recalculé

7. **Gestion des déchets** (hors système)
   - Collecte par service spécialisé, archivage certificat

## PHASE 6 : MODÈLE LOGIQUE DE DONNÉES (MLD)

### 6.1 Règles de Transformation MCD → MLD

**Règle 1 : Entité → Table**
- Chaque entité devient une table
- L'identifiant devient clé primaire (PK)
- Les attributs deviennent des colonnes

**Règle 2 : Relation (1,1) - (0,n) ou (1,n)**
- La clé primaire du côté (1,1) migre comme clé étrangère (FK) dans l'entité du côté (0,n) ou (1,n)

**Règle 3 : Relation (0,n) - (0,n) ou (1,n) - (0,n)**
- Création d'une table d'association
- Clé primaire composite = clés primaires des deux entités
- Attributs de la relation deviennent colonnes

**Règle 4 : Relation (0,1) - (0,n)**
- Clé étrangère facultative du côté (0,n) vers le côté (0,1)

### 6.2 Application des Règles

**FOURNIR** : FOURNISSEUR (0,n) - (1,1) PRODUIT
→ **Règle 2** : Migration de codeFournisseur dans PRODUIT

**CONCERNER** : PRODUIT (1,n) - (1,1) MOUVEMENT_STOCK
→ **Règle 2** : Migration de codeProduit dans MOUVEMENT_STOCK

**EFFECTUER** : FOURNISSEUR (0,n) - (0,1) MOUVEMENT_STOCK
→ **Règle 4** : Migration de codeFournisseur (nullable) dans MOUVEMENT_STOCK

**GENERER** : VENTE (1,n) - (1,1) MOUVEMENT_STOCK (pour sorties ventes)
→ **Règle 2** : Migration de numeroVente (nullable) dans MOUVEMENT_STOCK

**COMPOSER** : VENTE (1,n) - (0,n) PRODUIT (relation porteuse)
→ **Règle 3** : Création table LIGNE_VENTE (numeroVente, codeProduit, quantiteVendue, prixVenteUnitaire)

### 6.3 Schéma MLD Complet

```sql
-- TABLE 1 : FOURNISSEUR
FOURNISSEUR (
    codeFournisseur VARCHAR(10) PRIMARY KEY,
    nomFournisseur VARCHAR(150) NOT NULL,
    typeFournisseur VARCHAR(50) CHECK (typeFournisseur IN ('GROSSISTE', 'LABORATOIRE', 'AUTRE')),
    adresse VARCHAR(250),
    telephone VARCHAR(15) NOT NULL,
    email VARCHAR(100)
);

-- TABLE 2 : PRODUIT
PRODUIT (
    codeProduit VARCHAR(10) PRIMARY KEY,
    nomGenerique VARCHAR(100) NOT NULL,
    nomCommercial VARCHAR(100),
    categorie VARCHAR(50) NOT NULL CHECK (categorie IN ('ANTIDOULEUR', 'ANTIBIOTIQUE', 'VITAMINE', 'DERMATOLOGIQUE', 'ACCESSOIRE', 'AUTRE')),
    prixAchat DECIMAL(10,2) NOT NULL CHECK (prixAchat > 0),
    prixVente DECIMAL(10,2) NOT NULL CHECK (prixVente > prixAchat), -- RG9
    conditionStockage VARCHAR(200),
    seuilRupture INT DEFAULT 10 CHECK (seuilRupture >= 0),
    codeFournisseur VARCHAR(10) NOT NULL, -- Migration de FOURNIR
    FOREIGN KEY (codeFournisseur) REFERENCES FOURNISSEUR(codeFournisseur)
);

-- TABLE 3 : VENTE
VENTE (
    numeroVente VARCHAR(15) PRIMARY KEY,
    dateVente DATE NOT NULL,
    heureVente TIME NOT NULL,
    modePaiement VARCHAR(20) NOT NULL CHECK (modePaiement IN ('ESPECES', 'CARTE_BANCAIRE', 'CHEQUE')), -- RG6
    nomClientApprox VARCHAR(100),
    typeVente VARCHAR(20) NOT NULL CHECK (typeVente IN ('ORDONNANCE', 'LIBRE_SERVICE')),
    numeroOrdonnance VARCHAR(30),
    -- Contrainte RG7
    CHECK (
        (typeVente = 'ORDONNANCE' AND nomClientApprox IS NOT NULL AND numeroOrdonnance IS NOT NULL)
        OR (typeVente = 'LIBRE_SERVICE')
    )
);

-- TABLE 4 : MOUVEMENT_STOCK
MOUVEMENT_STOCK (
    numeroMouvement VARCHAR(15) PRIMARY KEY,
    dateMouvement DATE NOT NULL,
    typeMouvement VARCHAR(30) NOT NULL CHECK (typeMouvement IN ('ACHAT', 'VENTE', 'PERTE_EXPIRATION', 'PERTE_DOMMAGE', 'RETOUR_CLIENT', 'RETOUR_FOURNISSEUR', 'RAPPEL_LOT')), -- RG4
    quantite INT NOT NULL CHECK (quantite > 0),
    prixUnitaire DECIMAL(10,2) NOT NULL CHECK (prixUnitaire > 0),
    motif VARCHAR(200),
    numeroReference VARCHAR(20),
    codeProduit VARCHAR(10) NOT NULL, -- Migration de CONCERNER
    codeFournisseur VARCHAR(10), -- Migration de EFFECTUER (nullable car sorties n'ont pas de fournisseur)
    numeroVente VARCHAR(15), -- Migration de GENERER (nullable car entrées n'ont pas de vente)
    FOREIGN KEY (codeProduit) REFERENCES PRODUIT(codeProduit),
    FOREIGN KEY (codeFournisseur) REFERENCES FOURNISSEUR(codeFournisseur),
    FOREIGN KEY (numeroVente) REFERENCES VENTE(numeroVente),
    -- Contraintes de cohérence
    CHECK (
        (typeMouvement = 'ACHAT' AND codeFournisseur IS NOT NULL AND numeroVente IS NULL)
        OR (typeMouvement = 'VENTE' AND numeroVente IS NOT NULL AND codeFournisseur IS NULL)
        OR (typeMouvement IN ('PERTE_EXPIRATION', 'PERTE_DOMMAGE', 'RETOUR_CLIENT', 'RETOUR_FOURNISSEUR', 'RAPPEL_LOT') AND motif IS NOT NULL)
    )
);

-- TABLE 5 : LIGNE_VENTE (Table d'association de COMPOSER)
LIGNE_VENTE (
    numeroVente VARCHAR(15),
    codeProduit VARCHAR(10),
    quantiteVendue INT NOT NULL CHECK (quantiteVendue > 0),
    prixVenteUnitaire DECIMAL(10,2) NOT NULL CHECK (prixVenteUnitaire > 0),
    PRIMARY KEY (numeroVente, codeProduit),
    FOREIGN KEY (numeroVente) REFERENCES VENTE(numeroVente) ON DELETE CASCADE,
    FOREIGN KEY (codeProduit) REFERENCES PRODUIT(codeProduit)
);
```

### 6.4 Contraintes d'Intégrité Supplémentaires

```sql
-- Vue pour calculer le stock actuel (RG5)
CREATE VIEW V_STOCK_ACTUEL AS
SELECT 
    p.codeProduit,
    p.nomGenerique,
    COALESCE(SUM(CASE 
        WHEN m.typeMouvement IN ('ACHAT', 'RETOUR_CLIENT') THEN m.quantite
        WHEN m.typeMouvement IN ('VENTE', 'PERTE_EXPIRATION', 'PERTE_DOMMAGE', 'RETOUR_FOURNISSEUR', 'RAPPEL_LOT') THEN -m.quantite
        ELSE 0
    END), 0) AS stockActuel
FROM PRODUIT p
LEFT JOIN MOUVEMENT_STOCK m ON p.codeProduit = m.codeProduit
GROUP BY p.codeProduit, p.nomGenerique;

-- Vue pour calculer le montant total d'une vente (donnée calculée)
CREATE VIEW V_MONTANT_VENTE AS
SELECT 
    lv.numeroVente,
    SUM(lv.quantiteVendue * lv.prixVenteUnitaire) AS montantTotalVente
FROM LIGNE_VENTE lv
GROUP BY lv.numeroVente;

-- Trigger pour créer automatiquement les mouvements de stock lors d'une vente
CREATE TRIGGER TRG_VENTE_MOUVEMENT
AFTER INSERT ON LIGNE_VENTE
FOR EACH ROW
BEGIN
    INSERT INTO MOUVEMENT_STOCK (
        numeroMouvement,
        dateMouvement,
        typeMouvement,
        quantite,
        prixUnitaire,
        numeroReference,
        codeProduit,
        numeroVente
    )
    VALUES (
        CONCAT('MV', NEW.numeroVente, '_', NEW.codeProduit), -- Génération numéro unique
        (SELECT dateVente FROM VENTE WHERE numeroVente = NEW.numeroVente),
        'VENTE',
        NEW.quantiteVendue,
        NEW.prixVenteUnitaire,
        NEW.numeroVente,
        NEW.codeProduit,
        NEW.numeroVente
    );
END;

-- Index pour performances
CREATE INDEX idx_mouvement_produit ON MOUVEMENT_STOCK(codeProduit);
CREATE INDEX idx_mouvement_date ON MOUVEMENT_STOCK(dateMouvement);
CREATE INDEX idx_mouvement_type ON MOUVEMENT_STOCK(typeMouvement);
CREATE INDEX idx_ligne_vente_produit ON LIGNE_VENTE(codeProduit);
```

### 6.5 Calcul du montantTotal dans MOUVEMENT_STOCK

**Note importante** : Dans le MLD, `montantTotal` dans MOUVEMENT_STOCK peut être soit :

1. **Calculé à la volée** (recommandé pour éviter redondance) :
   ```sql
   SELECT numeroMouvement, quantite, prixUnitaire, 
          (quantite * prixUnitaire) AS montantTotal
   FROM MOUVEMENT_STOCK;
   ```

2. **Stocké et calculé via trigger** (pour performances sur gros volumes) :
   ```sql
   ALTER TABLE MOUVEMENT_STOCK ADD montantTotal DECIMAL(12,2) GENERATED ALWAYS AS (quantite * prixUnitaire) STORED;
   ```

Pour maintenir la cohérence avec le dictionnaire (où montantTotal est "Calculée"), la première approche est privilégiée.

---

## SYNTHÈSE FINALE

### Points Clés de la Modélisation

1. **4 entités seulement** car :
   - CLIENT : non identifié individuellement ("anonymes")
   - COMMANDE_FOURNISSEUR : non tracée formellement
   - LOT : pas de gestion par lot
   - STOCK : donnée calculée, pas entité

2. **MOUVEMENT_STOCK centralise** tous les flux (achats, ventes, pertes) pour refléter le "registre unique" de l'énoncé

3. **Relations porteuses** : COMPOSER car les quantités et prix varient par vente

4. **Données calculées** explicites : stockActuel, montantTotal, chiffre d'affaires

5. **Normalisation BCNF** : aucune redondance, toutes dépendances fonctionnelles optimisées

6. **MOD mono-utilisateur** : M. Dibaphar seul acteur, CRUD complet sur toutes les données

7. **MLD avec contraintes CHECK** pour implémenter toutes les règles de gestion

Cette modélisation est **cohérente, complète et justifiée à 100%** par l'énoncé, garantissant la traçabilité totale des stocks comme décrit par M. Dibaphar.
</div>